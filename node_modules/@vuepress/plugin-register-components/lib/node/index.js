import{globby as l,path as c,hash as u}from"vuepress/utils";import{watch as f}from"chokidar";const a=async({componentsDir:t,componentsPatterns:e,getComponentName:o})=>{if(!t)return{};const i=await l(e,{cwd:t});return Object.fromEntries(i.map(n=>[o(n),c.resolve(t,n)]))},s=async(t,e,o)=>{const i={...await a(e),...e.components},n=`import { defineAsyncComponent } from 'vue'

export default {
  enhance: ({ app }) => {    ${Object.entries(i).map(([p,r])=>`
      app.component(${JSON.stringify(p)}, defineAsyncComponent(() => import(${JSON.stringify(r)})))`).join(`
    `)}
  },
}
`;return t.writeTemp(`register-components/clientConfig.${o}.js`,n)},C=({components:t={},componentsDir:e=null,componentsPatterns:o=["**/*.vue"],getComponentName:i=n=>c.trimExt(n.replace(/\/|\\/g,"-"))}={})=>{const n={components:t,componentsDir:e,componentsPatterns:o,getComponentName:i},p=u(n);return{name:"@vuepress/plugin-register-components",multiple:!0,clientConfigFile:r=>s(r,n,p),onWatched:(r,g)=>{if(e){const m=f(o,{cwd:e,ignoreInitial:!0});m.on("add",()=>{s(r,n,p)}),m.on("unlink",()=>{s(r,n,p)}),g.push(m)}}}};export{a as getComponentsFromDir,s as prepareClientConfigFile,C as registerComponentsPlugin};
//# sourceMappingURL=index.js.map
