import{_ as s,e as a,i as p,o as t}from"./app-CztZx2qC.js";const e={};function l(c,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h1 id="泰坦尼克号生存预测" tabindex="-1"><a class="header-anchor" href="#泰坦尼克号生存预测"><span>泰坦尼克号生存预测</span></a></h1><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">📚</span>项目概述 </div><div class="knowledge-card__content"><ul><li><strong>难度</strong>：入门级</li><li><strong>类型</strong>：二元分类</li><li><strong>预计时间</strong>：4-6小时</li><li><strong>技能点</strong>：数据清洗、特征工程、分类算法、模型评估</li></ul></div></div><h2 id="项目背景" tabindex="-1"><a class="header-anchor" href="#项目背景"><span>项目背景</span></a></h2><p>1912年4月15日，被誉为&quot;永不沉没&quot;的豪华客轮泰坦尼克号在首航期间与冰山相撞沉没，2224名乘客和船员中有1502人遇难。这场悲剧震惊了国际社会，并导致了船舶安全条例的改进。</p><p>在这个项目中，我们将分析泰坦尼克号的乘客数据，尝试回答&quot;什么样的人更有可能生存？&quot;这个问题。通过构建预测模型，我们可以发现影响生存率的关键因素。</p><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">💡</span>你知道吗？ </div><div class="knowledge-card__content"><p>泰坦尼克号的沉没展示了社会阶层在灾难中的影响。当时的&quot;女士和儿童优先&quot;政策以及不同舱位的位置导致了生存率的显著差异。一等舱乘客的生存率约为62%，二等舱为41%，而三等舱仅为25%。</p></div></div><h2 id="数据集介绍" tabindex="-1"><a class="header-anchor" href="#数据集介绍"><span>数据集介绍</span></a></h2><p>本项目使用的数据集包含泰坦尼克号上891名乘客的信息。每位乘客的记录包含以下特征：</p><ul><li><strong>PassengerId</strong>：乘客ID</li><li><strong>Survived</strong>：是否存活（0=否，1=是）</li><li><strong>Pclass</strong>：船票等级（1=一等舱，2=二等舱，3=三等舱）</li><li><strong>Name</strong>：乘客姓名</li><li><strong>Sex</strong>：性别</li><li><strong>Age</strong>：年龄</li><li><strong>SibSp</strong>：同行的兄弟姐妹/配偶数量</li><li><strong>Parch</strong>：同行的父母/子女数量</li><li><strong>Ticket</strong>：船票号码</li><li><strong>Fare</strong>：船票价格</li><li><strong>Cabin</strong>：客舱号码</li><li><strong>Embarked</strong>：登船港口（C=瑟堡，Q=皇后镇，S=南安普顿）</li></ul><p>数据集中存在一些缺失值，特别是Age、Cabin和Embarked特征。处理这些缺失值将是数据预处理的重要部分。</p><h2 id="项目目标" tabindex="-1"><a class="header-anchor" href="#项目目标"><span>项目目标</span></a></h2><ol><li>探索和分析泰坦尼克号乘客数据</li><li>处理缺失值和准备特征</li><li>构建分类模型预测乘客生存情况</li><li>评估模型性能并解释结果</li><li>提交预测结果</li></ol><h2 id="实施步骤" tabindex="-1"><a class="header-anchor" href="#实施步骤"><span>实施步骤</span></a></h2><h3 id="步骤1-数据探索与可视化" tabindex="-1"><a class="header-anchor" href="#步骤1-数据探索与可视化"><span>步骤1：数据探索与可视化</span></a></h3><p>首先，我们需要加载数据并进行初步探索，了解数据的基本特征和分布。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token operator">%</span>matplotlib inline</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载数据</span></span>
<span class="line">train_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;titanic_train.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看数据基本信息</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>train_data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span></span>
<span class="line">train_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 检查缺失值</span></span>
<span class="line">train_data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 基本统计描述</span></span>
<span class="line">train_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生存率概览</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;Survived&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 可视化不同特征与生存率的关系</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Sex&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Survived&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>train_data<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Survival Rate by Gender&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Pclass&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Survived&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>train_data<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Survival Rate by Passenger Class&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Embarked&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Survived&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>train_data<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Survival Rate by Embarkation Port&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="步骤2-数据预处理" tabindex="-1"><a class="header-anchor" href="#步骤2-数据预处理"><span>步骤2：数据预处理</span></a></h3><p>接下来，我们需要处理缺失值，并将分类特征转换为模型可用的格式。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 处理缺失的年龄数据</span></span>
<span class="line">age_median <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;Age&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;Age&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>age_median<span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 处理缺失的登船港口数据</span></span>
<span class="line">embarked_mode <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;Embarked&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;Embarked&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>embarked_mode<span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建新特征：家庭规模</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;FamilySize&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;SibSp&#39;</span><span class="token punctuation">]</span> <span class="token operator">+</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;Parch&#39;</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建新特征：是否单独旅行</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;IsAlone&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">&#39;FamilySize&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 从姓名中提取称谓</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;Title&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token string">&#39; ([A-Za-z]+)\\.&#39;</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 将称谓分组</span></span>
<span class="line">title_mapping <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;Mr&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mr&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Miss&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Miss&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Mrs&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mrs&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Master&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Master&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Dr&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Officer&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Rev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Officer&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Col&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Officer&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Major&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Officer&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Mlle&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Miss&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Mme&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mrs&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Don&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Royalty&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Lady&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Royalty&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Countess&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Royalty&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Jonkheer&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Royalty&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Sir&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Royalty&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Capt&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Officer&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Ms&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mrs&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">train_data<span class="token punctuation">[</span><span class="token string">&#39;Title&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;Title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>title_mapping<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 选择要使用的特征</span></span>
<span class="line">features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;Pclass&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Sex&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Fare&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Embarked&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;FamilySize&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;IsAlone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Title&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 对分类特征进行独热编码</span></span>
<span class="line">train_encoded <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span>features<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 准备特征矩阵和目标变量</span></span>
<span class="line">X <span class="token operator">=</span> train_encoded</span>
<span class="line">y <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token string">&#39;Survived&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="步骤3-模型构建与评估" tabindex="-1"><a class="header-anchor" href="#步骤3-模型构建与评估"><span>步骤3：模型构建与评估</span></a></h3><p>现在我们可以构建分类模型并评估其性能。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token punctuation">,</span> cross_val_score</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">,</span> classification_report</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 划分训练集和验证集</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 决策树模型</span></span>
<span class="line">dt_model <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">dt_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">dt_pred <span class="token operator">=</span> dt_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_val<span class="token punctuation">)</span></span>
<span class="line">dt_accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> dt_pred<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;决策树准确率: </span><span class="token interpolation"><span class="token punctuation">{</span>dt_accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 随机森林模型</span></span>
<span class="line">rf_model <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">rf_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">rf_pred <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_val<span class="token punctuation">)</span></span>
<span class="line">rf_accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> rf_pred<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;随机森林准确率: </span><span class="token interpolation"><span class="token punctuation">{</span>rf_accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># SVM模型</span></span>
<span class="line">svm_model <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">&#39;rbf&#39;</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">svm_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">svm_pred <span class="token operator">=</span> svm_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_val<span class="token punctuation">)</span></span>
<span class="line">svm_accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> svm_pred<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SVM准确率: </span><span class="token interpolation"><span class="token punctuation">{</span>svm_accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 交叉验证</span></span>
<span class="line">models <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Decision Tree&#39;</span><span class="token punctuation">:</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Random Forest&#39;</span><span class="token punctuation">:</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;SVM&#39;</span><span class="token punctuation">:</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">&#39;rbf&#39;</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    scores <span class="token operator">=</span> cross_val_score<span class="token punctuation">(</span>model<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> scoring<span class="token operator">=</span><span class="token string">&#39;accuracy&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> 交叉验证准确率: </span><span class="token interpolation"><span class="token punctuation">{</span>scores<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string"> ± </span><span class="token interpolation"><span class="token punctuation">{</span>scores<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看最佳模型的混淆矩阵和分类报告</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;随机森林混淆矩阵:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>confusion_matrix<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> rf_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\n随机森林分类报告:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> rf_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 特征重要性</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">importances <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>feature_importances_</span>
<span class="line">indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>importances<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importances<span class="token punctuation">[</span>indices<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>columns<span class="token punctuation">[</span>indices<span class="token punctuation">]</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Feature Importances&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="步骤4-模型优化" tabindex="-1"><a class="header-anchor" href="#步骤4-模型优化"><span>步骤4：模型优化</span></a></h3><p>我们可以通过超参数调优来进一步提高模型性能。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 随机森林参数网格</span></span>
<span class="line">param_grid <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;n_estimators&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;max_depth&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;min_samples_split&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;min_samples_leaf&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 网格搜索</span></span>
<span class="line">grid_search <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>RandomForestClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">                           param_grid<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> scoring<span class="token operator">=</span><span class="token string">&#39;accuracy&#39;</span><span class="token punctuation">)</span></span>
<span class="line">grid_search<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 最佳参数</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;最佳参数:&quot;</span><span class="token punctuation">,</span> grid_search<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;最佳交叉验证得分:&quot;</span><span class="token punctuation">,</span> grid_search<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用最佳参数的模型</span></span>
<span class="line">best_rf_model <span class="token operator">=</span> grid_search<span class="token punctuation">.</span>best_estimator_</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="步骤5-预测测试集" tabindex="-1"><a class="header-anchor" href="#步骤5-预测测试集"><span>步骤5：预测测试集</span></a></h3><p>最后，我们使用最佳模型对测试集进行预测。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 加载测试数据</span></span>
<span class="line">test_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;titanic_test.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 对测试数据进行相同的预处理</span></span>
<span class="line"><span class="token comment"># (重复上面的预处理步骤)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用最佳模型预测</span></span>
<span class="line">test_predictions <span class="token operator">=</span> best_rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_encoded<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建提交文件</span></span>
<span class="line">submission <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;PassengerId&#39;</span><span class="token punctuation">:</span> test_data<span class="token punctuation">[</span><span class="token string">&#39;PassengerId&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Survived&#39;</span><span class="token punctuation">:</span> test_predictions</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">submission<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&#39;titanic_submission.csv&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="结果分析" tabindex="-1"><a class="header-anchor" href="#结果分析"><span>结果分析</span></a></h2><p>通过我们的分析和建模，我们发现以下因素对泰坦尼克号乘客生存率有显著影响：</p><ol><li><strong>性别</strong>：女性的生存率显著高于男性</li><li><strong>船票等级</strong>：一等舱乘客生存率高于二等舱和三等舱</li><li><strong>年龄</strong>：儿童的生存率高于成人</li><li><strong>家庭规模</strong>：中等规模家庭的成员生存率较高</li><li><strong>称谓</strong>：反映社会地位的称谓与生存率相关</li></ol><p>这些发现与历史记录一致，反映了&quot;女士和儿童优先&quot;的救生政策以及社会阶层对生存机会的影响。</p><h2 id="进阶挑战" tabindex="-1"><a class="header-anchor" href="#进阶挑战"><span>进阶挑战</span></a></h2><p>如果你已经完成了基本任务，可以尝试以下进阶挑战：</p><ol><li><strong>特征工程</strong>：尝试创建更多有意义的特征，如票价区间、年龄组等</li><li><strong>模型集成</strong>：使用投票或堆叠方法组合多个模型的预测</li><li><strong>生存概率分析</strong>：不仅预测生存与否，还分析不同特征组合的生存概率</li><li><strong>可视化</strong>：创建更高级的可视化，如决策树可视化或生存率热图</li><li><strong>缺失值处理</strong>：尝试更复杂的缺失值填充方法，如基于相似乘客特征的填充</li></ol><h2 id="小结与反思" tabindex="-1"><a class="header-anchor" href="#小结与反思"><span>小结与反思</span></a></h2><p>通过这个项目，我们学习了如何处理一个完整的分类问题，从数据探索到模型部署。泰坦尼克号数据集虽小，但包含了数据挖掘中常见的挑战，如缺失值处理、特征工程和模型选择。</p><p>在实际应用中，这类分析可以帮助我们理解影响某一结果的关键因素，从而制定更有效的策略和政策。例如，在灾难管理中，类似的分析可以帮助识别高风险群体，优先分配资源。</p><h3 id="思考问题" tabindex="-1"><a class="header-anchor" href="#思考问题"><span>思考问题</span></a></h3><ol><li>我们的模型是否存在偏见？如何确保预测的公平性？</li><li>如何将这种分析方法应用到其他灾难或事件预测中？</li><li>除了准确率外，还有哪些指标可以评估模型的有效性？</li></ol><div class="practice-link"><a href="/projects/iris.html" class="button">下一个项目：鸢尾花分类</a></div>`,41)]))}const i=s(e,[["render",l],["__file","titanic.html.vue"]]),u=JSON.parse('{"path":"/projects/titanic.html","title":"泰坦尼克号生存预测","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"项目背景","slug":"项目背景","link":"#项目背景","children":[]},{"level":2,"title":"数据集介绍","slug":"数据集介绍","link":"#数据集介绍","children":[]},{"level":2,"title":"项目目标","slug":"项目目标","link":"#项目目标","children":[]},{"level":2,"title":"实施步骤","slug":"实施步骤","link":"#实施步骤","children":[{"level":3,"title":"步骤1：数据探索与可视化","slug":"步骤1-数据探索与可视化","link":"#步骤1-数据探索与可视化","children":[]},{"level":3,"title":"步骤2：数据预处理","slug":"步骤2-数据预处理","link":"#步骤2-数据预处理","children":[]},{"level":3,"title":"步骤3：模型构建与评估","slug":"步骤3-模型构建与评估","link":"#步骤3-模型构建与评估","children":[]},{"level":3,"title":"步骤4：模型优化","slug":"步骤4-模型优化","link":"#步骤4-模型优化","children":[]},{"level":3,"title":"步骤5：预测测试集","slug":"步骤5-预测测试集","link":"#步骤5-预测测试集","children":[]}]},{"level":2,"title":"结果分析","slug":"结果分析","link":"#结果分析","children":[]},{"level":2,"title":"进阶挑战","slug":"进阶挑战","link":"#进阶挑战","children":[]},{"level":2,"title":"小结与反思","slug":"小结与反思","link":"#小结与反思","children":[{"level":3,"title":"思考问题","slug":"思考问题","link":"#思考问题","children":[]}]}],"git":{},"filePathRelative":"projects/titanic.md"}');export{i as comp,u as data};
