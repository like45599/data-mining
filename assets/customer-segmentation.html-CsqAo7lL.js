import{_ as s,e as a,i as p,o as t}from"./app-CztZx2qC.js";const e={};function c(l,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h1 id="å®¢æˆ·åˆ†ç¾¤åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·åˆ†ç¾¤åˆ†æ"><span>å®¢æˆ·åˆ†ç¾¤åˆ†æ</span></a></h1><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿° </div><div class="knowledge-card__content"><ul><li><strong>éš¾åº¦</strong>ï¼šä¸­çº§</li><li><strong>ç±»å‹</strong>ï¼šèšç±»åˆ†æ</li><li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šæ•°æ®æ ‡å‡†åŒ–ã€K-Meansèšç±»ã€èšç±»è¯„ä¼°ã€ä¸šåŠ¡è§£é‡Š</li><li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/clustering/kmeans.html">èšç±»ç®—æ³•</a></li></ul></div></div><h2 id="é¡¹ç›®èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®èƒŒæ™¯"><span>é¡¹ç›®èƒŒæ™¯</span></a></h2><p>å®¢æˆ·åˆ†ç¾¤æ˜¯ä¼ä¸šç†è§£å®¢æˆ·è¡Œä¸ºå’Œåå¥½çš„é‡è¦ç­–ç•¥ï¼Œé€šè¿‡å°†ç›¸ä¼¼çš„å®¢æˆ·åˆ†ç»„ï¼Œä¼ä¸šå¯ä»¥å¼€å‘é’ˆå¯¹æ€§çš„è¥é”€ç­–ç•¥ã€äº§å“æ¨èå’ŒæœåŠ¡æ–¹æ¡ˆã€‚ä¼ ç»Ÿçš„å®¢æˆ·åˆ†ç¾¤é€šå¸¸åŸºäºäººå£ç»Ÿè®¡å­¦ç‰¹å¾ï¼ˆå¦‚å¹´é¾„ã€æ€§åˆ«ã€æ”¶å…¥ï¼‰ï¼Œä½†ç°ä»£åˆ†ææ–¹æ³•å¯ä»¥ç»“åˆäº¤æ˜“å†å²ã€æµè§ˆè¡Œä¸ºå’Œäº’åŠ¨æ¨¡å¼ç­‰å¤šç»´æ•°æ®ï¼Œåˆ›å»ºæ›´ç²¾ç»†å’Œæœ‰æ„ä¹‰çš„å®¢æˆ·ç¾¤ä½“ã€‚</p><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨èšç±»ç®—æ³•å¯¹é›¶å”®å•†çš„å®¢æˆ·æ•°æ®è¿›è¡Œåˆ†ç¾¤ï¼Œå‘ç°ä¸åŒå®¢æˆ·ç¾¤ä½“çš„ç‰¹å¾å’Œè¡Œä¸ºæ¨¡å¼ï¼Œä¸ºä¸šåŠ¡å†³ç­–æä¾›æ”¯æŒã€‚</p><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ </div><div class="knowledge-card__content"><p>RFMåˆ†ææ˜¯å®¢æˆ·åˆ†ç¾¤çš„ç»å…¸æ–¹æ³•ï¼ŒåŸºäºä¸‰ä¸ªå…³é”®æŒ‡æ ‡ï¼šæœ€è¿‘ä¸€æ¬¡è´­ä¹°æ—¶é—´(Recency)ã€è´­ä¹°é¢‘ç‡(Frequency)å’Œæ¶ˆè´¹é‡‘é¢(Monetary)ã€‚è¿™ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•è‡³ä»Šä»è¢«å¹¿æ³›åº”ç”¨ï¼Œå¹¶å¯ä»¥ä¸ç°ä»£èšç±»ç®—æ³•ç»“åˆï¼Œåˆ›å»ºæ›´ç²¾ç»†çš„å®¢æˆ·ç”»åƒã€‚</p></div></div><h2 id="æ•°æ®é›†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†ä»‹ç»"><span>æ•°æ®é›†ä»‹ç»</span></a></h2><p>æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«ä¸€å®¶åœ¨çº¿é›¶å”®å•†ä¸€å¹´å†…çš„äº¤æ˜“è®°å½•ï¼Œå…±æœ‰çº¦50,000æ¡äº¤æ˜“å’Œä»¥ä¸‹å­—æ®µï¼š</p><ul><li><strong>CustomerID</strong>ï¼šå®¢æˆ·å”¯ä¸€æ ‡è¯†ç¬¦</li><li><strong>InvoiceNo</strong>ï¼šå‘ç¥¨ç¼–å·</li><li><strong>InvoiceDate</strong>ï¼šäº¤æ˜“æ—¥æœŸå’Œæ—¶é—´</li><li><strong>StockCode</strong>ï¼šäº§å“ä»£ç </li><li><strong>Description</strong>ï¼šäº§å“æè¿°</li><li><strong>Quantity</strong>ï¼šè´­ä¹°æ•°é‡</li><li><strong>UnitPrice</strong>ï¼šå•ä»·</li><li><strong>Country</strong>ï¼šå®¢æˆ·æ‰€åœ¨å›½å®¶</li></ul><p>æˆ‘ä»¬å°†ä»è¿™äº›äº¤æ˜“æ•°æ®ä¸­æå–å®¢æˆ·çº§åˆ«çš„ç‰¹å¾ï¼Œç„¶ååº”ç”¨èšç±»ç®—æ³•è¿›è¡Œåˆ†ç¾¤ã€‚</p><h2 id="é¡¹ç›®ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®æ ‡"><span>é¡¹ç›®ç›®æ ‡</span></a></h2><ol><li>ä»äº¤æ˜“æ•°æ®ä¸­æå–å®¢æˆ·çº§åˆ«çš„ç‰¹å¾</li><li>åº”ç”¨K-Meansç­‰èšç±»ç®—æ³•å¯¹å®¢æˆ·è¿›è¡Œåˆ†ç¾¤</li><li>è¯„ä¼°èšç±»ç»“æœå¹¶ç¡®å®šæœ€ä½³ç°‡æ•°</li><li>åˆ†æä¸åŒå®¢æˆ·ç¾¤ä½“çš„ç‰¹å¾å’Œè¡Œä¸ºæ¨¡å¼</li><li>æå‡ºåŸºäºåˆ†ç¾¤ç»“æœçš„ä¸šåŠ¡å»ºè®®</li></ol><h2 id="å®æ–½æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®æ–½æ­¥éª¤"><span>å®æ–½æ­¥éª¤</span></a></h2><h3 id="æ­¥éª¤1-æ•°æ®åŠ è½½ä¸é¢„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤1-æ•°æ®åŠ è½½ä¸é¢„å¤„ç†"><span>æ­¥éª¤1ï¼šæ•°æ®åŠ è½½ä¸é¢„å¤„ç†</span></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬åŠ è½½æ•°æ®å¹¶è¿›è¡Œå¿…è¦çš„é¢„å¤„ç†ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> silhouette_score</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA</span>
<span class="line"><span class="token keyword">import</span> warnings</span>
<span class="line">warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;online_retail.csv&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;ISO-8859-1&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ•°æ®æ¸…æ´—</span></span>
<span class="line"><span class="token comment"># ç§»é™¤ç¼ºå¤±çš„CustomerID</span></span>
<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;CustomerID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç§»é™¤å–æ¶ˆçš„è®¢å•ï¼ˆQuantity &lt; 0ï¼‰</span></span>
<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;Quantity&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç§»é™¤å•ä»·ä¸º0æˆ–è´Ÿæ•°çš„è®°å½•</span></span>
<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;UnitPrice&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†CustomerIDè½¬æ¢ä¸ºæ•´æ•°</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;CustomerID&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;CustomerID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†InvoiceDateè½¬æ¢ä¸ºæ—¥æœŸæ—¶é—´æ ¼å¼</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;InvoiceDate&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;InvoiceDate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ€»é‡‘é¢åˆ—</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;TotalAmount&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;Quantity&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> df<span class="token punctuation">[</span><span class="token string">&#39;UnitPrice&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ¸…æ´—åçš„æ•°æ®</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æ¸…æ´—åçš„æ•°æ®å½¢çŠ¶:&quot;</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>shape<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ¯ä¸ªå›½å®¶çš„å®¢æˆ·æ•°é‡</span></span>
<span class="line">country_counts <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;Country&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;CustomerID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">country_counts<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;å„å›½å®¶å®¢æˆ·æ•°é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;å›½å®¶&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;å®¢æˆ·æ•°é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤2-ç‰¹å¾æå–-rfmåˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤2-ç‰¹å¾æå–-rfmåˆ†æ"><span>æ­¥éª¤2ï¼šç‰¹å¾æå– - RFMåˆ†æ</span></a></h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨RFMæ–¹æ³•ä»äº¤æ˜“æ•°æ®ä¸­æå–å®¢æˆ·çº§åˆ«çš„ç‰¹å¾ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è®¾ç½®åˆ†ææˆªæ­¢æ—¥æœŸï¼ˆæ•°æ®é›†ä¸­çš„æœ€åä¸€å¤©åŠ 1å¤©ï¼‰</span></span>
<span class="line">snapshot_date <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;InvoiceDate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—RFMæŒ‡æ ‡</span></span>
<span class="line">rfm <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;CustomerID&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;InvoiceDate&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>snapshot_date <span class="token operator">-</span> x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>days<span class="token punctuation">,</span>  <span class="token comment"># Recency</span></span>
<span class="line">    <span class="token string">&#39;InvoiceNo&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;nunique&#39;</span><span class="token punctuation">,</span>  <span class="token comment"># Frequency</span></span>
<span class="line">    <span class="token string">&#39;TotalAmount&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;sum&#39;</span>  <span class="token comment"># Monetary</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é‡å‘½ååˆ—</span></span>
<span class="line">rfm<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹RFMæ•°æ®</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>rfm<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>rfm<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–RFMåˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> kde<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Recencyåˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> kde<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Frequencyåˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> kde<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Monetaryåˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹RFMæŒ‡æ ‡ä¹‹é—´çš„ç›¸å…³æ€§</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>rfm<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;coolwarm&#39;</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">&#39;.2f&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;RFMæŒ‡æ ‡ç›¸å…³æ€§&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤3-ç‰¹å¾å¤„ç†ä¸æ ‡å‡†åŒ–" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤3-ç‰¹å¾å¤„ç†ä¸æ ‡å‡†åŒ–"><span>æ­¥éª¤3ï¼šç‰¹å¾å¤„ç†ä¸æ ‡å‡†åŒ–</span></a></h3><p>åœ¨åº”ç”¨èšç±»ç®—æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†å¼‚å¸¸å€¼å¹¶æ ‡å‡†åŒ–ç‰¹å¾ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># å¤„ç†å¼‚å¸¸å€¼</span></span>
<span class="line"><span class="token comment"># ä½¿ç”¨IQRæ–¹æ³•è¯†åˆ«å¼‚å¸¸å€¼</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">remove_outliers</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> columns<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    df_clean <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> col <span class="token keyword">in</span> columns<span class="token punctuation">:</span></span>
<span class="line">        Q1 <span class="token operator">=</span> df_clean<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span></span>
<span class="line">        Q3 <span class="token operator">=</span> df_clean<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">)</span></span>
<span class="line">        IQR <span class="token operator">=</span> Q3 <span class="token operator">-</span> Q1</span>
<span class="line">        lower_bound <span class="token operator">=</span> Q1 <span class="token operator">-</span> <span class="token number">1.5</span> <span class="token operator">*</span> IQR</span>
<span class="line">        upper_bound <span class="token operator">=</span> Q3 <span class="token operator">+</span> <span class="token number">1.5</span> <span class="token operator">*</span> IQR</span>
<span class="line">        df_clean <span class="token operator">=</span> df_clean<span class="token punctuation">[</span><span class="token punctuation">(</span>df_clean<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> lower_bound<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df_clean<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> upper_bound<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">return</span> df_clean</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨å¼‚å¸¸å€¼å¤„ç†</span></span>
<span class="line">rfm_clean <span class="token operator">=</span> remove_outliers<span class="token punctuation">(</span>rfm<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ç§»é™¤å¼‚å¸¸å€¼å‰: </span><span class="token interpolation"><span class="token punctuation">{</span>rfm<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">è¡Œ, ç§»é™¤å: </span><span class="token interpolation"><span class="token punctuation">{</span>rfm_clean<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">è¡Œ&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯¹æ•°å˜æ¢å¤„ç†åæ–œåˆ†å¸ƒ</span></span>
<span class="line">rfm_log <span class="token operator">=</span> rfm_clean<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>log1p<span class="token punctuation">(</span>rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>log1p<span class="token punctuation">(</span>rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–å˜æ¢åçš„åˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> kde<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Recencyåˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> kde<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Log(Frequency)åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>histplot<span class="token punctuation">(</span>rfm_log<span class="token punctuation">[</span><span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> kde<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Log(Monetary)åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡†å¤‡èšç±»ç‰¹å¾</span></span>
<span class="line">X <span class="token operator">=</span> rfm_log<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ‡å‡†åŒ–</span></span>
<span class="line">scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X_scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è½¬æ¢å›DataFrameä»¥ä¾¿äºåˆ†æ</span></span>
<span class="line">X_scaled_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>X_scaled<span class="token punctuation">,</span> index<span class="token operator">=</span>X<span class="token punctuation">.</span>index<span class="token punctuation">,</span> columns<span class="token operator">=</span>X<span class="token punctuation">.</span>columns<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>X_scaled_df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤4-ç¡®å®šæœ€ä½³ç°‡æ•°" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤4-ç¡®å®šæœ€ä½³ç°‡æ•°"><span>æ­¥éª¤4ï¼šç¡®å®šæœ€ä½³ç°‡æ•°</span></a></h3><p>ä½¿ç”¨è‚˜éƒ¨æ³•åˆ™å’Œè½®å»“ç³»æ•°ç¡®å®šæœ€ä½³ç°‡æ•°ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è‚˜éƒ¨æ³•åˆ™</span></span>
<span class="line">inertia <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">silhouette_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">k_range <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> k <span class="token keyword">in</span> k_range<span class="token punctuation">:</span></span>
<span class="line">    kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>k<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> n_init<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line">    kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_scaled<span class="token punctuation">)</span></span>
<span class="line">    inertia<span class="token punctuation">.</span>append<span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>inertia_<span class="token punctuation">)</span></span>
<span class="line">    silhouette_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>silhouette_score<span class="token punctuation">(</span>X_scaled<span class="token punctuation">,</span> kmeans<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–è‚˜éƒ¨æ³•åˆ™</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>k_range<span class="token punctuation">,</span> inertia<span class="token punctuation">,</span> <span class="token string">&#39;o-&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;ç°‡æ•° (k)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;æƒ¯æ€§&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;è‚˜éƒ¨æ³•åˆ™&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>k_range<span class="token punctuation">,</span> silhouette_scores<span class="token punctuation">,</span> <span class="token string">&#39;o-&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;ç°‡æ•° (k)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;è½®å»“ç³»æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;è½®å»“ç³»æ•°æ³•&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ¹æ®ç»“æœé€‰æ‹©æœ€ä½³ç°‡æ•°</span></span>
<span class="line">best_k <span class="token operator">=</span> k_range<span class="token punctuation">[</span>silhouette_scores<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>silhouette_scores<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æœ€ä½³ç°‡æ•° (åŸºäºè½®å»“ç³»æ•°): </span><span class="token interpolation"><span class="token punctuation">{</span>best_k<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤5-åº”ç”¨k-meansèšç±»" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤5-åº”ç”¨k-meansèšç±»"><span>æ­¥éª¤5ï¼šåº”ç”¨K-Meansèšç±»</span></a></h3><p>ä½¿ç”¨ç¡®å®šçš„æœ€ä½³ç°‡æ•°åº”ç”¨K-Meansèšç±»ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># åº”ç”¨K-Meansèšç±»</span></span>
<span class="line">kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>best_k<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> n_init<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line">rfm<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> kmeans<span class="token punctuation">.</span>fit_predict<span class="token punctuation">(</span>X_scaled<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ¯ä¸ªç°‡çš„å¤§å°</span></span>
<span class="line">cluster_sizes <span class="token operator">=</span> rfm<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å„ç°‡å¤§å°:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>cluster_sizes<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—æ¯ä¸ªç°‡çš„ä¸­å¿ƒç‚¹ï¼ˆåŸå§‹å°ºåº¦ï¼‰</span></span>
<span class="line">cluster_centers <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>scaler<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>cluster_centers_<span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">                              columns<span class="token operator">=</span>features<span class="token punctuation">)</span></span>
<span class="line">cluster_centers<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>best_k<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\nç°‡ä¸­å¿ƒç‚¹:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>cluster_centers<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–èšç±»ç»“æœï¼ˆä½¿ç”¨PCAé™ç»´åˆ°2Dï¼‰</span></span>
<span class="line">pca <span class="token operator">=</span> PCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">X_pca <span class="token operator">=</span> pca<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_scaled<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>best_k<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_pca<span class="token punctuation">[</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_pca<span class="token punctuation">[</span>rfm<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;Cluster </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>cluster_centers_<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>cluster_centers_<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> </span>
<span class="line">            s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">&#39;X&#39;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Centroids&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;å®¢æˆ·åˆ†ç¾¤ (PCAé™ç»´å¯è§†åŒ–)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;ä¸»æˆåˆ†1&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;ä¸»æˆåˆ†2&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤6-åˆ†æå®¢æˆ·ç¾¤ä½“ç‰¹å¾" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤6-åˆ†æå®¢æˆ·ç¾¤ä½“ç‰¹å¾"><span>æ­¥éª¤6ï¼šåˆ†æå®¢æˆ·ç¾¤ä½“ç‰¹å¾</span></a></h3><p>åˆ†ææ¯ä¸ªå®¢æˆ·ç¾¤ä½“çš„ç‰¹å¾ï¼Œå¹¶ä¸ºä¸šåŠ¡æä¾›å»ºè®®ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># åˆ†ææ¯ä¸ªç°‡çš„RFMç‰¹å¾</span></span>
<span class="line">cluster_analysis <span class="token operator">=</span> rfm<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Recency&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;mean&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;mean&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;mean&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–æ¯ä¸ªç°‡çš„ç‰¹å¾</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>cluster_analysis<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;å„ç°‡çš„å¹³å‡æœ€è¿‘è´­ä¹°å¤©æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>cluster_analysis<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;å„ç°‡çš„å¹³å‡è´­ä¹°é¢‘ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>cluster_analysis<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;å„ç°‡çš„å¹³å‡æ¶ˆè´¹é‡‘é¢&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é›·è¾¾å›¾å¯è§†åŒ–å„ç°‡ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">from</span> math <span class="token keyword">import</span> pi</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ‡å‡†åŒ–æ•°æ®ç”¨äºé›·è¾¾å›¾</span></span>
<span class="line">radar_df <span class="token operator">=</span> cluster_analysis<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> feature <span class="token keyword">in</span> features<span class="token punctuation">:</span></span>
<span class="line">    radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span> <span class="token operator">-</span> radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># å¯¹äºRecencyï¼Œå€¼è¶Šå°è¶Šå¥½ï¼Œæ‰€ä»¥å–å</span></span>
<span class="line">    <span class="token keyword">if</span> feature <span class="token operator">==</span> <span class="token string">&#39;Recency&#39;</span><span class="token punctuation">:</span></span>
<span class="line">        radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> radar_df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¾ç½®é›·è¾¾å›¾</span></span>
<span class="line">categories <span class="token operator">=</span> features</span>
<span class="line">N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>categories<span class="token punctuation">)</span></span>
<span class="line">angles <span class="token operator">=</span> <span class="token punctuation">[</span>n <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">angles <span class="token operator">+=</span> angles<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">,</span> polar<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> i<span class="token punctuation">,</span> cluster <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>radar_df<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    values <span class="token operator">=</span> radar_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>radar_df<span class="token punctuation">[</span><span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> cluster<span class="token punctuation">,</span> features<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    values <span class="token operator">+=</span> values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>angles<span class="token punctuation">,</span> values<span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;solid&#39;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;Cluster </span><span class="token interpolation"><span class="token punctuation">{</span>cluster<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    ax<span class="token punctuation">.</span>fill<span class="token punctuation">(</span>angles<span class="token punctuation">,</span> values<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>angles<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> categories<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;0.2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0.4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0.6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0.8&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;grey&quot;</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">&#39;upper right&#39;</span><span class="token punctuation">,</span> bbox_to_anchor<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;å®¢æˆ·ç¾¤ä½“ç‰¹å¾é›·è¾¾å›¾&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®¢æˆ·ç¾¤ä½“å‘½åå’Œä¸šåŠ¡å»ºè®®</span></span>
<span class="line">cluster_names <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">&quot;é«˜ä»·å€¼å¿ è¯šå®¢æˆ·&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">&quot;æ½œåŠ›å®¢æˆ·&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">&quot;ä¼‘çœ å®¢æˆ·&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">&quot;æ–°å®¢æˆ·&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">business_recommendations <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">&quot;æä¾›VIPæœåŠ¡ï¼Œå‘é€ä¸ªæ€§åŒ–ä¼˜æƒ ï¼Œé¼“åŠ±æ¨èæ–°å®¢æˆ·&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">&quot;æä¾›è´­ä¹°æ¿€åŠ±ï¼Œå¢åŠ è´­ä¹°é¢‘ç‡ï¼Œæ¨èç›¸å…³äº§å“&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">&quot;å‘é€é‡æ–°æ¿€æ´»é‚®ä»¶ï¼Œæä¾›ç‰¹åˆ«æŠ˜æ‰£ï¼Œäº†è§£æµå¤±åŸå› &quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">&quot;æä¾›è‰¯å¥½çš„é¦–æ¬¡ä½“éªŒï¼Œé¼“åŠ±ç¬¬äºŒæ¬¡è´­ä¹°ï¼Œæ”¶é›†åé¦ˆ&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæœ€ç»ˆçš„å®¢æˆ·åˆ†ç¾¤æŠ¥å‘Š</span></span>
<span class="line">cluster_report <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Cluster&#39;</span><span class="token punctuation">:</span> <span class="token builtin">range</span><span class="token punctuation">(</span>best_k<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Name&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>cluster_names<span class="token punctuation">.</span>get<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f&quot;Cluster </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>best_k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Size&#39;</span><span class="token punctuation">:</span> cluster_sizes<span class="token punctuation">.</span>values<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Recency&#39;</span><span class="token punctuation">:</span> cluster_analysis<span class="token punctuation">[</span><span class="token string">&#39;Recency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">:</span> cluster_analysis<span class="token punctuation">[</span><span class="token string">&#39;Frequency&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">:</span> cluster_analysis<span class="token punctuation">[</span><span class="token string">&#39;Monetary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Business Recommendations&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>business_recommendations<span class="token punctuation">.</span>get<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>best_k<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å®¢æˆ·åˆ†ç¾¤æŠ¥å‘Š:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>cluster_report<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç»“æœåˆ†æ" tabindex="-1"><a class="header-anchor" href="#ç»“æœåˆ†æ"><span>ç»“æœåˆ†æ</span></a></h2><p>é€šè¿‡K-Meansèšç±»ç®—æ³•ï¼Œæˆ‘ä»¬æˆåŠŸå°†å®¢æˆ·åˆ†ä¸ºå‡ ä¸ªä¸åŒçš„ç¾¤ä½“ï¼Œæ¯ä¸ªç¾¤ä½“å…·æœ‰ä¸åŒçš„è´­ä¹°è¡Œä¸ºç‰¹å¾ï¼š</p><ol><li><strong>é«˜ä»·å€¼å¿ è¯šå®¢æˆ·</strong>ï¼šè¿™äº›å®¢æˆ·æœ€è¿‘æœ‰è´­ä¹°ï¼Œè´­ä¹°é¢‘ç‡é«˜ï¼Œæ¶ˆè´¹é‡‘é¢å¤§ã€‚ä»–ä»¬æ˜¯ä¼ä¸šçš„æ ¸å¿ƒå®¢æˆ·ç¾¤ä½“ï¼Œè´¡çŒ®äº†å¤§éƒ¨åˆ†æ”¶å…¥ã€‚</li><li><strong>æ½œåŠ›å®¢æˆ·</strong>ï¼šè¿™äº›å®¢æˆ·è´­ä¹°é¢‘ç‡ä¸­ç­‰ï¼Œæ¶ˆè´¹é‡‘é¢é€‚ä¸­ï¼Œæœ‰æˆä¸ºé«˜ä»·å€¼å®¢æˆ·çš„æ½œåŠ›ã€‚</li><li><strong>ä¼‘çœ å®¢æˆ·</strong>ï¼šè¿™äº›å®¢æˆ·å¾ˆä¹…æ²¡æœ‰è´­ä¹°äº†ï¼Œä½†ä¹‹å‰æœ‰è¿‡è¾ƒå¥½çš„è´­ä¹°è®°å½•ã€‚ä»–ä»¬æ˜¯é‡æ–°æ¿€æ´»è¥é”€çš„ç›®æ ‡ã€‚</li><li><strong>æ–°å®¢æˆ·</strong>ï¼šè¿™äº›å®¢æˆ·æœ€è¿‘æ‰å¼€å§‹è´­ä¹°ï¼Œé¢‘ç‡å’Œé‡‘é¢éƒ½è¾ƒä½ã€‚éœ€è¦ç‰¹åˆ«å…³æ³¨ä»¥æé«˜ç•™å­˜ç‡ã€‚</li></ol><p>è¿™ç§å®¢æˆ·åˆ†ç¾¤å¯ä»¥å¸®åŠ©ä¼ä¸šåˆ¶å®šé’ˆå¯¹æ€§çš„è¥é”€ç­–ç•¥ï¼Œæé«˜å®¢æˆ·æ»¡æ„åº¦å’Œå¿ è¯šåº¦ï¼Œæœ€ç»ˆæå‡é”€å”®ä¸šç»©å’Œå®¢æˆ·ç»ˆèº«ä»·å€¼ã€‚</p><h2 id="è¿›é˜¶æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶æŒ‘æˆ˜"><span>è¿›é˜¶æŒ‘æˆ˜</span></a></h2><p>å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š</p><ol><li><strong>æ‰©å±•ç‰¹å¾é›†</strong>ï¼šé™¤äº†RFMæŒ‡æ ‡ï¼Œå°è¯•åŠ å…¥äº§å“ç±»åˆ«åå¥½ã€è´­ä¹°æ—¶é—´æ¨¡å¼ç­‰ç‰¹å¾</li><li><strong>å°è¯•å…¶ä»–èšç±»ç®—æ³•</strong>ï¼šæ¯”è¾ƒå±‚æ¬¡èšç±»ã€DBSCANç­‰ç®—æ³•ä¸K-Meansçš„ç»“æœå·®å¼‚</li><li><strong>æ—¶é—´åºåˆ—åˆ†æ</strong>ï¼šåˆ†æå®¢æˆ·ç¾¤ä½“éšæ—¶é—´çš„å˜åŒ–ï¼Œè¯†åˆ«å®¢æˆ·è¿ç§»æ¨¡å¼</li><li><strong>é¢„æµ‹æ¨¡å‹</strong>ï¼šåŸºäºèšç±»ç»“æœæ„å»ºå®¢æˆ·æµå¤±é¢„æµ‹æˆ–ä¸‹ä¸€æ¬¡è´­ä¹°é¢„æµ‹æ¨¡å‹</li><li><strong>æ¨èç³»ç»Ÿ</strong>ï¼šä¸ºæ¯ä¸ªå®¢æˆ·ç¾¤ä½“å¼€å‘å®šåˆ¶çš„äº§å“æ¨èç­–ç•¥</li></ol><h2 id="å°ç»“ä¸åæ€" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸åæ€"><span>å°ç»“ä¸åæ€</span></a></h2><p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨èšç±»ç®—æ³•å¯¹å®¢æˆ·è¿›è¡Œåˆ†ç¾¤ï¼Œå¹¶ä»æ•°æ®ä¸­æå–æœ‰ä»·å€¼çš„ä¸šåŠ¡æ´å¯Ÿã€‚å®¢æˆ·åˆ†ç¾¤æ˜¯ç†è§£å®¢æˆ·è¡Œä¸ºå’Œåå¥½çš„å¼ºå¤§å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä¼ä¸šä¼˜åŒ–è¥é”€ç­–ç•¥ã€æé«˜å®¢æˆ·æ»¡æ„åº¦å’Œå¿ è¯šåº¦ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå®¢æˆ·åˆ†ç¾¤åº”è¯¥æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œéšç€æ–°æ•°æ®çš„ç§¯ç´¯å’Œä¸šåŠ¡ç¯å¢ƒçš„å˜åŒ–ï¼Œåˆ†ç¾¤ç»“æœéœ€è¦å®šæœŸæ›´æ–°ã€‚æ­¤å¤–ï¼Œåˆ†ç¾¤ç»“æœçš„è§£é‡Šå’Œåº”ç”¨éœ€è¦ç»“åˆå…·ä½“çš„ä¸šåŠ¡èƒŒæ™¯å’Œç›®æ ‡ï¼Œæ‰èƒ½å‘æŒ¥æœ€å¤§ä»·å€¼ã€‚</p><h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3><ol><li>é™¤äº†RFMæŒ‡æ ‡ï¼Œè¿˜æœ‰å“ªäº›å®¢æˆ·ç‰¹å¾å¯èƒ½å¯¹åˆ†ç¾¤æœ‰ä»·å€¼ï¼Ÿå¦‚ä½•è·å–å’Œæ•´åˆè¿™äº›ç‰¹å¾ï¼Ÿ</li><li>ä¸åŒè¡Œä¸šçš„å®¢æˆ·åˆ†ç¾¤å¯èƒ½æœ‰ä»€ä¹ˆå·®å¼‚ï¼Ÿä¾‹å¦‚ï¼Œç”µå­å•†åŠ¡ã€é‡‘èæœåŠ¡å’Œå†…å®¹è®¢é˜…æœåŠ¡çš„å®¢æˆ·åˆ†ç¾¤åº”è¯¥å…³æ³¨å“ªäº›ä¸åŒçš„æŒ‡æ ‡ï¼Ÿ</li><li>å¦‚ä½•è¯„ä¼°å®¢æˆ·åˆ†ç¾¤çš„ä¸šåŠ¡ä»·å€¼ï¼Ÿæœ‰å“ªäº›æŒ‡æ ‡å¯ä»¥è¡¡é‡åˆ†ç¾¤ç­–ç•¥çš„æœ‰æ•ˆæ€§ï¼Ÿ</li></ol><div class="practice-link"><a href="/projects/clustering/image-segmentation.html" class="button">ä¸‹ä¸€ä¸ªé¡¹ç›®ï¼šå›¾åƒé¢œè‰²åˆ†å‰²</a></div>`,44)]))}const i=s(e,[["render",c],["__file","customer-segmentation.html.vue"]]),u=JSON.parse('{"path":"/projects/clustering/customer-segmentation.html","title":"å®¢æˆ·åˆ†ç¾¤åˆ†æ","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"é¡¹ç›®èƒŒæ™¯","slug":"é¡¹ç›®èƒŒæ™¯","link":"#é¡¹ç›®èƒŒæ™¯","children":[]},{"level":2,"title":"æ•°æ®é›†ä»‹ç»","slug":"æ•°æ®é›†ä»‹ç»","link":"#æ•°æ®é›†ä»‹ç»","children":[]},{"level":2,"title":"é¡¹ç›®ç›®æ ‡","slug":"é¡¹ç›®ç›®æ ‡","link":"#é¡¹ç›®ç›®æ ‡","children":[]},{"level":2,"title":"å®æ–½æ­¥éª¤","slug":"å®æ–½æ­¥éª¤","link":"#å®æ–½æ­¥éª¤","children":[{"level":3,"title":"æ­¥éª¤1ï¼šæ•°æ®åŠ è½½ä¸é¢„å¤„ç†","slug":"æ­¥éª¤1-æ•°æ®åŠ è½½ä¸é¢„å¤„ç†","link":"#æ­¥éª¤1-æ•°æ®åŠ è½½ä¸é¢„å¤„ç†","children":[]},{"level":3,"title":"æ­¥éª¤2ï¼šç‰¹å¾æå– - RFMåˆ†æ","slug":"æ­¥éª¤2-ç‰¹å¾æå–-rfmåˆ†æ","link":"#æ­¥éª¤2-ç‰¹å¾æå–-rfmåˆ†æ","children":[]},{"level":3,"title":"æ­¥éª¤3ï¼šç‰¹å¾å¤„ç†ä¸æ ‡å‡†åŒ–","slug":"æ­¥éª¤3-ç‰¹å¾å¤„ç†ä¸æ ‡å‡†åŒ–","link":"#æ­¥éª¤3-ç‰¹å¾å¤„ç†ä¸æ ‡å‡†åŒ–","children":[]},{"level":3,"title":"æ­¥éª¤4ï¼šç¡®å®šæœ€ä½³ç°‡æ•°","slug":"æ­¥éª¤4-ç¡®å®šæœ€ä½³ç°‡æ•°","link":"#æ­¥éª¤4-ç¡®å®šæœ€ä½³ç°‡æ•°","children":[]},{"level":3,"title":"æ­¥éª¤5ï¼šåº”ç”¨K-Meansèšç±»","slug":"æ­¥éª¤5-åº”ç”¨k-meansèšç±»","link":"#æ­¥éª¤5-åº”ç”¨k-meansèšç±»","children":[]},{"level":3,"title":"æ­¥éª¤6ï¼šåˆ†æå®¢æˆ·ç¾¤ä½“ç‰¹å¾","slug":"æ­¥éª¤6-åˆ†æå®¢æˆ·ç¾¤ä½“ç‰¹å¾","link":"#æ­¥éª¤6-åˆ†æå®¢æˆ·ç¾¤ä½“ç‰¹å¾","children":[]}]},{"level":2,"title":"ç»“æœåˆ†æ","slug":"ç»“æœåˆ†æ","link":"#ç»“æœåˆ†æ","children":[]},{"level":2,"title":"è¿›é˜¶æŒ‘æˆ˜","slug":"è¿›é˜¶æŒ‘æˆ˜","link":"#è¿›é˜¶æŒ‘æˆ˜","children":[]},{"level":2,"title":"å°ç»“ä¸åæ€","slug":"å°ç»“ä¸åæ€","link":"#å°ç»“ä¸åæ€","children":[{"level":3,"title":"æ€è€ƒé—®é¢˜","slug":"æ€è€ƒé—®é¢˜","link":"#æ€è€ƒé—®é¢˜","children":[]}]}],"git":{},"filePathRelative":"projects/clustering/customer-segmentation.md"}');export{i as comp,u as data};
