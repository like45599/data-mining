import{_ as s,e as a,i as p,o as t}from"./app-CPyUwv8V.js";const e={};function o(l,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h1 id="å¼‚å¸¸æ£€æµ‹ä¸é¢„æµ‹" tabindex="-1"><a class="header-anchor" href="#å¼‚å¸¸æ£€æµ‹ä¸é¢„æµ‹"><span>å¼‚å¸¸æ£€æµ‹ä¸é¢„æµ‹</span></a></h1><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿° </div><div class="knowledge-card__content"><ul><li><strong>éš¾åº¦</strong>ï¼šé«˜çº§</li><li><strong>ç±»å‹</strong>ï¼šå›å½’ - é«˜çº§</li><li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šå¼‚å¸¸æ£€æµ‹ã€æ—¶é—´åºåˆ—åˆ†æã€é¢„æµ‹å»ºæ¨¡</li><li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/regression/linear-regression.html">å›å½’åˆ†æ</a></li></ul></div></div><h2 id="é¡¹ç›®èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®èƒŒæ™¯"><span>é¡¹ç›®èƒŒæ™¯</span></a></h2><p>å¼‚å¸¸æ£€æµ‹æ˜¯æ•°æ®æŒ–æ˜ä¸­çš„é‡è¦ä»»åŠ¡ï¼Œç”¨äºè¯†åˆ«æ•°æ®ä¸­çš„å¼‚å¸¸æ¨¡å¼æˆ–ç¦»ç¾¤ç‚¹ã€‚åœ¨è®¸å¤šé¢†åŸŸï¼Œå¦‚ç½‘ç»œå®‰å…¨ã€é‡‘èæ¬ºè¯ˆæ£€æµ‹ã€è®¾å¤‡æ•…éšœé¢„æµ‹ç­‰ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸æƒ…å†µè‡³å…³é‡è¦ã€‚</p><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ç»“åˆå¼‚å¸¸æ£€æµ‹å’Œé¢„æµ‹æŠ€æœ¯ï¼Œæ„å»ºä¸€ä¸ªèƒ½å¤Ÿè¯†åˆ«å¼‚å¸¸å¹¶é¢„æµ‹æœªæ¥è¶‹åŠ¿çš„ç³»ç»Ÿã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¼ æ„Ÿå™¨æ•°æ®ï¼Œæ£€æµ‹è®¾å¤‡çš„å¼‚å¸¸è¿è¡ŒçŠ¶æ€ï¼Œå¹¶é¢„æµ‹å¯èƒ½çš„æ•…éšœã€‚</p><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ </div><div class="knowledge-card__content"><p>é¢„æµ‹æ€§ç»´æŠ¤æŠ€æœ¯å¯ä»¥å¸®åŠ©ä¼ä¸šå‡å°‘è®¡åˆ’å¤–åœæœºæ—¶é—´é«˜è¾¾50%ï¼Œå»¶é•¿è®¾å¤‡å¯¿å‘½20-40%ã€‚æ®éº¦è‚¯é”¡å…¬å¸ä¼°è®¡ï¼ŒåŸºäºç‰©è”ç½‘çš„é¢„æµ‹æ€§ç»´æŠ¤å¯ä»¥ä¸ºå·¥å‚åˆ›é€ æ¯å¹´6300äº¿ç¾å…ƒçš„ä»·å€¼ã€‚</p></div></div><h2 id="æ•°æ®é›†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†ä»‹ç»"><span>æ•°æ®é›†ä»‹ç»</span></a></h2><p>æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæ¨¡æ‹Ÿçš„å·¥ä¸šä¼ æ„Ÿå™¨æ•°æ®é›†ï¼ŒåŒ…å«æŸè®¾å¤‡åœ¨ä¸€å¹´å†…çš„è¿è¡Œæ•°æ®ã€‚æ•°æ®é›†åŒ…å«ä»¥ä¸‹ç‰¹å¾ï¼š</p><ul><li>timestampï¼šæ—¶é—´æˆ³</li><li>sensor1 ~ sensor10ï¼š10ä¸ªä¸åŒä¼ æ„Ÿå™¨çš„è¯»æ•°ï¼ˆå¦‚æ¸©åº¦ã€å‹åŠ›ã€æŒ¯åŠ¨ç­‰ï¼‰</li><li>operational_setting1 ~ operational_setting3ï¼š3ä¸ªæ“ä½œè®¾ç½®å‚æ•°</li><li>environment1 ~ environment2ï¼š2ä¸ªç¯å¢ƒå‚æ•°ï¼ˆå¦‚ç¯å¢ƒæ¸©åº¦ã€æ¹¿åº¦ï¼‰</li><li>failureï¼šæ˜¯å¦å‘ç”Ÿæ•…éšœï¼ˆ0è¡¨ç¤ºæ­£å¸¸ï¼Œ1è¡¨ç¤ºæ•…éšœï¼‰</li></ul><p>æ•°æ®é›†ä¸­åŒ…å«äº†æ­£å¸¸è¿è¡Œæ•°æ®å’Œå°‘é‡æ•…éšœæ•°æ®ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ï¼š</p><ol><li>æ£€æµ‹ä¼ æ„Ÿå™¨æ•°æ®ä¸­çš„å¼‚å¸¸</li><li>é¢„æµ‹å¯èƒ½çš„æ•…éšœå‘ç”Ÿæ—¶é—´</li></ol><h2 id="é¡¹ç›®ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®æ ‡"><span>é¡¹ç›®ç›®æ ‡</span></a></h2><ol><li>æ„å»ºå¼‚å¸¸æ£€æµ‹æ¨¡å‹ï¼Œè¯†åˆ«ä¼ æ„Ÿå™¨æ•°æ®ä¸­çš„å¼‚å¸¸æ¨¡å¼</li><li>åˆ†æå¼‚å¸¸ä¸è®¾å¤‡æ•…éšœçš„å…³ç³»</li><li>æ„å»ºé¢„æµ‹æ¨¡å‹ï¼Œé¢„æµ‹è®¾å¤‡æ•…éšœçš„å¯èƒ½æ€§</li><li>è¯„ä¼°ä¸åŒå¼‚å¸¸æ£€æµ‹å’Œé¢„æµ‹æ–¹æ³•çš„æ€§èƒ½</li><li>æä¾›å¯è§†åŒ–å’Œä¸šåŠ¡å»ºè®®ï¼Œå¸®åŠ©åˆ¶å®šé¢„é˜²æ€§ç»´æŠ¤ç­–ç•¥</li></ol><h2 id="å®æ–½æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®æ–½æ­¥éª¤"><span>å®æ–½æ­¥éª¤</span></a></h2><h3 id="_1-æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#_1-æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–"><span>1. æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–</span></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ•°æ®çš„åŸºæœ¬ç‰¹å¾å’Œåˆ†å¸ƒï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> IsolationForest<span class="token punctuation">,</span> RandomForestClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">,</span> roc_curve<span class="token punctuation">,</span> auc</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">import</span> warnings</span>
<span class="line">warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;sensor_data.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸæ—¶é—´ç±»å‹</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥ç¼ºå¤±å€¼</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•…éšœåˆ†å¸ƒ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ•…éšœç‡: </span><span class="token interpolation"><span class="token punctuation">{</span>df<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">%&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–ä¼ æ„Ÿå™¨æ•°æ®æ—¶é—´åºåˆ—</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># åªå±•ç¤ºå‰4ä¸ªä¼ æ„Ÿå™¨æ•°æ®</span></span>
<span class="line">    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;Sensor </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> Readings&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•…éšœå‰åçš„ä¼ æ„Ÿå™¨æ•°æ®</span></span>
<span class="line">failure_times <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> failure_time <span class="token keyword">in</span> failure_times<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># åªæŸ¥çœ‹å‰ä¸¤æ¬¡æ•…éšœ</span></span>
<span class="line">    <span class="token comment"># è·å–æ•…éšœå‰24å°æ—¶çš„æ•°æ®</span></span>
<span class="line">    start_time <span class="token operator">=</span> failure_time <span class="token operator">-</span> pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>hours<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span></span>
<span class="line">    end_time <span class="token operator">=</span> failure_time <span class="token operator">+</span> pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>hours<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">    failure_window <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> start_time<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> end_time<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># åªå±•ç¤ºå‰4ä¸ªä¼ æ„Ÿå™¨æ•°æ®</span></span>
<span class="line">        plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span></span>
<span class="line">        plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>failure_window<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> failure_window<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        plt<span class="token punctuation">.</span>axvline<span class="token punctuation">(</span>x<span class="token operator">=</span>failure_time<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;--&#39;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Failure&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;Sensor </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> Readings Before and After Failure&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">        plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹ä¼ æ„Ÿå™¨ä¹‹é—´çš„ç›¸å…³æ€§</span></span>
<span class="line">sensor_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df<span class="token punctuation">[</span>sensor_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;coolwarm&#39;</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">&#39;.2f&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Correlation Between Sensors&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-ç‰¹å¾å·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-ç‰¹å¾å·¥ç¨‹"><span>2. ç‰¹å¾å·¥ç¨‹</span></a></h3><p>åˆ›å»ºæœ‰åŠ©äºå¼‚å¸¸æ£€æµ‹å’Œæ•…éšœé¢„æµ‹çš„æ–°ç‰¹å¾ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># åˆ›å»ºæ»šåŠ¨ç»Ÿè®¡ç‰¹å¾</span></span>
<span class="line">window_sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span>  <span class="token comment"># ä¸åŒçš„çª—å£å¤§å°ï¼ˆåˆ†é’Ÿï¼‰</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> sensor <span class="token keyword">in</span> sensor_cols<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> window <span class="token keyword">in</span> window_sizes<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># æ»šåŠ¨å¹³å‡</span></span>
<span class="line">        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>sensor<span class="token punctuation">}</span></span><span class="token string">_mean_</span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">}</span></span><span class="token string">m&#39;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>sensor<span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># æ»šåŠ¨æ ‡å‡†å·®</span></span>
<span class="line">        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>sensor<span class="token punctuation">}</span></span><span class="token string">_std_</span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">}</span></span><span class="token string">m&#39;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>sensor<span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># æ»šåŠ¨æœ€å¤§å€¼ä¸æœ€å°å€¼ä¹‹å·®</span></span>
<span class="line">        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>sensor<span class="token punctuation">}</span></span><span class="token string">_range_</span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">}</span></span><span class="token string">m&#39;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>sensor<span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> df<span class="token punctuation">[</span>sensor<span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºä¼ æ„Ÿå™¨ä¹‹é—´çš„æ¯”ç‡ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;ratio_sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_sensor</span><span class="token interpolation"><span class="token punctuation">{</span>j<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span> <span class="token operator">/</span> df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>j<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ—¶é—´ç‰¹å¾</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>hour</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;day_of_week&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>dayofweek</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;is_weekend&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;day_of_week&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> <span class="token number">5</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ•…éšœå‰å¯¼æ ‡è®°</span></span>
<span class="line"><span class="token comment"># æ ‡è®°æ•…éšœå‰12å°æ—¶çš„æ•°æ®</span></span>
<span class="line">lead_hours <span class="token operator">=</span> <span class="token number">12</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;failure_lead&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> failure_time <span class="token keyword">in</span> failure_times<span class="token punctuation">:</span></span>
<span class="line">    lead_start <span class="token operator">=</span> failure_time <span class="token operator">-</span> pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>hours<span class="token operator">=</span>lead_hours<span class="token punctuation">)</span></span>
<span class="line">    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> lead_start<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> failure_time<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;failure_lead&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç§»é™¤åŒ…å«NaNçš„è¡Œï¼ˆç”±äºåˆ›å»ºæ»šåŠ¨ç‰¹å¾ï¼‰</span></span>
<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ–°ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-å¼‚å¸¸æ£€æµ‹" tabindex="-1"><a class="header-anchor" href="#_3-å¼‚å¸¸æ£€æµ‹"><span>3. å¼‚å¸¸æ£€æµ‹</span></a></h3><p>ä½¿ç”¨éš”ç¦»æ£®æ—ç®—æ³•æ£€æµ‹å¼‚å¸¸ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># é€‰æ‹©ç”¨äºå¼‚å¸¸æ£€æµ‹çš„ç‰¹å¾</span></span>
<span class="line">anomaly_features <span class="token operator">=</span> sensor_cols <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_mean_60m&#39;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_std_60m&#39;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ‡å‡†åŒ–ç‰¹å¾</span></span>
<span class="line">scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">scaled_features <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span>anomaly_features<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨éš”ç¦»æ£®æ—è¿›è¡Œå¼‚å¸¸æ£€æµ‹</span></span>
<span class="line">isolation_forest <span class="token operator">=</span> IsolationForest<span class="token punctuation">(</span>contamination<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> isolation_forest<span class="token punctuation">.</span>fit_predict<span class="token punctuation">(</span>scaled_features<span class="token punctuation">)</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># å°†-1è½¬æ¢ä¸º1ï¼Œè¡¨ç¤ºå¼‚å¸¸</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹å¼‚å¸¸æ£€æµ‹ç»“æœ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ£€æµ‹åˆ°çš„å¼‚å¸¸æ¯”ä¾‹: </span><span class="token interpolation"><span class="token punctuation">{</span>df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">%&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–å¼‚å¸¸ç‚¹</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># åªå±•ç¤ºå‰2ä¸ªä¼ æ„Ÿå™¨æ•°æ®</span></span>
<span class="line">    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;viridis&#39;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;Anomaly&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;Sensor </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> Readings with Anomalies&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†æå¼‚å¸¸ä¸æ•…éšœçš„å…³ç³»</span></span>
<span class="line">anomaly_failure_crosstab <span class="token operator">=</span> pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚å¸¸ä¸æ•…éšœçš„å…³ç³»:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>anomaly_failure_crosstab<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—å¼‚å¸¸æ£€æµ‹çš„æ€§èƒ½æŒ‡æ ‡ï¼ˆä»¥æ•…éšœä¸ºçœŸå®æ ‡ç­¾ï¼‰</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\nå¼‚å¸¸æ£€æµ‹æ€§èƒ½ï¼ˆä»¥æ•…éšœä¸ºçœŸå®æ ‡ç­¾ï¼‰:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-æ•…éšœé¢„æµ‹æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_4-æ•…éšœé¢„æµ‹æ¨¡å‹"><span>4. æ•…éšœé¢„æµ‹æ¨¡å‹</span></a></h3><p>æ„å»ºæ¨¡å‹é¢„æµ‹æœªæ¥å¯èƒ½çš„æ•…éšœï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># é€‰æ‹©ç”¨äºæ•…éšœé¢„æµ‹çš„ç‰¹å¾</span></span>
<span class="line">failure_features <span class="token operator">=</span> sensor_cols <span class="token operator">+</span> \\</span>
<span class="line">                  <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_mean_60m&#39;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> \\</span>
<span class="line">                  <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_std_60m&#39;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> \\</span>
<span class="line">                  <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sensor</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_range_60m&#39;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> \\</span>
<span class="line">                  <span class="token punctuation">[</span><span class="token string">&#39;anomaly&#39;</span><span class="token punctuation">]</span> <span class="token operator">+</span> \\</span>
<span class="line">                  <span class="token punctuation">[</span>col <span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns <span class="token keyword">if</span> <span class="token string">&#39;ratio_sensor&#39;</span> <span class="token keyword">in</span> col<span class="token punctuation">]</span> <span class="token operator">+</span> \\</span>
<span class="line">                  <span class="token punctuation">[</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;day_of_week&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;is_weekend&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡†å¤‡ç‰¹å¾å’Œç›®æ ‡å˜é‡ï¼ˆé¢„æµ‹æ•…éšœå‰å¯¼ï¼‰</span></span>
<span class="line">X <span class="token operator">=</span> df<span class="token punctuation">[</span>failure_features<span class="token punctuation">]</span></span>
<span class="line">y <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;failure_lead&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰</span></span>
<span class="line">train_size <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">)</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒéšæœºæ£®æ—åˆ†ç±»å™¨</span></span>
<span class="line">rf_model <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> max_depth<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> class_weight<span class="token operator">=</span><span class="token string">&#39;balanced&#39;</span><span class="token punctuation">)</span></span>
<span class="line">rf_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹</span></span>
<span class="line">y_train_pred <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span></span>
<span class="line">y_test_pred <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line">y_test_prob <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯„ä¼°æ¨¡å‹</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è®­ç»ƒé›†æ€§èƒ½:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_train_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\næµ‹è¯•é›†æ€§èƒ½:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ··æ·†çŸ©é˜µ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">cm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">&#39;d&#39;</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;Blues&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Confusion Matrix&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;Predicted&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;Actual&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ROCæ›²çº¿</span></span>
<span class="line">fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> _ <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_prob<span class="token punctuation">)</span></span>
<span class="line">roc_auc <span class="token operator">=</span> auc<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;darkorange&#39;</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;ROC curve (area = </span><span class="token interpolation"><span class="token punctuation">{</span>roc_auc<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">)&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;navy&#39;</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;--&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.05</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;False Positive Rate&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;True Positive Rate&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Receiver Operating Characteristic&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">&quot;lower right&quot;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-ç‰¹å¾é‡è¦æ€§åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_5-ç‰¹å¾é‡è¦æ€§åˆ†æ"><span>5. ç‰¹å¾é‡è¦æ€§åˆ†æ</span></a></h3><p>äº†è§£å“ªäº›å› ç´ å¯¹æ•…éšœé¢„æµ‹æœ€é‡è¦ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># åˆ†æç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">feature_importance <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Feature&#39;</span><span class="token punctuation">:</span> X<span class="token punctuation">.</span>columns<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Importance&#39;</span><span class="token punctuation">:</span> rf_model<span class="token punctuation">.</span>feature_importances_</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">feature_importance <span class="token operator">=</span> feature_importance<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">&#39;Importance&#39;</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºå‰20ä¸ªæœ€é‡è¦çš„ç‰¹å¾</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Importance&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;Feature&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>feature_importance<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Feature Importance for Failure Prediction&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-é¢„æµ‹å¯è§†åŒ–ä¸é¢„è­¦ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_6-é¢„æµ‹å¯è§†åŒ–ä¸é¢„è­¦ç³»ç»Ÿ"><span>6. é¢„æµ‹å¯è§†åŒ–ä¸é¢„è­¦ç³»ç»Ÿ</span></a></h3><p>å¯è§†åŒ–é¢„æµ‹ç»“æœï¼Œå¹¶è®¾è®¡é¢„è­¦ç³»ç»Ÿï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># å°†é¢„æµ‹æ¦‚ç‡æ·»åŠ åˆ°æµ‹è¯•æ•°æ®ä¸­</span></span>
<span class="line">test_data <span class="token operator">=</span> df<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">test_data<span class="token punctuation">[</span><span class="token string">&#39;failure_prob&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> y_test_prob</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–é¢„æµ‹æ¦‚ç‡ä¸å®é™…æ•…éšœ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> test_data<span class="token punctuation">[</span><span class="token string">&#39;failure_prob&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Failure Probability&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> </span>
<span class="line">            test_data<span class="token punctuation">[</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;failure_prob&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">            color<span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">&#39;x&#39;</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Actual Failure&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;--&#39;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Threshold (0.5)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Failure Probability Prediction&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;Time&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;Probability&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¾è®¡é¢„è­¦ç³»ç»Ÿ</span></span>
<span class="line">warning_levels <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token string">&#39;High Risk - Immediate Maintenance Required&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">&#39;Medium Risk - Schedule Maintenance Soon&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">&#39;Low Risk - Monitor Closely&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¸ºæµ‹è¯•æ•°æ®æ·»åŠ é¢„è­¦çº§åˆ«</span></span>
<span class="line">test_data<span class="token punctuation">[</span><span class="token string">&#39;warning_level&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Normal&#39;</span></span>
<span class="line"><span class="token keyword">for</span> threshold<span class="token punctuation">,</span> message <span class="token keyword">in</span> warning_levels<span class="token punctuation">:</span></span>
<span class="line">    test_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;failure_prob&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> threshold<span class="token punctuation">,</span> <span class="token string">&#39;warning_level&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> message</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºé¢„è­¦åˆ†å¸ƒ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;warning_level&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—é¢„è­¦æå‰æ—¶é—´</span></span>
<span class="line">warnings <span class="token operator">=</span> test_data<span class="token punctuation">[</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;warning_level&#39;</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&#39;Normal&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">failures <span class="token operator">=</span> test_data<span class="token punctuation">[</span>test_data<span class="token punctuation">[</span><span class="token string">&#39;failure&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token keyword">not</span> failures<span class="token punctuation">.</span>empty <span class="token keyword">and</span> <span class="token keyword">not</span> warnings<span class="token punctuation">.</span>empty<span class="token punctuation">:</span></span>
<span class="line">    warning_times <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">for</span> failure_time <span class="token keyword">in</span> failures<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># æ‰¾åˆ°æ•…éšœå‰çš„æœ€æ—©é¢„è­¦</span></span>
<span class="line">        prior_warnings <span class="token operator">=</span> warnings<span class="token punctuation">[</span>warnings<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> failure_time<span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> prior_warnings<span class="token punctuation">.</span>empty<span class="token punctuation">:</span></span>
<span class="line">            earliest_warning <span class="token operator">=</span> prior_warnings<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            warning_lead_time <span class="token operator">=</span> <span class="token punctuation">(</span>failure_time <span class="token operator">-</span> earliest_warning<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3600</span>  <span class="token comment"># å°æ—¶</span></span>
<span class="line">            warning_times<span class="token punctuation">.</span>append<span class="token punctuation">(</span>warning_lead_time<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> warning_times<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å¹³å‡é¢„è­¦æå‰æ—¶é—´: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>warning_times<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> å°æ—¶&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æœ€çŸ­é¢„è­¦æå‰æ—¶é—´: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>warning_times<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> å°æ—¶&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æœ€é•¿é¢„è­¦æå‰æ—¶é—´: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>warning_times<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> å°æ—¶&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è¿›é˜¶æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶æŒ‘æˆ˜"><span>è¿›é˜¶æŒ‘æˆ˜</span></a></h2><p>å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š</p><ol><li><strong>æ·±åº¦å­¦ä¹ æ–¹æ³•</strong>ï¼šå°è¯•ä½¿ç”¨LSTMæˆ–è‡ªç¼–ç å™¨è¿›è¡Œå¼‚å¸¸æ£€æµ‹å’Œæ•…éšœé¢„æµ‹</li><li><strong>å¤šæ­¥é¢„æµ‹</strong>ï¼šæ„å»ºèƒ½å¤Ÿé¢„æµ‹æœªæ¥å¤šä¸ªæ—¶é—´ç‚¹æ•…éšœæ¦‚ç‡çš„æ¨¡å‹</li><li><strong>é›†æˆå¼‚å¸¸æ£€æµ‹</strong>ï¼šç»“åˆå¤šç§å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œæé«˜æ£€æµ‹å‡†ç¡®æ€§</li><li><strong>åœ¨çº¿å­¦ä¹ </strong>ï¼šå®ç°èƒ½å¤Ÿä»æ–°æ•°æ®ä¸­æŒç»­å­¦ä¹ çš„æ¨¡å‹</li><li><strong>ç»´æŠ¤æˆæœ¬ä¼˜åŒ–</strong>ï¼šè€ƒè™‘ç»´æŠ¤æˆæœ¬å’ŒåœæœºæŸå¤±ï¼Œä¼˜åŒ–ç»´æŠ¤å†³ç­–</li></ol><h2 id="å°ç»“ä¸åæ€" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸åæ€"><span>å°ç»“ä¸åæ€</span></a></h2><p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ç»“åˆå¼‚å¸¸æ£€æµ‹å’Œé¢„æµ‹æŠ€æœ¯ï¼Œæ„å»ºä¸€ä¸ªé¢„æµ‹æ€§ç»´æŠ¤ç³»ç»Ÿã€‚æˆ‘ä»¬å‘ç°æŸäº›ä¼ æ„Ÿå™¨æ•°æ®çš„å¼‚å¸¸æ¨¡å¼å¯ä»¥ä½œä¸ºè®¾å¤‡æ•…éšœçš„æ—©æœŸé¢„è­¦ä¿¡å·ï¼Œé€šè¿‡åŠæ—¶å¹²é¢„å¯ä»¥é¿å…ä¸¥é‡æ•…éšœçš„å‘ç”Ÿã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé¢„æµ‹æ€§ç»´æŠ¤ç³»ç»Ÿå¯ä»¥å¸®åŠ©ä¼ä¸šå‡å°‘è®¡åˆ’å¤–åœæœºæ—¶é—´ï¼Œå»¶é•¿è®¾å¤‡å¯¿å‘½ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ã€‚æ­¤å¤–ï¼Œé€šè¿‡æŒç»­ç›‘æ§å’Œåˆ†æè®¾å¤‡è¿è¡Œæ•°æ®ï¼Œä¼ä¸šå¯ä»¥ä¸æ–­ä¼˜åŒ–è®¾å¤‡æ€§èƒ½å’Œç»´æŠ¤ç­–ç•¥ã€‚</p><h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3><ol><li>åœ¨å®é™…å·¥ä¸šç¯å¢ƒä¸­ï¼Œå¦‚ä½•å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®çš„å™ªå£°å’Œç¼ºå¤±å€¼é—®é¢˜ï¼Ÿ</li><li>å¦‚ä½•å¹³è¡¡é¢„è­¦ç³»ç»Ÿçš„æ•æ„Ÿæ€§å’Œå‡†ç¡®æ€§ï¼Ÿè¿‡å¤šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li><li>å¦‚ä½•å°†é¢„æµ‹æ€§ç»´æŠ¤ç³»ç»Ÿä¸ä¼ä¸šçš„ç»´æŠ¤ç®¡ç†æµç¨‹é›†æˆï¼Œå®ç°æœ€å¤§ä»·å€¼ï¼Ÿ</li></ol><div class="practice-link"><a href="/projects/" class="button">è¿”å›é¡¹ç›®åˆ—è¡¨</a></div>`,41)]))}const i=s(e,[["render",o],["__file","anomaly-detection.html.vue"]]),u=JSON.parse('{"path":"/projects/regression/anomaly-detection.html","title":"å¼‚å¸¸æ£€æµ‹ä¸é¢„æµ‹","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"é¡¹ç›®èƒŒæ™¯","slug":"é¡¹ç›®èƒŒæ™¯","link":"#é¡¹ç›®èƒŒæ™¯","children":[]},{"level":2,"title":"æ•°æ®é›†ä»‹ç»","slug":"æ•°æ®é›†ä»‹ç»","link":"#æ•°æ®é›†ä»‹ç»","children":[]},{"level":2,"title":"é¡¹ç›®ç›®æ ‡","slug":"é¡¹ç›®ç›®æ ‡","link":"#é¡¹ç›®ç›®æ ‡","children":[]},{"level":2,"title":"å®æ–½æ­¥éª¤","slug":"å®æ–½æ­¥éª¤","link":"#å®æ–½æ­¥éª¤","children":[{"level":3,"title":"1. æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–","slug":"_1-æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–","link":"#_1-æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–","children":[]},{"level":3,"title":"2. ç‰¹å¾å·¥ç¨‹","slug":"_2-ç‰¹å¾å·¥ç¨‹","link":"#_2-ç‰¹å¾å·¥ç¨‹","children":[]},{"level":3,"title":"3. å¼‚å¸¸æ£€æµ‹","slug":"_3-å¼‚å¸¸æ£€æµ‹","link":"#_3-å¼‚å¸¸æ£€æµ‹","children":[]},{"level":3,"title":"4. æ•…éšœé¢„æµ‹æ¨¡å‹","slug":"_4-æ•…éšœé¢„æµ‹æ¨¡å‹","link":"#_4-æ•…éšœé¢„æµ‹æ¨¡å‹","children":[]},{"level":3,"title":"5. ç‰¹å¾é‡è¦æ€§åˆ†æ","slug":"_5-ç‰¹å¾é‡è¦æ€§åˆ†æ","link":"#_5-ç‰¹å¾é‡è¦æ€§åˆ†æ","children":[]},{"level":3,"title":"6. é¢„æµ‹å¯è§†åŒ–ä¸é¢„è­¦ç³»ç»Ÿ","slug":"_6-é¢„æµ‹å¯è§†åŒ–ä¸é¢„è­¦ç³»ç»Ÿ","link":"#_6-é¢„æµ‹å¯è§†åŒ–ä¸é¢„è­¦ç³»ç»Ÿ","children":[]}]},{"level":2,"title":"è¿›é˜¶æŒ‘æˆ˜","slug":"è¿›é˜¶æŒ‘æˆ˜","link":"#è¿›é˜¶æŒ‘æˆ˜","children":[]},{"level":2,"title":"å°ç»“ä¸åæ€","slug":"å°ç»“ä¸åæ€","link":"#å°ç»“ä¸åæ€","children":[{"level":3,"title":"æ€è€ƒé—®é¢˜","slug":"æ€è€ƒé—®é¢˜","link":"#æ€è€ƒé—®é¢˜","children":[]}]}],"git":{},"filePathRelative":"projects/regression/anomaly-detection.md"}');export{i as comp,u as data};
