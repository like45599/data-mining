import{_ as s,e as a,i as p,o as t}from"./app-CztZx2qC.js";const e={};function c(o,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h1 id="ä¿¡ç”¨é£é™©è¯„ä¼°" tabindex="-1"><a class="header-anchor" href="#ä¿¡ç”¨é£é™©è¯„ä¼°"><span>ä¿¡ç”¨é£é™©è¯„ä¼°</span></a></h1><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿° </div><div class="knowledge-card__content"><ul><li><strong>éš¾åº¦</strong>ï¼šé«˜çº§</li><li><strong>ç±»å‹</strong>ï¼šåˆ†ç±»</li><li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šä¸å¹³è¡¡æ•°æ®å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹è§£é‡Šã€è¯„ä¼°æŒ‡æ ‡é€‰æ‹©</li><li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/classification/svm.html">åˆ†ç±»ç®—æ³•</a></li></ul></div></div><h2 id="é¡¹ç›®èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®èƒŒæ™¯"><span>é¡¹ç›®èƒŒæ™¯</span></a></h2><p>ä¿¡ç”¨é£é™©è¯„ä¼°æ˜¯é‡‘èæœºæ„çš„æ ¸å¿ƒä¸šåŠ¡ä¹‹ä¸€ï¼Œç”¨äºåˆ¤æ–­å€Ÿæ¬¾äººæ˜¯å¦æœ‰èƒ½åŠ›æŒ‰æ—¶å¿è¿˜è´·æ¬¾ã€‚å‡†ç¡®çš„ä¿¡ç”¨é£é™©è¯„ä¼°å¯ä»¥å¸®åŠ©é‡‘èæœºæ„é™ä½åè´¦ç‡ï¼ŒåŒæ—¶ä¸ºæ›´å¤šåˆæ ¼çš„å€Ÿæ¬¾äººæä¾›é‡‘èæœåŠ¡ã€‚</p><p>ä¼ ç»Ÿçš„ä¿¡ç”¨è¯„åˆ†æ¨¡å‹ä¸»è¦ä¾èµ–äºå€Ÿæ¬¾äººçš„ä¿¡ç”¨å†å²ã€æ”¶å…¥æ°´å¹³å’Œå€ºåŠ¡æ¯”ç‡ç­‰å› ç´ ã€‚éšç€å¤§æ•°æ®å’Œæœºå™¨å­¦ä¹ æŠ€æœ¯çš„å‘å±•ï¼Œç°ä»£ä¿¡ç”¨é£é™©è¯„ä¼°å¯ä»¥æ•´åˆæ›´å¤šç»´åº¦çš„æ•°æ®ï¼ŒåŒ…æ‹¬äº¤æ˜“è¡Œä¸ºã€ç¤¾äº¤ç½‘ç»œå’Œå¿ƒç†ç‰¹å¾ç­‰ï¼Œæ„å»ºæ›´å…¨é¢å’Œå‡†ç¡®çš„é£é™©é¢„æµ‹æ¨¡å‹ã€‚</p><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¾·å›½ä¿¡ç”¨æ•°æ®é›†ï¼Œæ„å»ºä¸€ä¸ªä¿¡ç”¨é£é™©è¯„ä¼°æ¨¡å‹ï¼Œé¢„æµ‹å€Ÿæ¬¾äººæ˜¯å¦ä¼šè¿çº¦ã€‚</p><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ </div><div class="knowledge-card__content"><p>ä¿¡ç”¨è¯„åˆ†çš„æ¦‚å¿µæœ€æ—©ç”±ç¾å›½å…¬å¹³è‰¾è¨å…‹å…¬å¸(Fair Isaac Corporation)åœ¨1950å¹´ä»£æå‡ºï¼Œå‘å±•æˆä¸ºä»Šå¤©å¹¿æ³›ä½¿ç”¨çš„FICOè¯„åˆ†ç³»ç»Ÿã€‚ç°ä»£ä¿¡ç”¨è¯„åˆ†ç³»ç»Ÿé€šå¸¸å°†å€Ÿæ¬¾äººçš„ä¿¡ç”¨çŠ¶å†µé‡åŒ–ä¸º300-850ä¹‹é—´çš„åˆ†æ•°ï¼Œåˆ†æ•°è¶Šé«˜è¡¨ç¤ºä¿¡ç”¨é£é™©è¶Šä½ã€‚</p></div></div><h2 id="æ•°æ®é›†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†ä»‹ç»"><span>æ•°æ®é›†ä»‹ç»</span></a></h2><p>å¾·å›½ä¿¡ç”¨æ•°æ®é›†åŒ…å«1000åå€Ÿæ¬¾äººçš„ä¿¡æ¯ï¼Œæ¯ä¸ªå€Ÿæ¬¾äººæœ‰20ä¸ªç‰¹å¾ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>ä¸ªäººä¿¡æ¯ï¼šå¹´é¾„ã€æ€§åˆ«ã€å©šå§»çŠ¶å†µç­‰</li><li>è´¢åŠ¡çŠ¶å†µï¼šæ”¶å…¥ã€å‚¨è“„ã€ç°æœ‰ä¿¡è´·æ•°é‡ç­‰</li><li>å°±ä¸šä¿¡æ¯ï¼šå°±ä¸šç±»å‹ã€å°±ä¸šå¹´é™ç­‰</li><li>ä½æˆ¿ä¿¡æ¯ï¼šä½æˆ¿ç±»å‹ã€å±…ä½æ—¶é—´ç­‰</li><li>ä¿¡ç”¨å†å²ï¼šè¿‡å¾€ä¿¡ç”¨è®°å½•ã€è´·æ¬¾ç›®çš„ç­‰</li></ul><p>ç›®æ ‡å˜é‡æ˜¯äºŒå…ƒåˆ†ç±»ï¼šå¥½å®¢æˆ·(0)æˆ–åå®¢æˆ·(1)ï¼Œå…¶ä¸­åå®¢æˆ·è¡¨ç¤ºå­˜åœ¨è¿çº¦é£é™©ã€‚</p><p>æ•°æ®é›†çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯ç±»åˆ«ä¸å¹³è¡¡ï¼Œå¥½å®¢æˆ·å 70%ï¼Œåå®¢æˆ·å 30%ã€‚è¿™ç§ä¸å¹³è¡¡åæ˜ äº†ç°å®ä¸–ç•Œä¸­çš„ä¿¡ç”¨é£é™©åˆ†å¸ƒï¼Œä½†ä¹Ÿç»™æ¨¡å‹è®­ç»ƒå¸¦æ¥äº†æŒ‘æˆ˜ã€‚</p><h2 id="é¡¹ç›®ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®æ ‡"><span>é¡¹ç›®ç›®æ ‡</span></a></h2><ol><li>æ„å»ºä¸€ä¸ªèƒ½å¤Ÿå‡†ç¡®é¢„æµ‹å€Ÿæ¬¾äººä¿¡ç”¨é£é™©çš„åˆ†ç±»æ¨¡å‹</li><li>å¤„ç†æ•°æ®é›†ä¸­çš„ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜</li><li>è¯†åˆ«å½±å“ä¿¡ç”¨é£é™©çš„å…³é”®å› ç´ </li><li>è¯„ä¼°æ¨¡å‹åœ¨ä¸åŒè¯„ä¼°æŒ‡æ ‡ä¸‹çš„è¡¨ç°</li><li>æä¾›æ¨¡å‹è§£é‡Šå’Œä¸šåŠ¡å»ºè®®</li></ol><h2 id="å®æ–½æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®æ–½æ­¥éª¤"><span>å®æ–½æ­¥éª¤</span></a></h2><h3 id="_1-æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_1-æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†"><span>1. æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†</span></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ•°æ®çš„åŸºæœ¬ç‰¹å¾å’Œè´¨é‡ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler<span class="token punctuation">,</span> OneHotEncoder</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>compose <span class="token keyword">import</span> ColumnTransformer</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">url <span class="token operator">=</span> <span class="token string">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/german.data&quot;</span></span>
<span class="line">column_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;status&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;duration&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;credit_history&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;purpose&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;amount&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                <span class="token string">&#39;savings&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;employment_duration&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;installment_rate&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;personal_status_sex&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                <span class="token string">&#39;other_debtors&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;present_residence&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;property&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;other_installment_plans&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                <span class="token string">&#39;housing&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;existing_credits&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;job&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;num_dependents&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;telephone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;foreign_worker&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;target&#39;</span><span class="token punctuation">]</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>url<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span>column_names<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†ç›®æ ‡å˜é‡è½¬æ¢ä¸º0å’Œ1ï¼ˆåŸå§‹æ•°æ®ä¸­æ˜¯1å’Œ2ï¼‰</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥ç±»åˆ«åˆ†å¸ƒ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–ç±»åˆ«åˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>df<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ä¿¡ç”¨é£é™©åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;é£é™©ç±»åˆ« (0=å¥½å®¢æˆ·, 1=åå®¢æˆ·)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;æ•°é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¢ç´¢æ•°å€¼ç‰¹å¾ä¸ç›®æ ‡å˜é‡çš„å…³ç³»</span></span>
<span class="line">numerical_features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;duration&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;amount&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;existing_credits&#39;</span><span class="token punctuation">]</span></span>
<span class="line">fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">axes <span class="token operator">=</span> axes<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> i<span class="token punctuation">,</span> feature <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>numerical_features<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span>feature<span class="token punctuation">,</span> data<span class="token operator">=</span>df<span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>feature<span class="token punctuation">}</span></span><span class="token string"> vs ä¿¡ç”¨é£é™©&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">&#39;é£é™©ç±»åˆ« (0=å¥½å®¢æˆ·, 1=åå®¢æˆ·)&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¢ç´¢ç±»åˆ«ç‰¹å¾ä¸ç›®æ ‡å˜é‡çš„å…³ç³»</span></span>
<span class="line">categorical_features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;credit_history&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;purpose&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;personal_status_sex&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;savings&#39;</span><span class="token punctuation">]</span></span>
<span class="line">fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">axes <span class="token operator">=</span> axes<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> i<span class="token punctuation">,</span> feature <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>categorical_features<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    cross_tab <span class="token operator">=</span> pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>df<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token string">&#39;index&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    cross_tab<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">,</span> stacked<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>feature<span class="token punctuation">}</span></span><span class="token string"> vs ä¿¡ç”¨é£é™©&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>feature<span class="token punctuation">)</span></span>
<span class="line">    axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">&#39;æ¯”ä¾‹&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    axes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;å¥½å®¢æˆ·&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;åå®¢æˆ·&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†æ•°æ®ä¸­çš„ç±»åˆ«ç‰¹å¾å’Œæ•°å€¼ç‰¹å¾ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è¯†åˆ«æ•°å€¼ç‰¹å¾å’Œç±»åˆ«ç‰¹å¾</span></span>
<span class="line">numerical_features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;duration&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;amount&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;installment_rate&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;present_residence&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                      <span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;existing_credits&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;num_dependents&#39;</span><span class="token punctuation">]</span></span>
<span class="line">categorical_features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;status&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;credit_history&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;purpose&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;savings&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                        <span class="token string">&#39;employment_duration&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;personal_status_sex&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;other_debtors&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                        <span class="token string">&#39;property&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;other_installment_plans&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;housing&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;job&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">                        <span class="token string">&#39;telephone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;foreign_worker&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†å‰²æ•°æ®</span></span>
<span class="line">X <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">y <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;target&#39;</span><span class="token punctuation">]</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> stratify<span class="token operator">=</span>y<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºé¢„å¤„ç†ç®¡é“</span></span>
<span class="line">preprocessor <span class="token operator">=</span> ColumnTransformer<span class="token punctuation">(</span></span>
<span class="line">    transformers<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="line">        <span class="token punctuation">(</span><span class="token string">&#39;num&#39;</span><span class="token punctuation">,</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> numerical_features<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">(</span><span class="token string">&#39;cat&#39;</span><span class="token punctuation">,</span> OneHotEncoder<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token string">&#39;first&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> categorical_features<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨é¢„å¤„ç†</span></span>
<span class="line">X_train_processed <span class="token operator">=</span> preprocessor<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span></span>
<span class="line">X_test_processed <span class="token operator">=</span> preprocessor<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥å¤„ç†åçš„ç‰¹å¾ç»´åº¦</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å¤„ç†åçš„è®­ç»ƒé›†å½¢çŠ¶: </span><span class="token interpolation"><span class="token punctuation">{</span>X_train_processed<span class="token punctuation">.</span>shape<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-å¤„ç†ç±»åˆ«ä¸å¹³è¡¡" tabindex="-1"><a class="header-anchor" href="#_2-å¤„ç†ç±»åˆ«ä¸å¹³è¡¡"><span>2. å¤„ç†ç±»åˆ«ä¸å¹³è¡¡</span></a></h3><p>ä¿¡ç”¨é£é™©æ•°æ®é€šå¸¸å­˜åœ¨ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šç§æ–¹æ³•å¤„ç†ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> imblearn<span class="token punctuation">.</span>over_sampling <span class="token keyword">import</span> SMOTE</span>
<span class="line"><span class="token keyword">from</span> imblearn<span class="token punctuation">.</span>under_sampling <span class="token keyword">import</span> RandomUnderSampler</span>
<span class="line"><span class="token keyword">from</span> imblearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline <span class="token keyword">as</span> ImbPipeline</span>
<span class="line"><span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹åŸå§‹ç±»åˆ«åˆ†å¸ƒ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;åŸå§‹è®­ç»ƒé›†ç±»åˆ«åˆ†å¸ƒ: </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">(</span>y_train<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨SMOTEè¿‡é‡‡æ ·</span></span>
<span class="line">smote <span class="token operator">=</span> SMOTE<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">X_train_smote<span class="token punctuation">,</span> y_train_smote <span class="token operator">=</span> smote<span class="token punctuation">.</span>fit_resample<span class="token punctuation">(</span>X_train_processed<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;SMOTEåè®­ç»ƒé›†ç±»åˆ«åˆ†å¸ƒ: </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">(</span>y_train_smote<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨éšæœºæ¬ é‡‡æ ·</span></span>
<span class="line">rus <span class="token operator">=</span> RandomUnderSampler<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">X_train_rus<span class="token punctuation">,</span> y_train_rus <span class="token operator">=</span> rus<span class="token punctuation">.</span>fit_resample<span class="token punctuation">(</span>X_train_processed<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ¬ é‡‡æ ·åè®­ç»ƒé›†ç±»åˆ«åˆ†å¸ƒ: </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">(</span>y_train_rus<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨ç»„åˆé‡‡æ ·ï¼ˆSMOTE + æ¬ é‡‡æ ·ï¼‰</span></span>
<span class="line">over <span class="token operator">=</span> SMOTE<span class="token punctuation">(</span>sampling_strategy<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># å°†å°‘æ•°ç±»è¿‡é‡‡æ ·åˆ°å¤šæ•°ç±»çš„50%</span></span>
<span class="line">under <span class="token operator">=</span> RandomUnderSampler<span class="token punctuation">(</span>sampling_strategy<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># å°†å¤šæ•°ç±»æ¬ é‡‡æ ·åˆ°å°‘æ•°ç±»çš„80%</span></span>
<span class="line">combined_sampling <span class="token operator">=</span> ImbPipeline<span class="token punctuation">(</span>steps<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;over&#39;</span><span class="token punctuation">,</span> over<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;under&#39;</span><span class="token punctuation">,</span> under<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">X_train_combined<span class="token punctuation">,</span> y_train_combined <span class="token operator">=</span> combined_sampling<span class="token punctuation">.</span>fit_resample<span class="token punctuation">(</span>X_train_processed<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ç»„åˆé‡‡æ ·åè®­ç»ƒé›†ç±»åˆ«åˆ†å¸ƒ: </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">(</span>y_train_combined<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°" tabindex="-1"><a class="header-anchor" href="#_3-æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°"><span>3. æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°</span></a></h3><p>æˆ‘ä»¬å°†å°è¯•å¤šç§åˆ†ç±»ç®—æ³•ï¼Œå¹¶ä½¿ç”¨é€‚åˆä¸å¹³è¡¡æ•°æ®çš„è¯„ä¼°æŒ‡æ ‡ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier<span class="token punctuation">,</span> GradientBoostingClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token punctuation">,</span> precision_score<span class="token punctuation">,</span> recall_score<span class="token punctuation">,</span> f1_score<span class="token punctuation">,</span> roc_auc_score</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix<span class="token punctuation">,</span> classification_report<span class="token punctuation">,</span> roc_curve<span class="token punctuation">,</span> precision_recall_curve</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> cross_val_score</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰è¯„ä¼°å‡½æ•°</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">evaluate_model</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> model_name<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># é¢„æµ‹</span></span>
<span class="line">    y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line">    y_prob <span class="token operator">=</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è®¡ç®—è¯„ä¼°æŒ‡æ ‡</span></span>
<span class="line">    accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    precision <span class="token operator">=</span> precision_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    recall <span class="token operator">=</span> recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    auc <span class="token operator">=</span> roc_auc_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_prob<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ‰“å°è¯„ä¼°ç»“æœ</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\\n</span><span class="token interpolation"><span class="token punctuation">{</span>model_name<span class="token punctuation">}</span></span><span class="token string"> è¯„ä¼°ç»“æœ:&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å‡†ç¡®ç‡: </span><span class="token interpolation"><span class="token punctuation">{</span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ç²¾ç¡®ç‡: </span><span class="token interpolation"><span class="token punctuation">{</span>precision<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å¬å›ç‡: </span><span class="token interpolation"><span class="token punctuation">{</span>recall<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;F1åˆ†æ•°: </span><span class="token interpolation"><span class="token punctuation">{</span>f1<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;AUC: </span><span class="token interpolation"><span class="token punctuation">{</span>auc<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ··æ·†çŸ©é˜µ</span></span>
<span class="line">    cm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">&#39;d&#39;</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;Blues&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>model_name<span class="token punctuation">}</span></span><span class="token string"> æ··æ·†çŸ©é˜µ&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;é¢„æµ‹ç±»åˆ«&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;çœŸå®ç±»åˆ«&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># ROCæ›²çº¿</span></span>
<span class="line">    fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> _ <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_prob<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;AUC = </span><span class="token interpolation"><span class="token punctuation">{</span>auc<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;k--&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;å‡æ­£ä¾‹ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;çœŸæ­£ä¾‹ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>model_name<span class="token punctuation">}</span></span><span class="token string"> ROCæ›²çº¿&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># ç²¾ç¡®ç‡-å¬å›ç‡æ›²çº¿</span></span>
<span class="line">    precision_curve<span class="token punctuation">,</span> recall_curve<span class="token punctuation">,</span> _ <span class="token operator">=</span> precision_recall_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_prob<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>recall_curve<span class="token punctuation">,</span> precision_curve<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;å¬å›ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;ç²¾ç¡®ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>model_name<span class="token punctuation">}</span></span><span class="token string"> ç²¾ç¡®ç‡-å¬å›ç‡æ›²çº¿&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> model<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> precision<span class="token punctuation">,</span> recall<span class="token punctuation">,</span> f1<span class="token punctuation">,</span> auc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒå’Œè¯„ä¼°å¤šä¸ªæ¨¡å‹</span></span>
<span class="line">models <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Logistic Regression&#39;</span><span class="token punctuation">:</span> LogisticRegression<span class="token punctuation">(</span>class_weight<span class="token operator">=</span><span class="token string">&#39;balanced&#39;</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Random Forest&#39;</span><span class="token punctuation">:</span> RandomForestClassifier<span class="token punctuation">(</span>class_weight<span class="token operator">=</span><span class="token string">&#39;balanced&#39;</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Gradient Boosting&#39;</span><span class="token punctuation">:</span> GradientBoostingClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;SVM&#39;</span><span class="token punctuation">:</span> SVC<span class="token punctuation">(</span>class_weight<span class="token operator">=</span><span class="token string">&#39;balanced&#39;</span><span class="token punctuation">,</span> probability<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    model_result <span class="token operator">=</span> evaluate_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> X_train_smote<span class="token punctuation">,</span> y_train_smote<span class="token punctuation">,</span> X_test_processed<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> name<span class="token punctuation">)</span></span>
<span class="line">    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">+</span> model_result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½</span></span>
<span class="line">results_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>results<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Model&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Accuracy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Precision&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Recall&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;F1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;AUC&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results_df<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–æ¯”è¾ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">metrics <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;Accuracy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Precision&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Recall&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;F1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;AUC&#39;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">for</span> i<span class="token punctuation">,</span> metric <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>metrics<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;Model&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span>metric<span class="token punctuation">,</span> data<span class="token operator">=</span>results_df<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>metric<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-ç‰¹å¾é‡è¦æ€§åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_4-ç‰¹å¾é‡è¦æ€§åˆ†æ"><span>4. ç‰¹å¾é‡è¦æ€§åˆ†æ</span></a></h3><p>äº†è§£å“ªäº›ç‰¹å¾å¯¹ä¿¡ç”¨é£é™©é¢„æµ‹æœ€é‡è¦ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># ä½¿ç”¨éšæœºæ£®æ—çš„ç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">rf_model <span class="token operator">=</span> models<span class="token punctuation">[</span><span class="token string">&#39;Random Forest&#39;</span><span class="token punctuation">]</span></span>
<span class="line">feature_names <span class="token operator">=</span> numerical_features <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>preprocessor<span class="token punctuation">.</span>named_transformers_<span class="token punctuation">[</span><span class="token string">&#39;cat&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get_feature_names_out<span class="token punctuation">(</span>categorical_features<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·å–ç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">importances <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>feature_importances_</span>
<span class="line">indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>importances<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–å‰15ä¸ªé‡è¦ç‰¹å¾</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ç‰¹å¾é‡è¦æ€§&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importances<span class="token punctuation">[</span>indices<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>feature_names<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨SHAPå€¼è¿›è¡Œæ›´è¯¦ç»†çš„è§£é‡Š</span></span>
<span class="line"><span class="token keyword">import</span> shap</span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©ä¸€ä¸ªæ¨¡å‹è¿›è¡Œè§£é‡Šï¼ˆä¾‹å¦‚ï¼Œéšæœºæ£®æ—ï¼‰</span></span>
<span class="line">explainer <span class="token operator">=</span> shap<span class="token punctuation">.</span>TreeExplainer<span class="token punctuation">(</span>rf_model<span class="token punctuation">)</span></span>
<span class="line">shap_values <span class="token operator">=</span> explainer<span class="token punctuation">.</span>shap_values<span class="token punctuation">(</span>X_test_processed<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–SHAPå€¼</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">shap<span class="token punctuation">.</span>summary_plot<span class="token punctuation">(</span>shap_values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_test_processed<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>feature_names<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-æ¨¡å‹ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_5-æ¨¡å‹ä¼˜åŒ–"><span>5. æ¨¡å‹ä¼˜åŒ–</span></a></h3><p>ä½¿ç”¨äº¤å‰éªŒè¯å’Œç½‘æ ¼æœç´¢ä¼˜åŒ–æœ€ä½³æ¨¡å‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡è®¾éšæœºæ£®æ—æ˜¯æœ€ä½³æ¨¡å‹</span></span>
<span class="line">best_model <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>class_weight<span class="token operator">=</span><span class="token string">&#39;balanced&#39;</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰å‚æ•°ç½‘æ ¼</span></span>
<span class="line">param_grid <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;n_estimators&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;max_depth&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;min_samples_split&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;min_samples_leaf&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨ç½‘æ ¼æœç´¢æ‰¾åˆ°æœ€ä½³å‚æ•°</span></span>
<span class="line">grid_search <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span></span>
<span class="line">    estimator<span class="token operator">=</span>best_model<span class="token punctuation">,</span></span>
<span class="line">    param_grid<span class="token operator">=</span>param_grid<span class="token punctuation">,</span></span>
<span class="line">    cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">    scoring<span class="token operator">=</span><span class="token string">&#39;f1&#39;</span><span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨F1åˆ†æ•°ä½œä¸ºä¼˜åŒ–ç›®æ ‡</span></span>
<span class="line">    n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">grid_search<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_smote<span class="token punctuation">,</span> y_train_smote<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰“å°æœ€ä½³å‚æ•°</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ä½³å‚æ•°:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>grid_search<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨æœ€ä½³å‚æ•°çš„æ¨¡å‹è¿›è¡Œè¯„ä¼°</span></span>
<span class="line">best_rf <span class="token operator">=</span> grid_search<span class="token punctuation">.</span>best_estimator_</span>
<span class="line">evaluate_model<span class="token punctuation">(</span>best_rf<span class="token punctuation">,</span> X_train_smote<span class="token punctuation">,</span> y_train_smote<span class="token punctuation">,</span> X_test_processed<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> <span class="token string">&quot;ä¼˜åŒ–åçš„éšæœºæ£®æ—&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-é˜ˆå€¼ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_6-é˜ˆå€¼ä¼˜åŒ–"><span>6. é˜ˆå€¼ä¼˜åŒ–</span></a></h3><p>åœ¨ä¿¡ç”¨é£é™©è¯„ä¼°ä¸­ï¼Œé”™è¯¯åˆ†ç±»çš„æˆæœ¬æ˜¯ä¸å¯¹ç§°çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´åˆ†ç±»é˜ˆå€¼æ¥å¹³è¡¡ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è·å–é¢„æµ‹æ¦‚ç‡</span></span>
<span class="line">y_prob <span class="token operator">=</span> best_rf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test_processed<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—ä¸åŒé˜ˆå€¼ä¸‹çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡</span></span>
<span class="line">thresholds <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span></span>
<span class="line">precision_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">recall_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">f1_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> threshold <span class="token keyword">in</span> thresholds<span class="token punctuation">:</span></span>
<span class="line">    y_pred_threshold <span class="token operator">=</span> <span class="token punctuation">(</span>y_prob <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line">    precision_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>precision_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_threshold<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    recall_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_threshold<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    f1_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_threshold<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–ä¸åŒé˜ˆå€¼ä¸‹çš„æ€§èƒ½</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>thresholds<span class="token punctuation">,</span> precision_scores<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;ç²¾ç¡®ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>thresholds<span class="token punctuation">,</span> recall_scores<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;å¬å›ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>thresholds<span class="token punctuation">,</span> f1_scores<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;F1åˆ†æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;é˜ˆå€¼&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;åˆ†æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ä¸åŒé˜ˆå€¼ä¸‹çš„æ¨¡å‹æ€§èƒ½&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰¾åˆ°F1åˆ†æ•°æœ€é«˜çš„é˜ˆå€¼</span></span>
<span class="line">best_threshold <span class="token operator">=</span> thresholds<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>f1_scores<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æœ€ä½³é˜ˆå€¼: </span><span class="token interpolation"><span class="token punctuation">{</span>best_threshold<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;åœ¨æœ€ä½³é˜ˆå€¼ä¸‹çš„F1åˆ†æ•°: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">max</span><span class="token punctuation">(</span>f1_scores<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨æœ€ä½³é˜ˆå€¼è¿›è¡Œæœ€ç»ˆé¢„æµ‹</span></span>
<span class="line">y_pred_final <span class="token operator">=</span> <span class="token punctuation">(</span>y_prob <span class="token operator">&gt;=</span> best_threshold<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\nä½¿ç”¨æœ€ä½³é˜ˆå€¼çš„æœ€ç»ˆè¯„ä¼°ç»“æœ:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_final<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-ä¸šåŠ¡è§£é‡Šä¸å»ºè®®" tabindex="-1"><a class="header-anchor" href="#_7-ä¸šåŠ¡è§£é‡Šä¸å»ºè®®"><span>7. ä¸šåŠ¡è§£é‡Šä¸å»ºè®®</span></a></h3><p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦å°†æ¨¡å‹ç»“æœè½¬åŒ–ä¸ºä¸šåŠ¡æ´å¯Ÿï¼š</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è®¡ç®—æ‹’ç»ç‡å’Œåè´¦ç‡</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">calculate_business_metrics</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> y_prob<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># ä½¿ç”¨ç»™å®šé˜ˆå€¼çš„é¢„æµ‹</span></span>
<span class="line">    y_pred_threshold <span class="token operator">=</span> <span class="token punctuation">(</span>y_prob <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è®¡ç®—æ‹’ç»ç‡ï¼ˆé¢„æµ‹ä¸ºåå®¢æˆ·çš„æ¯”ä¾‹ï¼‰</span></span>
<span class="line">    rejection_rate <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y_pred_threshold<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è®¡ç®—åè´¦ç‡ï¼ˆåœ¨é¢„æµ‹ä¸ºå¥½å®¢æˆ·ä¸­å®é™…ä¸ºåå®¢æˆ·çš„æ¯”ä¾‹ï¼‰</span></span>
<span class="line">    approved_indices <span class="token operator">=</span> y_pred_threshold <span class="token operator">==</span> <span class="token number">0</span></span>
<span class="line">    <span class="token keyword">if</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>approved_indices<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">        bad_debt_rate <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y_true<span class="token punctuation">[</span>approved_indices<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        bad_debt_rate <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> rejection_rate<span class="token punctuation">,</span> bad_debt_rate</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—ä¸åŒé˜ˆå€¼ä¸‹çš„ä¸šåŠ¡æŒ‡æ ‡</span></span>
<span class="line">business_metrics <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">for</span> threshold <span class="token keyword">in</span> thresholds<span class="token punctuation">:</span></span>
<span class="line">    rejection_rate<span class="token punctuation">,</span> bad_debt_rate <span class="token operator">=</span> calculate_business_metrics<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> y_prob<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span></span>
<span class="line">    business_metrics<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>threshold<span class="token punctuation">,</span> rejection_rate<span class="token punctuation">,</span> bad_debt_rate<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">business_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>business_metrics<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Threshold&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Rejection Rate&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bad Debt Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–ä¸šåŠ¡æŒ‡æ ‡</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>business_df<span class="token punctuation">[</span><span class="token string">&#39;Threshold&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> business_df<span class="token punctuation">[</span><span class="token string">&#39;Rejection Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;æ‹’ç»ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>business_df<span class="token punctuation">[</span><span class="token string">&#39;Threshold&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> business_df<span class="token punctuation">[</span><span class="token string">&#39;Bad Debt Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;åè´¦ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;é˜ˆå€¼&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;æ¯”ç‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ä¸åŒé˜ˆå€¼ä¸‹çš„ä¸šåŠ¡æŒ‡æ ‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ¹æ®ä¸šåŠ¡ç›®æ ‡é€‰æ‹©é˜ˆå€¼</span></span>
<span class="line"><span class="token comment"># ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åè´¦ç‡ä¸è¶…è¿‡5%</span></span>
<span class="line">target_bad_debt <span class="token operator">=</span> <span class="token number">0.05</span></span>
<span class="line">valid_thresholds <span class="token operator">=</span> business_df<span class="token punctuation">[</span>business_df<span class="token punctuation">[</span><span class="token string">&#39;Bad Debt Rate&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> target_bad_debt<span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token keyword">not</span> valid_thresholds<span class="token punctuation">.</span>empty<span class="token punctuation">:</span></span>
<span class="line">    business_threshold <span class="token operator">=</span> valid_thresholds<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>valid_thresholds<span class="token punctuation">[</span><span class="token string">&#39;Rejection Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;Threshold&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ä¸ºè¾¾åˆ°åè´¦ç‡ä¸è¶…è¿‡5%çš„ç›®æ ‡ï¼Œå»ºè®®ä½¿ç”¨é˜ˆå€¼: </span><span class="token interpolation"><span class="token punctuation">{</span>business_threshold<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;åœ¨æ­¤é˜ˆå€¼ä¸‹çš„æ‹’ç»ç‡: </span><span class="token interpolation"><span class="token punctuation">{</span>valid_thresholds<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>valid_thresholds<span class="token punctuation">[</span><span class="token string">&#39;Rejection Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;Rejection Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;åœ¨æ­¤é˜ˆå€¼ä¸‹çš„åè´¦ç‡: </span><span class="token interpolation"><span class="token punctuation">{</span>valid_thresholds<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>valid_thresholds<span class="token punctuation">[</span><span class="token string">&#39;Rejection Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;Bad Debt Rate&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æ— æ³•æ‰¾åˆ°æ»¡è¶³åè´¦ç‡ç›®æ ‡çš„é˜ˆå€¼&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è¿›é˜¶æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶æŒ‘æˆ˜"><span>è¿›é˜¶æŒ‘æˆ˜</span></a></h2><p>å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š</p><ol><li><strong>æˆæœ¬æ•æ„Ÿå­¦ä¹ </strong>ï¼šè€ƒè™‘ä¸åŒç±»å‹é”™è¯¯çš„ä¸šåŠ¡æˆæœ¬ï¼Œæ„å»ºæˆæœ¬æ•æ„Ÿçš„æ¨¡å‹</li><li><strong>ç‰¹å¾å·¥ç¨‹è¿›é˜¶</strong>ï¼šåˆ›å»ºäº¤äº’ç‰¹å¾ã€å¤šé¡¹å¼ç‰¹å¾æˆ–åŸºäºé¢†åŸŸçŸ¥è¯†çš„ç‰¹å¾</li><li><strong>æ¨¡å‹è§£é‡Šè¿›é˜¶</strong>ï¼šä½¿ç”¨LIMEæˆ–SHAPç­‰å·¥å…·æä¾›ä¸ªä½“é¢„æµ‹çš„è§£é‡Š</li><li><strong>å…¬å¹³æ€§åˆ†æ</strong>ï¼šè¯„ä¼°æ¨¡å‹åœ¨ä¸åŒäººå£ç»Ÿè®¡ç¾¤ä½“ä¸Šçš„è¡¨ç°ï¼Œæ£€æµ‹å’Œå‡è½»æ½œåœ¨åè§</li><li><strong>éƒ¨ç½²è€ƒé‡</strong>ï¼šè®¾è®¡æ¨¡å‹ç›‘æ§å’Œæ›´æ–°ç­–ç•¥ï¼Œå¤„ç†æ¦‚å¿µæ¼‚ç§»é—®é¢˜</li></ol><h2 id="å°ç»“ä¸åæ€" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸åæ€"><span>å°ç»“ä¸åæ€</span></a></h2><p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ„å»ºä¿¡ç”¨é£é™©è¯„ä¼°æ¨¡å‹ï¼Œå¤„ç†ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ï¼Œå¹¶å°†æ¨¡å‹ç»“æœè½¬åŒ–ä¸ºä¸šåŠ¡å†³ç­–ã€‚ä¿¡ç”¨é£é™©è¯„ä¼°æ˜¯ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œéœ€è¦å¹³è¡¡å¤šç§å› ç´ ï¼ŒåŒ…æ‹¬é¢„æµ‹å‡†ç¡®æ€§ã€ä¸šåŠ¡ç›®æ ‡å’Œä¼¦ç†è€ƒé‡ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¿¡ç”¨é£é™©æ¨¡å‹éœ€è¦å®šæœŸæ›´æ–°å’Œç›‘æ§ï¼Œä»¥é€‚åº”ä¸æ–­å˜åŒ–çš„ç»æµç¯å¢ƒå’Œå®¢æˆ·è¡Œä¸ºã€‚æ­¤å¤–ï¼Œæ¨¡å‹çš„å…¬å¹³æ€§å’Œé€æ˜åº¦ä¹Ÿæ˜¯é‡è¦çš„è€ƒé‡å› ç´ ï¼Œç¡®ä¿ä¿¡è´·å†³ç­–ä¸ä¼šå¯¹ç‰¹å®šç¾¤ä½“é€ æˆä¸å…¬å¹³çš„å½±å“ã€‚</p><h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3><ol><li>åœ¨ä¿¡ç”¨é£é™©è¯„ä¼°ä¸­ï¼Œå¦‚ä½•å¹³è¡¡æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½å’Œå¯è§£é‡Šæ€§éœ€æ±‚ï¼Ÿ</li><li>ä¸åŒçš„é‡‡æ ·æ–¹æ³•å¦‚ä½•å½±å“æ¨¡å‹å¯¹å°‘æ•°ç±»ï¼ˆé«˜é£é™©å®¢æˆ·ï¼‰çš„é¢„æµ‹èƒ½åŠ›ï¼Ÿ</li><li>å¦‚ä½•å°†ä¿¡ç”¨é£é™©æ¨¡å‹ä¸ä¸šåŠ¡æµç¨‹é›†æˆï¼Œä½¿å…¶æˆä¸ºæœ‰æ•ˆçš„å†³ç­–æ”¯æŒå·¥å…·ï¼Ÿ</li></ol><div class="practice-link"><a href="/projects/clustering/customer-segmentation.html" class="button">ä¸‹ä¸€ä¸ªæ¨¡å—ï¼šèšç±»åˆ†æé¡¹ç›®</a></div>`,47)]))}const i=s(e,[["render",c],["__file","credit-risk.html.vue"]]),u=JSON.parse('{"path":"/projects/classification/credit-risk.html","title":"ä¿¡ç”¨é£é™©è¯„ä¼°","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"é¡¹ç›®èƒŒæ™¯","slug":"é¡¹ç›®èƒŒæ™¯","link":"#é¡¹ç›®èƒŒæ™¯","children":[]},{"level":2,"title":"æ•°æ®é›†ä»‹ç»","slug":"æ•°æ®é›†ä»‹ç»","link":"#æ•°æ®é›†ä»‹ç»","children":[]},{"level":2,"title":"é¡¹ç›®ç›®æ ‡","slug":"é¡¹ç›®ç›®æ ‡","link":"#é¡¹ç›®ç›®æ ‡","children":[]},{"level":2,"title":"å®æ–½æ­¥éª¤","slug":"å®æ–½æ­¥éª¤","link":"#å®æ–½æ­¥éª¤","children":[{"level":3,"title":"1. æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†","slug":"_1-æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†","link":"#_1-æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†","children":[]},{"level":3,"title":"2. å¤„ç†ç±»åˆ«ä¸å¹³è¡¡","slug":"_2-å¤„ç†ç±»åˆ«ä¸å¹³è¡¡","link":"#_2-å¤„ç†ç±»åˆ«ä¸å¹³è¡¡","children":[]},{"level":3,"title":"3. æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","slug":"_3-æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","link":"#_3-æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","children":[]},{"level":3,"title":"4. ç‰¹å¾é‡è¦æ€§åˆ†æ","slug":"_4-ç‰¹å¾é‡è¦æ€§åˆ†æ","link":"#_4-ç‰¹å¾é‡è¦æ€§åˆ†æ","children":[]},{"level":3,"title":"5. æ¨¡å‹ä¼˜åŒ–","slug":"_5-æ¨¡å‹ä¼˜åŒ–","link":"#_5-æ¨¡å‹ä¼˜åŒ–","children":[]},{"level":3,"title":"6. é˜ˆå€¼ä¼˜åŒ–","slug":"_6-é˜ˆå€¼ä¼˜åŒ–","link":"#_6-é˜ˆå€¼ä¼˜åŒ–","children":[]},{"level":3,"title":"7. ä¸šåŠ¡è§£é‡Šä¸å»ºè®®","slug":"_7-ä¸šåŠ¡è§£é‡Šä¸å»ºè®®","link":"#_7-ä¸šåŠ¡è§£é‡Šä¸å»ºè®®","children":[]}]},{"level":2,"title":"è¿›é˜¶æŒ‘æˆ˜","slug":"è¿›é˜¶æŒ‘æˆ˜","link":"#è¿›é˜¶æŒ‘æˆ˜","children":[]},{"level":2,"title":"å°ç»“ä¸åæ€","slug":"å°ç»“ä¸åæ€","link":"#å°ç»“ä¸åæ€","children":[{"level":3,"title":"æ€è€ƒé—®é¢˜","slug":"æ€è€ƒé—®é¢˜","link":"#æ€è€ƒé—®é¢˜","children":[]}]}],"git":{},"filePathRelative":"projects/classification/credit-risk.md"}');export{i as comp,u as data};
