import{_ as p,e as t,i as e,g as l,f as s,r as c,o}from"./app-pdqCx57v.js";const i={};function u(k,n){const a=c("BackToPath");return o(),t("div",null,[n[0]||(n[0]=e(`<h1 id="å›å½’å®è·µæ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å›å½’å®è·µæ¡ˆä¾‹"><span>å›å½’å®è·µæ¡ˆä¾‹</span></a></h1><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ“š</span>æœ¬èŠ‚è¦ç‚¹ </div><div class="knowledge-card__content"><ul><li>é€šè¿‡å®é™…æ¡ˆä¾‹å­¦ä¹ å›å½’åˆ†æçš„å®Œæ•´æµç¨‹</li><li>æŒæ¡æ•°æ®é¢„å¤„ç†ã€ç‰¹å¾å·¥ç¨‹å’Œæ¨¡å‹é€‰æ‹©çš„å®è·µæŠ€å·§</li><li>å­¦ä¹ å¦‚ä½•è§£é‡Šå›å½’æ¨¡å‹ç»“æœå¹¶æå‡ºä¸šåŠ¡å»ºè®®</li><li>äº†è§£ä¸åŒé¢†åŸŸå›å½’åˆ†æçš„åº”ç”¨æ–¹æ³•</li></ul></div></div><h2 id="æ¡ˆä¾‹ä¸€-æˆ¿ä»·é¢„æµ‹" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹ä¸€-æˆ¿ä»·é¢„æµ‹"><span>æ¡ˆä¾‹ä¸€ï¼šæˆ¿ä»·é¢„æµ‹</span></a></h2><p>æˆ¿ä»·é¢„æµ‹æ˜¯å›å½’åˆ†æçš„ç»å…¸åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†è¿›è¡Œæ¼”ç¤ºã€‚</p><h3 id="é—®é¢˜æè¿°" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜æè¿°"><span>é—®é¢˜æè¿°</span></a></h3><p>é¢„æµ‹æ³¢å£«é¡¿åœ°åŒºçš„æˆ¿å±‹ä»·æ ¼ï¼Œå¸®åŠ©è´­æˆ¿è€…å’Œæˆ¿åœ°äº§å¼€å‘å•†åšå‡ºå†³ç­–ã€‚</p><h3 id="æ•°æ®æ¢ç´¢" tabindex="-1"><a class="header-anchor" href="#æ•°æ®æ¢ç´¢"><span>æ•°æ®æ¢ç´¢</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_boston</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> boston<span class="token punctuation">.</span>data</span>
<span class="line">y <span class="token operator">=</span> boston<span class="token punctuation">.</span>target</span>
<span class="line">feature_names <span class="token operator">=</span> boston<span class="token punctuation">.</span>feature_names</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºDataFrame</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>X<span class="token punctuation">,</span> columns<span class="token operator">=</span>feature_names<span class="token punctuation">)</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;PRICE&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> y</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\nç»Ÿè®¡æ‘˜è¦:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹ç›®æ ‡å˜é‡åˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;PRICE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;ä»·æ ¼ï¼ˆåƒç¾å…ƒï¼‰&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é¢‘æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;æ³¢å£«é¡¿æˆ¿ä»·åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç›¸å…³æ€§åˆ†æ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">correlation_matrix <span class="token operator">=</span> df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>correlation_matrix<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;coolwarm&#39;</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">&#39;.2f&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ç‰¹å¾ç›¸å…³æ€§çŸ©é˜µ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ•£ç‚¹å›¾çŸ©é˜µ</span></span>
<span class="line">sns<span class="token punctuation">.</span>pairplot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;PRICE&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;RM&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;LSTAT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;DIS&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;NOX&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">&#39;ä¸»è¦ç‰¹å¾ä¸æˆ¿ä»·çš„å…³ç³»&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">1.02</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="æ•°æ®é¢„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é¢„å¤„ç†"><span>æ•°æ®é¢„å¤„ç†</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºé¢„å¤„ç†ç®¡é“</span></span>
<span class="line">preprocessor <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token string">&#39;scaler&#39;</span><span class="token punctuation">,</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨é¢„å¤„ç†</span></span>
<span class="line">X_train_processed <span class="token operator">=</span> preprocessor<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span></span>
<span class="line">X_test_processed <span class="token operator">=</span> preprocessor<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°" tabindex="-1"><a class="header-anchor" href="#æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°"><span>æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression<span class="token punctuation">,</span> Ridge<span class="token punctuation">,</span> Lasso</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor<span class="token punctuation">,</span> GradientBoostingRegressor</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token punctuation">,</span> r2_score</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line">models <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Linear Regression&#39;</span><span class="token punctuation">:</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Ridge&#39;</span><span class="token punctuation">:</span> Ridge<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Lasso&#39;</span><span class="token punctuation">:</span> Lasso<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Random Forest&#39;</span><span class="token punctuation">:</span> RandomForestRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Gradient Boosting&#39;</span><span class="token punctuation">:</span> GradientBoostingRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒå’Œè¯„ä¼°</span></span>
<span class="line">results <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_processed<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># é¢„æµ‹</span></span>
<span class="line">    y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test_processed<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è®¡ç®—è¯„ä¼°æŒ‡æ ‡</span></span>
<span class="line">    mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    rmse <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mse<span class="token punctuation">)</span></span>
<span class="line">    r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># å­˜å‚¨ç»“æœ</span></span>
<span class="line">    results<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;MSE&#39;</span><span class="token punctuation">:</span> mse<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;RMSE&#39;</span><span class="token punctuation">:</span> rmse<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">:</span> r2</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºç»“æœ</span></span>
<span class="line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> metrics <span class="token keyword">in</span> results<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">:&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  MSE: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;MSE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  RMSE: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;RMSE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  RÂ²: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–æ¯”è¾ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">mse_values <span class="token operator">=</span> <span class="token punctuation">[</span>results<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;MSE&#39;</span><span class="token punctuation">]</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">]</span></span>
<span class="line">r2_values <span class="token operator">=</span> <span class="token punctuation">[</span>results<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">]</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">width <span class="token operator">=</span> <span class="token number">0.35</span></span>
<span class="line"></span>
<span class="line">fig<span class="token punctuation">,</span> ax1 <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">ax2 <span class="token operator">=</span> ax1<span class="token punctuation">.</span>twinx<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">rects1 <span class="token operator">=</span> ax1<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">-</span> width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> mse_values<span class="token punctuation">,</span> width<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;MSE&#39;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span></span>
<span class="line">rects2 <span class="token operator">=</span> ax2<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">+</span> width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> r2_values<span class="token punctuation">,</span> width<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;blue&#39;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">ax1<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">&#39;æ¨¡å‹&#39;</span><span class="token punctuation">)</span></span>
<span class="line">ax1<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">&#39;MSE&#39;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">)</span></span>
<span class="line">ax2<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;blue&#39;</span><span class="token punctuation">)</span></span>
<span class="line">ax1<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span>x<span class="token punctuation">)</span></span>
<span class="line">ax1<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span>names<span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">)</span></span>
<span class="line">ax1<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">&#39;y&#39;</span><span class="token punctuation">,</span> labelcolor<span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">)</span></span>
<span class="line">ax2<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">&#39;y&#39;</span><span class="token punctuation">,</span> labelcolor<span class="token operator">=</span><span class="token string">&#39;blue&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">fig<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ä¸åŒæ¨¡å‹æ€§èƒ½æ¯”è¾ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="ç‰¹å¾é‡è¦æ€§åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ç‰¹å¾é‡è¦æ€§åˆ†æ"><span>ç‰¹å¾é‡è¦æ€§åˆ†æ</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># ä½¿ç”¨éšæœºæ£®æ—çš„ç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">rf_model <span class="token operator">=</span> models<span class="token punctuation">[</span><span class="token string">&#39;Random Forest&#39;</span><span class="token punctuation">]</span></span>
<span class="line">importances <span class="token operator">=</span> rf_model<span class="token punctuation">.</span>feature_importances_</span>
<span class="line">indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>importances<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ç‰¹å¾é‡è¦æ€§&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importances<span class="token punctuation">[</span>indices<span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>feature_names<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">]</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‰5ä¸ªæœ€é‡è¦çš„ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€é‡è¦çš„5ä¸ªç‰¹å¾:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>feature_names<span class="token punctuation">[</span>indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>importances<span class="token punctuation">[</span>indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="æ¨¡å‹ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¨¡å‹ä¼˜åŒ–"><span>æ¨¡å‹ä¼˜åŒ–</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV</span>
<span class="line"></span>
<span class="line"><span class="token comment"># é€‰æ‹©è¡¨ç°æœ€å¥½çš„æ¨¡å‹è¿›è¡Œä¼˜åŒ–ï¼ˆå‡è®¾æ˜¯æ¢¯åº¦æå‡ï¼‰</span></span>
<span class="line">best_model <span class="token operator">=</span> GradientBoostingRegressor<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰å‚æ•°ç½‘æ ¼</span></span>
<span class="line">param_grid <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;n_estimators&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;learning_rate&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;max_depth&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;min_samples_split&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;subsample&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºç½‘æ ¼æœç´¢</span></span>
<span class="line">grid_search <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span></span>
<span class="line">    best_model<span class="token punctuation">,</span></span>
<span class="line">    param_grid<span class="token punctuation">,</span></span>
<span class="line">    cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">    scoring<span class="token operator">=</span><span class="token string">&#39;neg_mean_squared_error&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒ</span></span>
<span class="line">grid_search<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_processed<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æœ€ä½³å‚æ•°</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ä½³å‚æ•°:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>grid_search<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨æœ€ä½³æ¨¡å‹é¢„æµ‹</span></span>
<span class="line">best_gbr <span class="token operator">=</span> grid_search<span class="token punctuation">.</span>best_estimator_</span>
<span class="line">y_pred <span class="token operator">=</span> best_gbr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test_processed<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯„ä¼°</span></span>
<span class="line">mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">rmse <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mse<span class="token punctuation">)</span></span>
<span class="line">r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ä¼˜åŒ–åçš„æ¨¡å‹æ€§èƒ½:&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  MSE: </span><span class="token interpolation"><span class="token punctuation">{</span>mse<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  RMSE: </span><span class="token interpolation"><span class="token punctuation">{</span>rmse<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  RÂ²: </span><span class="token interpolation"><span class="token punctuation">{</span>r2<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="ç»“æœå¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#ç»“æœå¯è§†åŒ–"><span>ç»“æœå¯è§†åŒ–</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># é¢„æµ‹å€¼ä¸å®é™…å€¼æ¯”è¾ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>y_test<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y_test<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>y_test<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y_test<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;k--&#39;</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;å®é™…ä»·æ ¼&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é¢„æµ‹ä»·æ ¼&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;é¢„æµ‹å€¼ä¸å®é™…å€¼æ¯”è¾ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ®‹å·®åˆ†æ</span></span>
<span class="line">residuals <span class="token operator">=</span> y_test <span class="token operator">-</span> y_pred</span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> residuals<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>y_pred<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y_pred<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;k--&#39;</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;é¢„æµ‹ä»·æ ¼&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;æ®‹å·®&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;æ®‹å·®åˆ†æ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ®‹å·®åˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>residuals<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;æ®‹å·®&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é¢‘æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;æ®‹å·®åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="ä¸šåŠ¡å»ºè®®" tabindex="-1"><a class="header-anchor" href="#ä¸šåŠ¡å»ºè®®"><span>ä¸šåŠ¡å»ºè®®</span></a></h3><p>åŸºäºæ¨¡å‹ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æå‡ºä»¥ä¸‹ä¸šåŠ¡å»ºè®®ï¼š</p><ol><li><strong>å…³æ³¨é‡è¦ç‰¹å¾</strong>ï¼šæ ¹æ®ç‰¹å¾é‡è¦æ€§ï¼Œæˆ¿å±‹çš„å¹³å‡æˆ¿é—´æ•°(RM)å’Œä½æ”¶å…¥äººå£æ¯”ä¾‹(LSTAT)å¯¹æˆ¿ä»·å½±å“æœ€å¤§ï¼Œå¼€å‘å•†åº”ä¼˜å…ˆè€ƒè™‘è¿™äº›å› ç´ </li><li><strong>å®šä»·ç­–ç•¥</strong>ï¼šä½¿ç”¨æ¨¡å‹é¢„æµ‹åˆç†çš„æˆ¿ä»·åŒºé—´ï¼Œé¿å…å®šä»·è¿‡é«˜æˆ–è¿‡ä½</li><li><strong>æŠ•èµ„å†³ç­–</strong>ï¼šæ ¹æ®æ¨¡å‹é¢„æµ‹ï¼Œè¯†åˆ«æ½œåœ¨çš„ä½ä¼°æˆ–é«˜ä¼°æˆ¿äº§</li><li><strong>å¸‚åœºç»†åˆ†</strong>ï¼šæ ¹æ®ä¸åŒç‰¹å¾ç»„åˆï¼Œå°†å¸‚åœºç»†åˆ†ä¸ºä¸åŒä»·æ ¼åŒºé—´çš„å­å¸‚åœº</li></ol><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ </div><div class="knowledge-card__content"><p>æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†æ˜¯ç”±å¡å†…åŸºæ¢…éš†å¤§å­¦çš„Harrisonå’ŒRubinfeldäº1978å¹´æ”¶é›†çš„ï¼ŒåŒ…å«äº†æ³¢å£«é¡¿éƒŠåŒº506ä¸ªäººå£æ™®æŸ¥åŒºçš„æˆ¿ä»·ä¸­ä½æ•°å’Œ13ä¸ªæ½œåœ¨å½±å“å› ç´ ã€‚å°½ç®¡è¿™ä¸ªæ•°æ®é›†å·²æœ‰å‡ åå¹´å†å²ï¼Œä½†å®ƒä»ç„¶æ˜¯å›å½’åˆ†ææ•™å­¦å’Œç ”ç©¶çš„ç»å…¸æ•°æ®é›†ã€‚</p></div></div><h2 id="æ¡ˆä¾‹äºŒ-é”€å”®é¢„æµ‹" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹äºŒ-é”€å”®é¢„æµ‹"><span>æ¡ˆä¾‹äºŒï¼šé”€å”®é¢„æµ‹</span></a></h2><p>é”€å”®é¢„æµ‹æ˜¯ä¼ä¸šå†³ç­–çš„é‡è¦ä¾æ®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é›¶å”®é”€å”®æ•°æ®è¿›è¡Œæ¼”ç¤ºã€‚</p><h3 id="é—®é¢˜æè¿°-1" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜æè¿°-1"><span>é—®é¢˜æè¿°</span></a></h3><p>é¢„æµ‹æœªæ¥å‡ ä¸ªæœˆçš„äº§å“é”€å”®é‡ï¼Œå¸®åŠ©ä¼ä¸šä¼˜åŒ–åº“å­˜ç®¡ç†å’Œè¥é”€ç­–ç•¥ã€‚</p><h3 id="æ•°æ®æ¢ç´¢-1" tabindex="-1"><a class="header-anchor" href="#æ•°æ®æ¢ç´¢-1"><span>æ•°æ®æ¢ç´¢</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>seasonal <span class="token keyword">import</span> seasonal_decompose</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®ï¼ˆå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«æ—¥æœŸå’Œé”€å”®é‡çš„CSVæ–‡ä»¶ï¼‰</span></span>
<span class="line"><span class="token comment"># sales_data = pd.read_csv(&#39;sales_data.csv&#39;)</span></span>
<span class="line"><span class="token comment"># ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€äº›æ¨¡æ‹Ÿæ•°æ®</span></span>
<span class="line">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">date_rng <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">&#39;2018-01-01&#39;</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&#39;2020-12-31&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">)</span></span>
<span class="line">sales_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>date_rng<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>date_rng<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \\</span>
<span class="line">                     <span class="token number">20</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>date_rng<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">/</span> <span class="token number">365</span><span class="token punctuation">)</span> <span class="token operator">+</span> \\</span>
<span class="line">                     np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>date_rng<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;weekday&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>dayofweek</span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;month&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month</span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;year&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year</span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;day&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>day</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>sales_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\nç»Ÿè®¡æ‘˜è¦:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>sales_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–é”€å”®è¶‹åŠ¿</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>sales_data<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;é”€å”®è¶‹åŠ¿&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;æ—¥æœŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŒ‰æœˆä»½èšåˆ</span></span>
<span class="line">monthly_sales <span class="token operator">=</span> sales_data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;year&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;month&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;year_month&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;year&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;-&#39;</span> <span class="token operator">+</span> monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;month&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;year_month&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> monthly_sales<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;æœˆåº¦é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;å¹´-æœˆ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">&#39;y&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å­£èŠ‚æ€§åˆ†è§£</span></span>
<span class="line"><span class="token comment"># å°†æ•°æ®è½¬æ¢ä¸ºæ—¶é—´åºåˆ—æ ¼å¼</span></span>
<span class="line">ts_data <span class="token operator">=</span> sales_data<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span></span>
<span class="line">decomposition <span class="token operator">=</span> seasonal_decompose<span class="token punctuation">(</span>ts_data<span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">&#39;additive&#39;</span><span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">365</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">fig<span class="token punctuation">,</span> <span class="token punctuation">(</span>ax1<span class="token punctuation">,</span> ax2<span class="token punctuation">,</span> ax3<span class="token punctuation">,</span> ax4<span class="token punctuation">)</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>observed<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax1<span class="token punctuation">)</span></span>
<span class="line">ax1<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;è§‚æµ‹å€¼&#39;</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>trend<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax2<span class="token punctuation">)</span></span>
<span class="line">ax2<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;è¶‹åŠ¿&#39;</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>seasonal<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax3<span class="token punctuation">)</span></span>
<span class="line">ax3<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;å­£èŠ‚æ€§&#39;</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>resid<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax4<span class="token punctuation">)</span></span>
<span class="line">ax4<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;æ®‹å·®&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŒ‰æ˜ŸæœŸå‡ åˆ†æ</span></span>
<span class="line">weekday_sales <span class="token operator">=</span> sales_data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;weekday&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">weekday_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;å‘¨ä¸€&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å‘¨äºŒ&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å‘¨ä¸‰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å‘¨å››&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å‘¨äº”&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å‘¨å…­&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å‘¨æ—¥&#39;</span><span class="token punctuation">]</span></span>
<span class="line">weekday_sales<span class="token punctuation">[</span><span class="token string">&#39;weekday_name&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> weekday_sales<span class="token punctuation">[</span><span class="token string">&#39;weekday&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> weekday_names<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>weekday_sales<span class="token punctuation">[</span><span class="token string">&#39;weekday_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> weekday_sales<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ä¸åŒæ˜ŸæœŸå‡ çš„å¹³å‡é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;æ˜ŸæœŸå‡ &#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;å¹³å‡é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">&#39;y&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="ç‰¹å¾å·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#ç‰¹å¾å·¥ç¨‹"><span>ç‰¹å¾å·¥ç¨‹</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># åˆ›å»ºæ»åç‰¹å¾</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    sales_data<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;sales_lag_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span>i<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ»šåŠ¨å¹³å‡ç‰¹å¾</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales_ma_7&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales_ma_30&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºå­£èŠ‚æ€§ç‰¹å¾</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;is_weekend&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;weekday&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> <span class="token number">5</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;is_month_start&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;day&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">sales_data<span class="token punctuation">[</span><span class="token string">&#39;is_month_end&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;day&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> <span class="token number">25</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å»é™¤NaNå€¼</span></span>
<span class="line">sales_data <span class="token operator">=</span> sales_data<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡†å¤‡ç‰¹å¾å’Œç›®æ ‡å˜é‡</span></span>
<span class="line">features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;weekday&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;month&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;is_weekend&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;is_month_start&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;is_month_end&#39;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&#39;sales_lag_1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sales_lag_2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sales_lag_3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sales_lag_4&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">            <span class="token string">&#39;sales_lag_5&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sales_lag_6&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sales_lag_7&#39;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&#39;sales_ma_7&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sales_ma_30&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">X <span class="token operator">=</span> sales_data<span class="token punctuation">[</span>features<span class="token punctuation">]</span></span>
<span class="line">y <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;sales&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰</span></span>
<span class="line">train_size <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sales_data<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">)</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°-1" tabindex="-1"><a class="header-anchor" href="#æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°-1"><span>æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor<span class="token punctuation">,</span> GradientBoostingRegressor</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token punctuation">,</span> mean_absolute_error<span class="token punctuation">,</span> r2_score</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line">models <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Linear Regression&#39;</span><span class="token punctuation">:</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Random Forest&#39;</span><span class="token punctuation">:</span> RandomForestRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Gradient Boosting&#39;</span><span class="token punctuation">:</span> GradientBoostingRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒå’Œè¯„ä¼°</span></span>
<span class="line">results <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># é¢„æµ‹</span></span>
<span class="line">    y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è®¡ç®—è¯„ä¼°æŒ‡æ ‡</span></span>
<span class="line">    mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    rmse <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mse<span class="token punctuation">)</span></span>
<span class="line">    mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># å­˜å‚¨ç»“æœ</span></span>
<span class="line">    results<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;MSE&#39;</span><span class="token punctuation">:</span> mse<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;RMSE&#39;</span><span class="token punctuation">:</span> rmse<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;MAE&#39;</span><span class="token punctuation">:</span> mae<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">:</span> r2</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºç»“æœ</span></span>
<span class="line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> metrics <span class="token keyword">in</span> results<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">:&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  MSE: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;MSE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  RMSE: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;RMSE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  MAE: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;MAE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  RÂ²: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">[</span><span class="token string">&#39;RÂ²&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="é¢„æµ‹å¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#é¢„æµ‹å¯è§†åŒ–"><span>é¢„æµ‹å¯è§†åŒ–</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># ä½¿ç”¨è¡¨ç°æœ€å¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼ˆå‡è®¾æ˜¯æ¢¯åº¦æå‡ï¼‰</span></span>
<span class="line">best_model <span class="token operator">=</span> models<span class="token punctuation">[</span><span class="token string">&#39;Gradient Boosting&#39;</span><span class="token punctuation">]</span></span>
<span class="line">y_pred <span class="token operator">=</span> best_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºåŒ…å«æ—¥æœŸã€å®é™…å€¼å’Œé¢„æµ‹å€¼çš„DataFrame</span></span>
<span class="line">pred_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;date&#39;</span><span class="token punctuation">:</span> sales_data<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;actual&#39;</span><span class="token punctuation">:</span> y_test<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;predicted&#39;</span><span class="token punctuation">:</span> y_pred</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–é¢„æµ‹ç»“æœ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>pred_df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred_df<span class="token punctuation">[</span><span class="token string">&#39;actual&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;å®é™…é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>pred_df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred_df<span class="token punctuation">[</span><span class="token string">&#39;predicted&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;é¢„æµ‹é”€å”®é‡&#39;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;é”€å”®é‡é¢„æµ‹&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;æ—¥æœŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é”€å”®é‡&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹è¯¯å·®åˆ†æ</span></span>
<span class="line">pred_df<span class="token punctuation">[</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pred_df<span class="token punctuation">[</span><span class="token string">&#39;actual&#39;</span><span class="token punctuation">]</span> <span class="token operator">-</span> pred_df<span class="token punctuation">[</span><span class="token string">&#39;predicted&#39;</span><span class="token punctuation">]</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>pred_df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pred_df<span class="token punctuation">[</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;-&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;é¢„æµ‹è¯¯å·®&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;æ—¥æœŸ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;è¯¯å·®&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯¯å·®åˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>pred_df<span class="token punctuation">[</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;è¯¯å·®åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;è¯¯å·®&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;é¢‘æ•°&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="ç‰¹å¾é‡è¦æ€§åˆ†æ-1" tabindex="-1"><a class="header-anchor" href="#ç‰¹å¾é‡è¦æ€§åˆ†æ-1"><span>ç‰¹å¾é‡è¦æ€§åˆ†æ</span></a></h3><div class="code-example"><div class="code-example__title">ä»£ç ç¤ºä¾‹</div><div class="code-example__content"><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># ä½¿ç”¨æ¢¯åº¦æå‡æ¨¡å‹çš„ç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">importances <span class="token operator">=</span> best_model<span class="token punctuation">.</span>feature_importances_</span>
<span class="line">indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>importances<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ç‰¹å¾é‡è¦æ€§&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importances<span class="token punctuation">[</span>indices<span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">]</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‰5ä¸ªæœ€é‡è¦çš„ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€é‡è¦çš„5ä¸ªç‰¹å¾:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>features<span class="token punctuation">[</span>indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>importances<span class="token punctuation">[</span>indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><h3 id="ä¸šåŠ¡å»ºè®®-1" tabindex="-1"><a class="header-anchor" href="#ä¸šåŠ¡å»ºè®®-1"><span>ä¸šåŠ¡å»ºè®®</span></a></h3><p>åŸºäºé”€å”®é¢„æµ‹æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥æå‡ºä»¥ä¸‹ä¸šåŠ¡å»ºè®®ï¼š</p><ol><li><strong>åº“å­˜ç®¡ç†</strong>ï¼šæ ¹æ®é¢„æµ‹çš„é”€å”®é‡è°ƒæ•´åº“å­˜æ°´å¹³ï¼Œå‡å°‘åº“å­˜æˆæœ¬å’Œç¼ºè´§é£é™©</li><li><strong>ä¿ƒé”€æ´»åŠ¨</strong>ï¼šåœ¨é¢„æµ‹é”€å”®ä½è°·æœŸç­–åˆ’ä¿ƒé”€æ´»åŠ¨ï¼Œæé«˜é”€å”®é‡</li><li><strong>äººåŠ›èµ„æºè§„åˆ’</strong>ï¼šæ ¹æ®é¢„æµ‹çš„é”€å”®é«˜å³°æœŸåˆç†å®‰æ’äººå‘˜é…ç½®</li><li><strong>ä¾›åº”é“¾ä¼˜åŒ–</strong>ï¼šæå‰é€šçŸ¥ä¾›åº”å•†é¢„æœŸçš„éœ€æ±‚å˜åŒ–ï¼Œä¼˜åŒ–ä¾›åº”é“¾</li><li><strong>å­£èŠ‚æ€§ç­–ç•¥</strong>ï¼šé’ˆå¯¹å‘ç°çš„å­£èŠ‚æ€§æ¨¡å¼åˆ¶å®šç›¸åº”çš„è¥é”€å’Œäº§å“ç­–ç•¥</li></ol><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">âš ï¸</span>å¸¸è§è¯¯åŒº </div><div class="knowledge-card__content"><ul><li><strong>å¿½ç•¥å¤–éƒ¨å› ç´ </strong>ï¼šé”€å”®é¢„æµ‹åº”è€ƒè™‘å¸‚åœºè¶‹åŠ¿ã€ç«äº‰å¯¹æ‰‹æ´»åŠ¨ç­‰å¤–éƒ¨å› ç´ </li><li><strong>è¿‡åº¦ä¾èµ–å†å²æ•°æ®</strong>ï¼šå¸‚åœºç¯å¢ƒå˜åŒ–å¯èƒ½å¯¼è‡´å†å²æ¨¡å¼ä¸å†é€‚ç”¨</li><li><strong>å¿½ç•¥é¢„æµ‹åŒºé—´</strong>ï¼šæä¾›é¢„æµ‹åŒºé—´æ¯”å•ç‚¹é¢„æµ‹æ›´æœ‰ä»·å€¼</li><li><strong>ç¼ºä¹æŒç»­æ›´æ–°</strong>ï¼šé”€å”®é¢„æµ‹æ¨¡å‹åº”å®šæœŸæ›´æ–°ä»¥é€‚åº”æ–°æ•°æ®</li></ul></div></div><h2 id="å°ç»“ä¸æ€è€ƒ" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸æ€è€ƒ"><span>å°ç»“ä¸æ€è€ƒ</span></a></h2><p>é€šè¿‡å®é™…æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å›å½’åˆ†æåœ¨æˆ¿ä»·é¢„æµ‹å’Œé”€å”®é¢„æµ‹ä¸­çš„åº”ç”¨ã€‚è¿™äº›æ¡ˆä¾‹å±•ç¤ºäº†ä»æ•°æ®æ¢ç´¢åˆ°æ¨¡å‹éƒ¨ç½²çš„å®Œæ•´æµç¨‹ã€‚</p><h3 id="å…³é”®è¦ç‚¹å›é¡¾" tabindex="-1"><a class="header-anchor" href="#å…³é”®è¦ç‚¹å›é¡¾"><span>å…³é”®è¦ç‚¹å›é¡¾</span></a></h3><ul><li>æ•°æ®æ¢ç´¢å’Œå¯è§†åŒ–æ˜¯ç†è§£æ•°æ®ç‰¹æ€§çš„é‡è¦æ­¥éª¤</li><li>ç‰¹å¾å·¥ç¨‹å¯¹æ¨¡å‹æ€§èƒ½æœ‰æ˜¾è‘—å½±å“</li><li>ä¸åŒå›å½’æ¨¡å‹é€‚ç”¨äºä¸åŒç±»å‹çš„é—®é¢˜</li><li>æ¨¡å‹è¯„ä¼°åº”ä½¿ç”¨å¤šç§æŒ‡æ ‡</li><li>æ¨¡å‹ç»“æœçš„è§£é‡Šå’Œä¸šåŠ¡å»ºè®®æ˜¯æ•°æ®åˆ†æçš„æœ€ç»ˆç›®æ ‡</li></ul><h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3><ol><li>å¦‚ä½•å°†é¢†åŸŸçŸ¥è¯†èå…¥å›å½’æ¨¡å‹çš„æ„å»ºè¿‡ç¨‹ï¼Ÿ</li><li>åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¦‚ä½•å¹³è¡¡æ¨¡å‹å¤æ‚åº¦å’Œå¯è§£é‡Šæ€§ï¼Ÿ</li><li>å¦‚ä½•å¤„ç†å›å½’åˆ†æä¸­çš„æ•°æ®è´¨é‡é—®é¢˜ï¼Ÿ</li></ol>`,46)),l(a),n[1]||(n[1]=s("div",{class:"practice-link"},[s("a",{href:"/projects/regression.html",class:"button"},"å‰å¾€å®è·µé¡¹ç›®")],-1))])}const d=p(i,[["render",u],["__file","case-studies.html.vue"]]),m=JSON.parse('{"path":"/core/regression/case-studies.html","title":"å›å½’å®è·µæ¡ˆä¾‹","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"æ¡ˆä¾‹ä¸€ï¼šæˆ¿ä»·é¢„æµ‹","slug":"æ¡ˆä¾‹ä¸€-æˆ¿ä»·é¢„æµ‹","link":"#æ¡ˆä¾‹ä¸€-æˆ¿ä»·é¢„æµ‹","children":[{"level":3,"title":"é—®é¢˜æè¿°","slug":"é—®é¢˜æè¿°","link":"#é—®é¢˜æè¿°","children":[]},{"level":3,"title":"æ•°æ®æ¢ç´¢","slug":"æ•°æ®æ¢ç´¢","link":"#æ•°æ®æ¢ç´¢","children":[]},{"level":3,"title":"æ•°æ®é¢„å¤„ç†","slug":"æ•°æ®é¢„å¤„ç†","link":"#æ•°æ®é¢„å¤„ç†","children":[]},{"level":3,"title":"æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","slug":"æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","link":"#æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","children":[]},{"level":3,"title":"ç‰¹å¾é‡è¦æ€§åˆ†æ","slug":"ç‰¹å¾é‡è¦æ€§åˆ†æ","link":"#ç‰¹å¾é‡è¦æ€§åˆ†æ","children":[]},{"level":3,"title":"æ¨¡å‹ä¼˜åŒ–","slug":"æ¨¡å‹ä¼˜åŒ–","link":"#æ¨¡å‹ä¼˜åŒ–","children":[]},{"level":3,"title":"ç»“æœå¯è§†åŒ–","slug":"ç»“æœå¯è§†åŒ–","link":"#ç»“æœå¯è§†åŒ–","children":[]},{"level":3,"title":"ä¸šåŠ¡å»ºè®®","slug":"ä¸šåŠ¡å»ºè®®","link":"#ä¸šåŠ¡å»ºè®®","children":[]}]},{"level":2,"title":"æ¡ˆä¾‹äºŒï¼šé”€å”®é¢„æµ‹","slug":"æ¡ˆä¾‹äºŒ-é”€å”®é¢„æµ‹","link":"#æ¡ˆä¾‹äºŒ-é”€å”®é¢„æµ‹","children":[{"level":3,"title":"é—®é¢˜æè¿°","slug":"é—®é¢˜æè¿°-1","link":"#é—®é¢˜æè¿°-1","children":[]},{"level":3,"title":"æ•°æ®æ¢ç´¢","slug":"æ•°æ®æ¢ç´¢-1","link":"#æ•°æ®æ¢ç´¢-1","children":[]},{"level":3,"title":"ç‰¹å¾å·¥ç¨‹","slug":"ç‰¹å¾å·¥ç¨‹","link":"#ç‰¹å¾å·¥ç¨‹","children":[]},{"level":3,"title":"æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°","slug":"æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°-1","link":"#æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°-1","children":[]},{"level":3,"title":"é¢„æµ‹å¯è§†åŒ–","slug":"é¢„æµ‹å¯è§†åŒ–","link":"#é¢„æµ‹å¯è§†åŒ–","children":[]},{"level":3,"title":"ç‰¹å¾é‡è¦æ€§åˆ†æ","slug":"ç‰¹å¾é‡è¦æ€§åˆ†æ-1","link":"#ç‰¹å¾é‡è¦æ€§åˆ†æ-1","children":[]},{"level":3,"title":"ä¸šåŠ¡å»ºè®®","slug":"ä¸šåŠ¡å»ºè®®-1","link":"#ä¸šåŠ¡å»ºè®®-1","children":[]}]},{"level":2,"title":"å°ç»“ä¸æ€è€ƒ","slug":"å°ç»“ä¸æ€è€ƒ","link":"#å°ç»“ä¸æ€è€ƒ","children":[{"level":3,"title":"å…³é”®è¦ç‚¹å›é¡¾","slug":"å…³é”®è¦ç‚¹å›é¡¾","link":"#å…³é”®è¦ç‚¹å›é¡¾","children":[]},{"level":3,"title":"æ€è€ƒé—®é¢˜","slug":"æ€è€ƒé—®é¢˜","link":"#æ€è€ƒé—®é¢˜","children":[]}]}],"git":{},"filePathRelative":"core/regression/case-studies.md"}');export{d as comp,m as data};
