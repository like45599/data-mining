<template><div><h1 id="åŒ»ç–—æ•°æ®ç¼ºå¤±å€¼å¤„ç†" tabindex="-1"><a class="header-anchor" href="#åŒ»ç–—æ•°æ®ç¼ºå¤±å€¼å¤„ç†"><span>åŒ»ç–—æ•°æ®ç¼ºå¤±å€¼å¤„ç†</span></a></h1>
<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿°
  </div>
  <div class="knowledge-card__content">
    <ul>
      <li><strong>éš¾åº¦</strong>ï¼šä¸­çº§</li>
      <li><strong>ç±»å‹</strong>ï¼šç¼ºå¤±å€¼å¤„ç†</li>
      <!-- <li><strong>é¢„è®¡æ—¶é—´</strong>ï¼š5-7å°æ—¶</li> -->
      <li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šç¼ºå¤±å€¼æ¨¡å¼åˆ†æã€å¤šé‡æ’è¡¥ã€KNNå¡«å……ã€æ¨¡å‹é¢„æµ‹å¡«å……</li>
      <li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/preprocessing/data-presentation.html">æ•°æ®é¢„å¤„ç†</a></li>
    </ul>
  </div>
</div>
<h2 id="é¡¹ç›®èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®èƒŒæ™¯"><span>é¡¹ç›®èƒŒæ™¯</span></a></h2>
<p>åŒ»ç–—æ•°æ®åœ¨ä¸´åºŠç ”ç©¶ã€ç–¾ç—…é¢„æµ‹å’Œæ²»ç–—æ–¹æ¡ˆä¼˜åŒ–ä¸­èµ·ç€å…³é”®ä½œç”¨ã€‚ç„¶è€Œï¼ŒåŒ»ç–—æ•°æ®é›†é€šå¸¸åŒ…å«å¤§é‡ç¼ºå¤±å€¼ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºè®¾å¤‡æ•…éšœã€æ‚£è€…æœªå®Œæˆæ‰€æœ‰æ£€æŸ¥ã€è®°å½•é”™è¯¯æˆ–æ•°æ®è¾“å…¥é—®é¢˜ç­‰åŸå› é€ æˆçš„ã€‚ä¸å½“çš„ç¼ºå¤±å€¼å¤„ç†å¯èƒ½å¯¼è‡´åå·®çš„ç»“è®ºï¼Œå½±å“åŒ»ç–—å†³ç­–çš„å‡†ç¡®æ€§ã€‚</p>
<p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†å¤„ç†ä¸€ä¸ªåŒ…å«å¤šç§ç¼ºå¤±å€¼çš„åŒ»ç–—æ•°æ®é›†ï¼Œæ¯”è¾ƒä¸åŒç¼ºå¤±å€¼å¤„ç†æ–¹æ³•çš„æ•ˆæœï¼Œå¹¶ä¸ºåç»­çš„ç–¾ç—…é¢„æµ‹æ¨¡å‹å‡†å¤‡é«˜è´¨é‡çš„æ•°æ®ã€‚</p>
<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ
  </div>
  <div class="knowledge-card__content">
    <p>åŒ»ç–—æ•°æ®ä¸­çš„ç¼ºå¤±å€¼é€šå¸¸ä¸æ˜¯éšæœºå‘ç”Ÿçš„ã€‚ä¾‹å¦‚ï¼ŒæŸäº›æ£€æŸ¥å¯èƒ½åªå¯¹ç‰¹å®šç—‡çŠ¶çš„æ‚£è€…è¿›è¡Œï¼Œå¯¼è‡´æ•°æ®çš„ç¼ºå¤±ä¸æ‚£è€…çš„å¥åº·çŠ¶å†µç›¸å…³ã€‚è¿™ç§ééšæœºç¼ºå¤±æ¨¡å¼éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä»¥é¿å…å¼•å…¥åå·®ã€‚</p>
  </div>
</div>
<h2 id="æ•°æ®é›†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†ä»‹ç»"><span>æ•°æ®é›†ä»‹ç»</span></a></h2>
<p>æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«5,000åæ‚£è€…çš„åŒ»ç–—è®°å½•ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å­—æ®µï¼š</p>
<ul>
<li><strong>patient_id</strong>ï¼šæ‚£è€…ID</li>
<li><strong>age</strong>ï¼šå¹´é¾„</li>
<li><strong>gender</strong>ï¼šæ€§åˆ«</li>
<li><strong>bmi</strong>ï¼šä½“é‡æŒ‡æ•°</li>
<li><strong>blood_pressure_systolic</strong>ï¼šæ”¶ç¼©å‹</li>
<li><strong>blood_pressure_diastolic</strong>ï¼šèˆ’å¼ å‹</li>
<li><strong>heart_rate</strong>ï¼šå¿ƒç‡</li>
<li><strong>cholesterol</strong>ï¼šèƒ†å›ºé†‡æ°´å¹³</li>
<li><strong>glucose</strong>ï¼šè¡€ç³–æ°´å¹³</li>
<li><strong>smoking</strong>ï¼šå¸çƒŸçŠ¶æ€</li>
<li><strong>alcohol_consumption</strong>ï¼šé…’ç²¾æ¶ˆè´¹æ°´å¹³</li>
<li><strong>physical_activity</strong>ï¼šèº«ä½“æ´»åŠ¨æ°´å¹³</li>
<li><strong>family_history</strong>ï¼šå®¶æ—ç—…å²</li>
<li><strong>medication</strong>ï¼šå½“å‰ç”¨è¯æƒ…å†µ</li>
<li><strong>diagnosis</strong>ï¼šè¯Šæ–­ç»“æœ</li>
</ul>
<p>æ•°æ®é›†ä¸­å­˜åœ¨ä¸åŒç±»å‹å’Œæ¯”ä¾‹çš„ç¼ºå¤±å€¼ï¼Œéœ€è¦é‡‡ç”¨å¤šç§æ–¹æ³•è¿›è¡Œå¤„ç†å’Œæ¯”è¾ƒã€‚</p>
<h2 id="é¡¹ç›®ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®æ ‡"><span>é¡¹ç›®ç›®æ ‡</span></a></h2>
<ol>
<li>åˆ†ææ•°æ®é›†ä¸­ç¼ºå¤±å€¼çš„æ¨¡å¼å’Œç‰¹å¾</li>
<li>å®ç°å¹¶æ¯”è¾ƒå¤šç§ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•</li>
<li>è¯„ä¼°ä¸åŒç¼ºå¤±å€¼å¤„ç†æ–¹æ³•å¯¹åç»­åˆ†æçš„å½±å“</li>
<li>é€‰æ‹©æœ€ä½³çš„ç¼ºå¤±å€¼å¤„ç†ç­–ç•¥</li>
<li>å‡†å¤‡å®Œæ•´çš„æ•°æ®é›†ç”¨äºç–¾ç—…é¢„æµ‹æ¨¡å‹</li>
</ol>
<h2 id="å®æ–½æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®æ–½æ­¥éª¤"><span>å®æ–½æ­¥éª¤</span></a></h2>
<h3 id="æ­¥éª¤1-æ•°æ®åŠ è½½ä¸ç¼ºå¤±å€¼åˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤1-æ•°æ®åŠ è½½ä¸ç¼ºå¤±å€¼åˆ†æ"><span>æ­¥éª¤1ï¼šæ•°æ®åŠ è½½ä¸ç¼ºå¤±å€¼åˆ†æ</span></a></h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åŠ è½½æ•°æ®å¹¶åˆ†æç¼ºå¤±å€¼çš„æ¨¡å¼å’Œç‰¹å¾ã€‚</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">import</span> missingno <span class="token keyword">as</span> msno</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>impute <span class="token keyword">import</span> SimpleImputer<span class="token punctuation">,</span> KNNImputer<span class="token punctuation">,</span> IterativeImputer</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token punctuation">,</span> accuracy_score</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'medical_data.csv'</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†æç¼ºå¤±å€¼</span></span>
<span class="line">missing <span class="token operator">=</span> df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">missing_percent <span class="token operator">=</span> missing <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span></span>
<span class="line">missing_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'missing_count'</span><span class="token punctuation">:</span> missing<span class="token punctuation">,</span> <span class="token string">'missing_percent'</span><span class="token punctuation">:</span> missing_percent<span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">missing_df <span class="token operator">=</span> missing_df<span class="token punctuation">[</span>missing_df<span class="token punctuation">[</span><span class="token string">'missing_count'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'missing_percent'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>missing_df<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–ç¼ºå¤±å€¼æ¨¡å¼</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">msno<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>df<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ç¼ºå¤±å€¼çŸ©é˜µ'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">msno<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ç¼ºå¤±å€¼ç›¸å…³æ€§çƒ­å›¾'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†æç¼ºå¤±å€¼ä¸ç›®æ ‡å˜é‡çš„å…³ç³»</span></span>
<span class="line"><span class="token comment"># åˆ›å»ºç¼ºå¤±æ ‡å¿—åˆ—</span></span>
<span class="line"><span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>col<span class="token punctuation">}</span></span><span class="token string">_missing'</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†æç¼ºå¤±æ ‡å¿—ä¸è¯Šæ–­ç»“æœçš„å…³ç³»</span></span>
<span class="line"><span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token punctuation">[</span>c <span class="token keyword">for</span> c <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns <span class="token keyword">if</span> c<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'_missing'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x<span class="token operator">=</span>col<span class="token punctuation">,</span> hue<span class="token operator">=</span><span class="token string">'diagnosis'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>df<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>col<span class="token punctuation">}</span></span><span class="token string"> vs Diagnosis'</span></span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤2-å‡†å¤‡æ•°æ®ç”¨äºç¼ºå¤±å€¼å¤„ç†æ¯”è¾ƒ" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤2-å‡†å¤‡æ•°æ®ç”¨äºç¼ºå¤±å€¼å¤„ç†æ¯”è¾ƒ"><span>æ­¥éª¤2ï¼šå‡†å¤‡æ•°æ®ç”¨äºç¼ºå¤±å€¼å¤„ç†æ¯”è¾ƒ</span></a></h3>
<p>ä¸ºäº†æ¯”è¾ƒä¸åŒç¼ºå¤±å€¼å¤„ç†æ–¹æ³•çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªå®Œæ•´çš„å­é›†ä½œä¸ºå‚è€ƒã€‚</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># é€‰æ‹©å®Œæ•´è®°å½•çš„å­é›†ä½œä¸ºå‚è€ƒ</span></span>
<span class="line">complete_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">,</span> <span class="token string">'bmi'</span><span class="token punctuation">,</span> <span class="token string">'blood_pressure_systolic'</span><span class="token punctuation">,</span> <span class="token string">'blood_pressure_diastolic'</span><span class="token punctuation">,</span> </span>
<span class="line">                <span class="token string">'heart_rate'</span><span class="token punctuation">,</span> <span class="token string">'cholesterol'</span><span class="token punctuation">,</span> <span class="token string">'glucose'</span><span class="token punctuation">]</span></span>
<span class="line">complete_subset <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span>complete_cols<span class="token punctuation">)</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä»å®Œæ•´å­é›†ä¸­éšæœºå¼•å…¥ç¼ºå¤±å€¼ï¼Œç”¨äºæ–¹æ³•æ¯”è¾ƒ</span></span>
<span class="line">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">df_test <span class="token operator">=</span> complete_subset<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">mask <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token operator">*</span>df_test<span class="token punctuation">[</span>complete_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.2</span>  <span class="token comment"># 20%çš„ç¼ºå¤±ç‡</span></span>
<span class="line">df_test<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> complete_cols<span class="token punctuation">]</span> <span class="token operator">=</span> df_test<span class="token punctuation">[</span>complete_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>mask<span class="token punctuation">(</span>mask<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¿å­˜åŸå§‹å®Œæ•´å€¼ç”¨äºè¯„ä¼°</span></span>
<span class="line">true_values <span class="token operator">=</span> complete_subset<span class="token punctuation">[</span>complete_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤3-å®ç°å¹¶æ¯”è¾ƒä¸åŒçš„ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤3-å®ç°å¹¶æ¯”è¾ƒä¸åŒçš„ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•"><span>æ­¥éª¤3ï¼šå®ç°å¹¶æ¯”è¾ƒä¸åŒçš„ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•</span></a></h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®ç°å¹¶æ¯”è¾ƒå¤šç§ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•ã€‚</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># æ–¹æ³•1ï¼šç®€å•å¡«å……ï¼ˆå‡å€¼/ä¸­ä½æ•°/ä¼—æ•°ï¼‰</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">simple_imputation</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">,</span> categorical_cols<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    df_imputed <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ•°å€¼å‹ç‰¹å¾ä½¿ç”¨ä¸­ä½æ•°å¡«å……</span></span>
<span class="line">    <span class="token keyword">if</span> numeric_cols<span class="token punctuation">:</span></span>
<span class="line">        imputer <span class="token operator">=</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">'median'</span><span class="token punctuation">)</span></span>
<span class="line">        df_imputed<span class="token punctuation">[</span>numeric_cols<span class="token punctuation">]</span> <span class="token operator">=</span> imputer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span>numeric_cols<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># åˆ†ç±»ç‰¹å¾ä½¿ç”¨ä¼—æ•°å¡«å……</span></span>
<span class="line">    <span class="token keyword">if</span> categorical_cols<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">for</span> col <span class="token keyword">in</span> categorical_cols<span class="token punctuation">:</span></span>
<span class="line">            df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> df_imputed</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ–¹æ³•2ï¼šKNNå¡«å……</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">knn_imputation</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> cols<span class="token punctuation">,</span> n_neighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    df_imputed <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ ‡å‡†åŒ–æ•°æ®</span></span>
<span class="line">    scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    df_scaled <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span>cols<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>cols<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># KNNå¡«å……</span></span>
<span class="line">    imputer <span class="token operator">=</span> KNNImputer<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span>n_neighbors<span class="token punctuation">)</span></span>
<span class="line">    df_imputed<span class="token punctuation">[</span>cols<span class="token punctuation">]</span> <span class="token operator">=</span> imputer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df_scaled<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># åæ ‡å‡†åŒ–</span></span>
<span class="line">    df_imputed<span class="token punctuation">[</span>cols<span class="token punctuation">]</span> <span class="token operator">=</span> scaler<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span>df_imputed<span class="token punctuation">[</span>cols<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> df_imputed</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ–¹æ³•3ï¼šå¤šé‡æ’è¡¥ï¼ˆä½¿ç”¨IterativeImputerï¼‰</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">iterative_imputation</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> cols<span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    df_imputed <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># ä½¿ç”¨éšæœºæ£®æ—ä½œä¸ºä¼°è®¡å™¨</span></span>
<span class="line">    estimator <span class="token operator">=</span> RandomForestRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>random_state<span class="token punctuation">)</span></span>
<span class="line">    imputer <span class="token operator">=</span> IterativeImputer<span class="token punctuation">(</span>estimator<span class="token operator">=</span>estimator<span class="token punctuation">,</span> max_iter<span class="token operator">=</span>max_iter<span class="token punctuation">,</span> random_state<span class="token operator">=</span>random_state<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    df_imputed<span class="token punctuation">[</span>cols<span class="token punctuation">]</span> <span class="token operator">=</span> imputer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span>cols<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> df_imputed</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ–¹æ³•4ï¼šåŸºäºåˆ†ç»„çš„å¡«å……</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">group_imputation</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> target_cols<span class="token punctuation">,</span> group_cols<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    df_imputed <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">for</span> col <span class="token keyword">in</span> target_cols<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># å¯¹æ¯ä¸ªåˆ†ç»„è®¡ç®—ä¸­ä½æ•°</span></span>
<span class="line">        group_medians <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>group_cols<span class="token punctuation">)</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">'median'</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># ä½¿ç”¨åˆ†ç»„ä¸­ä½æ•°å¡«å……</span></span>
<span class="line">        df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>group_medians<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># å¦‚æœä»æœ‰ç¼ºå¤±å€¼ï¼ˆå¯èƒ½æ˜¯æ•´ä¸ªç»„éƒ½ç¼ºå¤±ï¼‰ï¼Œä½¿ç”¨å…¨å±€ä¸­ä½æ•°å¡«å……</span></span>
<span class="line">        df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df_imputed<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> df_imputed</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨ä¸åŒçš„å¡«å……æ–¹æ³•</span></span>
<span class="line">numeric_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'bmi'</span><span class="token punctuation">,</span> <span class="token string">'blood_pressure_systolic'</span><span class="token punctuation">,</span> <span class="token string">'blood_pressure_diastolic'</span><span class="token punctuation">,</span> </span>
<span class="line">               <span class="token string">'heart_rate'</span><span class="token punctuation">,</span> <span class="token string">'cholesterol'</span><span class="token punctuation">,</span> <span class="token string">'glucose'</span><span class="token punctuation">]</span></span>
<span class="line">categorical_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">,</span> <span class="token string">'smoking'</span><span class="token punctuation">,</span> <span class="token string">'alcohol_consumption'</span><span class="token punctuation">,</span> <span class="token string">'physical_activity'</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨å„ç§æ–¹æ³•</span></span>
<span class="line">df_simple <span class="token operator">=</span> simple_imputation<span class="token punctuation">(</span>df_test<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">,</span> categorical_cols<span class="token punctuation">)</span></span>
<span class="line">df_knn <span class="token operator">=</span> knn_imputation<span class="token punctuation">(</span>df_test<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line">df_iterative <span class="token operator">=</span> iterative_imputation<span class="token punctuation">(</span>df_test<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line">df_group <span class="token operator">=</span> group_imputation<span class="token punctuation">(</span>df_test<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯„ä¼°ä¸åŒæ–¹æ³•çš„æ€§èƒ½</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">evaluate_imputation</span><span class="token punctuation">(</span>imputed_df<span class="token punctuation">,</span> true_df<span class="token punctuation">,</span> cols<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    results <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">for</span> col <span class="token keyword">in</span> cols<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># åªè€ƒè™‘åŸæœ¬ç¼ºå¤±çš„å€¼</span></span>
<span class="line">        mask <span class="token operator">=</span> imputed_df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> df_test<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> mask<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">            mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>true_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">,</span> imputed_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            results<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> mse</span>
<span class="line">    <span class="token keyword">return</span> results</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è¯„ä¼°å„ç§æ–¹æ³•</span></span>
<span class="line">simple_results <span class="token operator">=</span> evaluate_imputation<span class="token punctuation">(</span>df_simple<span class="token punctuation">,</span> true_values<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line">knn_results <span class="token operator">=</span> evaluate_imputation<span class="token punctuation">(</span>df_knn<span class="token punctuation">,</span> true_values<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line">iterative_results <span class="token operator">=</span> evaluate_imputation<span class="token punctuation">(</span>df_iterative<span class="token punctuation">,</span> true_values<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line">group_results <span class="token operator">=</span> evaluate_imputation<span class="token punctuation">(</span>df_group<span class="token punctuation">,</span> true_values<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¯”è¾ƒç»“æœ</span></span>
<span class="line">results_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">'Simple'</span><span class="token punctuation">:</span> simple_results<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">'KNN'</span><span class="token punctuation">:</span> knn_results<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">'Iterative'</span><span class="token punctuation">:</span> iterative_results<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">'Group'</span><span class="token punctuation">:</span> group_results</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results_df<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–æ¯”è¾ƒ</span></span>
<span class="line">results_df<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ä¸åŒå¡«å……æ–¹æ³•çš„MSEæ¯”è¾ƒ'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'å‡æ–¹è¯¯å·® (MSE)'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤4-é€‰æ‹©æœ€ä½³æ–¹æ³•å¹¶å¤„ç†å®Œæ•´æ•°æ®é›†" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤4-é€‰æ‹©æœ€ä½³æ–¹æ³•å¹¶å¤„ç†å®Œæ•´æ•°æ®é›†"><span>æ­¥éª¤4ï¼šé€‰æ‹©æœ€ä½³æ–¹æ³•å¹¶å¤„ç†å®Œæ•´æ•°æ®é›†</span></a></h3>
<p>æ ¹æ®æ¯”è¾ƒç»“æœï¼Œæˆ‘ä»¬é€‰æ‹©æœ€ä½³çš„ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•ï¼Œå¹¶åº”ç”¨äºå®Œæ•´æ•°æ®é›†ã€‚</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># å‡è®¾è¿­ä»£å¡«å……æ–¹æ³•è¡¨ç°æœ€å¥½</span></span>
<span class="line">best_method <span class="token operator">=</span> <span class="token string">'Iterative'</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"é€‰æ‹© </span><span class="token interpolation"><span class="token punctuation">{</span>best_method<span class="token punctuation">}</span></span><span class="token string"> ä½œä¸ºæœ€ä½³å¡«å……æ–¹æ³•"</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤„ç†å®Œæ•´æ•°æ®é›†</span></span>
<span class="line"><span class="token comment"># é¦–å…ˆå¤„ç†æ•°å€¼å‹ç‰¹å¾</span></span>
<span class="line">df_complete <span class="token operator">=</span> iterative_imputation<span class="token punctuation">(</span>df<span class="token punctuation">,</span> numeric_cols<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç„¶åå¤„ç†åˆ†ç±»ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">for</span> col <span class="token keyword">in</span> categorical_cols<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> df_complete<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">        df_complete<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> df_complete<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df_complete<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥å¤„ç†åçš„ç¼ºå¤±å€¼æƒ…å†µ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å¤„ç†åçš„ç¼ºå¤±å€¼æƒ…å†µ:"</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df_complete<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¿å­˜å¤„ç†åçš„æ•°æ®é›†</span></span>
<span class="line">df_complete<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'medical_data_complete.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤5-è¯„ä¼°ç¼ºå¤±å€¼å¤„ç†å¯¹åç»­åˆ†æçš„å½±å“" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤5-è¯„ä¼°ç¼ºå¤±å€¼å¤„ç†å¯¹åç»­åˆ†æçš„å½±å“"><span>æ­¥éª¤5ï¼šè¯„ä¼°ç¼ºå¤±å€¼å¤„ç†å¯¹åç»­åˆ†æçš„å½±å“</span></a></h3>
<p>æœ€åï¼Œæˆ‘ä»¬è¯„ä¼°ç¼ºå¤±å€¼å¤„ç†å¯¹ç–¾ç—…é¢„æµ‹æ¨¡å‹çš„å½±å“ã€‚</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># å‡†å¤‡ç”¨äºé¢„æµ‹çš„ç‰¹å¾å’Œç›®æ ‡å˜é‡</span></span>
<span class="line">X <span class="token operator">=</span> df_complete<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'patient_id'</span><span class="token punctuation">,</span> <span class="token string">'diagnosis'</span><span class="token punctuation">]</span> <span class="token operator">+</span> </span>
<span class="line">                    <span class="token punctuation">[</span>c <span class="token keyword">for</span> c <span class="token keyword">in</span> df_complete<span class="token punctuation">.</span>columns <span class="token keyword">if</span> c<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'_missing'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">y <span class="token operator">=</span> df_complete<span class="token punctuation">[</span><span class="token string">'diagnosis'</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†åˆ†ç±»ç‰¹å¾è½¬æ¢ä¸ºæ•°å€¼</span></span>
<span class="line">X <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>X<span class="token punctuation">,</span> drop_first<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ†å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®­ç»ƒéšæœºæ£®æ—åˆ†ç±»å™¨</span></span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token punctuation">,</span> confusion_matrix</span>
<span class="line"></span>
<span class="line">clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹å’Œè¯„ä¼°</span></span>
<span class="line">y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åˆ†ç±»æŠ¥å‘Š:"</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–æ··æ·†çŸ©é˜µ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">'d'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'Blues'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'é¢„æµ‹æ ‡ç­¾'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'çœŸå®æ ‡ç­¾'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'æ··æ·†çŸ©é˜µ'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">feature_importance <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">'feature'</span><span class="token punctuation">:</span> X<span class="token punctuation">.</span>columns<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">'importance'</span><span class="token punctuation">:</span> clf<span class="token punctuation">.</span>feature_importances_</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'importance'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'importance'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'feature'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>feature_importance<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ç‰¹å¾é‡è¦æ€§'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç»“æœåˆ†æ" tabindex="-1"><a class="header-anchor" href="#ç»“æœåˆ†æ"><span>ç»“æœåˆ†æ</span></a></h2>
<p>é€šè¿‡æ¯”è¾ƒä¸åŒçš„ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•ï¼Œæˆ‘ä»¬å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p>
<ol>
<li><strong>è¿­ä»£å¡«å……æ–¹æ³•</strong>åœ¨å¤§å¤šæ•°ç‰¹å¾ä¸Šè¡¨ç°æœ€å¥½ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç›¸å…³æ€§é«˜çš„ç‰¹å¾</li>
<li><strong>KNNå¡«å……</strong>åœ¨æŸäº›ç‰¹å¾ä¸Šè¡¨ç°è‰¯å¥½ï¼Œä½†è®¡ç®—æˆæœ¬è¾ƒé«˜</li>
<li><strong>åˆ†ç»„å¡«å……</strong>å¯¹äºä¸åˆ†ç»„å˜é‡å¼ºç›¸å…³çš„ç‰¹å¾æ•ˆæœå¥½</li>
<li><strong>ç®€å•å¡«å……</strong>è™½ç„¶ç®€å•ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ç²¾åº¦è¾ƒä½</li>
</ol>
<p>æœ€ç»ˆé€‰æ‹©çš„è¿­ä»£å¡«å……æ–¹æ³•æˆåŠŸå¤„ç†äº†æ•°æ®é›†ä¸­çš„ç¼ºå¤±å€¼ï¼Œä¸ºåç»­çš„ç–¾ç—…é¢„æµ‹æ¨¡å‹æä¾›äº†é«˜è´¨é‡çš„è¾“å…¥æ•°æ®ã€‚é¢„æµ‹æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šå–å¾—äº†è‰¯å¥½çš„æ€§èƒ½ï¼Œè¡¨æ˜æˆ‘ä»¬çš„ç¼ºå¤±å€¼å¤„ç†ç­–ç•¥æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<h2 id="è¿›é˜¶æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶æŒ‘æˆ˜"><span>è¿›é˜¶æŒ‘æˆ˜</span></a></h2>
<p>å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š</p>
<ol>
<li><strong>ç¼ºå¤±æœºåˆ¶åˆ†æ</strong>ï¼šæ·±å…¥ç ”ç©¶æ•°æ®çš„ç¼ºå¤±æœºåˆ¶ï¼ˆMCARã€MARã€MNARï¼‰</li>
<li><strong>æ•æ„Ÿæ€§åˆ†æ</strong>ï¼šè¯„ä¼°ä¸åŒç¼ºå¤±å€¼å¤„ç†æ–¹æ³•å¯¹æœ€ç»ˆæ¨¡å‹ç»“æœçš„æ•æ„Ÿæ€§</li>
<li><strong>å¤šé‡æ’è¡¥è¿›é˜¶</strong>ï¼šå®ç°å®Œæ•´çš„å¤šé‡æ’è¡¥æµç¨‹ï¼ŒåŒ…æ‹¬åˆ›å»ºå¤šä¸ªå¡«å……æ•°æ®é›†å’Œåˆå¹¶ç»“æœ</li>
<li><strong>è‡ªå®šä¹‰å¡«å……æ¨¡å‹</strong>ï¼šä¸ºç‰¹å®šç‰¹å¾å¼€å‘å®šåˆ¶çš„é¢„æµ‹æ¨¡å‹ç”¨äºå¡«å……</li>
<li><strong>ç¼ºå¤±å€¼æ¨¡æ‹Ÿ</strong>ï¼šè®¾è®¡å®éªŒï¼Œé€šè¿‡åœ¨å®Œæ•´æ•°æ®ä¸Šæ¨¡æ‹Ÿä¸åŒæ¨¡å¼çš„ç¼ºå¤±å€¼ï¼Œè¯„ä¼°å„ç§æ–¹æ³•çš„é²æ£’æ€§</li>
</ol>
<h2 id="å°ç»“ä¸åæ€" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸åæ€"><span>å°ç»“ä¸åæ€</span></a></h2>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å¤„ç†åŒ»ç–—æ•°æ®ä¸­çš„ç¼ºå¤±å€¼ï¼Œå¹¶æ¯”è¾ƒäº†ä¸åŒæ–¹æ³•çš„æ•ˆæœã€‚ç¼ºå¤±å€¼å¤„ç†æ˜¯åŒ»ç–—æ•°æ®åˆ†æä¸­çš„å…³é”®æ­¥éª¤ï¼Œç›´æ¥å½±å“åç»­åˆ†æå’Œé¢„æµ‹çš„å‡†ç¡®æ€§ã€‚</p>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç±»ç¼ºå¤±å€¼å¤„ç†æŠ€æœ¯å¯ä»¥å¸®åŠ©åŒ»ç–—æœºæ„æ›´å¥½åœ°åˆ©ç”¨ä¸å®Œæ•´çš„æ‚£è€…æ•°æ®ï¼Œæé«˜ç–¾ç—…é¢„æµ‹å’Œè¯Šæ–­çš„å‡†ç¡®æ€§ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡é€‚å½“çš„ç¼ºå¤±å€¼å¤„ç†ï¼Œå³ä½¿æŸäº›æ£€æŸ¥ç»“æœç¼ºå¤±ï¼Œä¹Ÿèƒ½ä¸ºæ‚£è€…æä¾›ç›¸å¯¹å‡†ç¡®çš„é£é™©è¯„ä¼°ã€‚</p>
<h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3>
<ol>
<li>åœ¨åŒ»ç–—æ•°æ®ä¸­ï¼Œç¼ºå¤±å€¼æœ¬èº«å¯èƒ½åŒ…å«ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼ŒåŒ»ç”Ÿæ²¡æœ‰è¦æ±‚æŸé¡¹æ£€æŸ¥ï¼‰ã€‚å¦‚ä½•åœ¨å¡«å……ç¼ºå¤±å€¼çš„åŒæ—¶ä¿ç•™è¿™ç§ä¿¡æ¯ï¼Ÿ</li>
<li>ä¸åŒç±»å‹çš„åŒ»ç–—æ•°æ®ï¼ˆå¦‚å®éªŒå®¤æ£€æŸ¥ã€é—®å·è°ƒæŸ¥ã€å½±åƒæ•°æ®ï¼‰å¯èƒ½éœ€è¦ä¸åŒçš„ç¼ºå¤±å€¼å¤„ç†ç­–ç•¥ã€‚å¦‚ä½•ä¸ºä¸åŒç±»å‹çš„æ•°æ®é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Ÿ</li>
<li>åœ¨å¤„ç†æ•æ„Ÿçš„åŒ»ç–—æ•°æ®æ—¶ï¼Œå¦‚ä½•å¹³è¡¡æ•°æ®å®Œæ•´æ€§å’Œéšç§ä¿æŠ¤çš„éœ€æ±‚ï¼Ÿ</li>
</ol>
<div class="practice-link">
  <a href="/projects/classification/titanic.html" class="button">ä¸‹ä¸€ä¸ªæ¨¡å—ï¼šåˆ†ç±»ç®—æ³•é¡¹ç›®</a>
</div> </div></template>


