<template><div><h1 id="é”€å”®é¢é¢„æµ‹" tabindex="-1"><a class="header-anchor" href="#é”€å”®é¢é¢„æµ‹"><span>é”€å”®é¢é¢„æµ‹</span></a></h1>
<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿°
  </div>
  <div class="knowledge-card__content">
    <ul>
      <li><strong>éš¾åº¦</strong>ï¼šä¸­çº§</li>
      <li><strong>ç±»å‹</strong>ï¼šå›å½’ - ä¸­çº§</li>
      <!-- <li><strong>é¢„è®¡æ—¶é—´</strong>ï¼š4-6å°æ—¶</li> -->
      <li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šæ—¶é—´åºåˆ—åˆ†æã€ç‰¹å¾å·¥ç¨‹ã€å›å½’æ¨¡å‹</li>
      <li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/regression/linear-regression.html">å›å½’åˆ†æ</a></li>
    </ul>
  </div>
</div>
<h2 id="é¡¹ç›®èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®èƒŒæ™¯"><span>é¡¹ç›®èƒŒæ™¯</span></a></h2>
<p>é”€å”®é¢é¢„æµ‹æ˜¯ä¼ä¸šè¿è¥ä¸­çš„å…³é”®ä»»åŠ¡ï¼Œå‡†ç¡®çš„é¢„æµ‹å¯ä»¥å¸®åŠ©ä¼ä¸šä¼˜åŒ–åº“å­˜ç®¡ç†ã€äººåŠ›èµ„æºè§„åˆ’å’Œè¥é”€ç­–ç•¥ã€‚é€šè¿‡åˆ†æå†å²é”€å”®æ•°æ®å’Œç›¸å…³å› ç´ ï¼ˆå¦‚ä¿ƒé”€æ´»åŠ¨ã€å­£èŠ‚æ€§ã€ä»·æ ¼å˜åŠ¨ç­‰ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºæ¨¡å‹æ¥é¢„æµ‹æœªæ¥çš„é”€å”®è¡¨ç°ã€‚</p>
<p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é›¶å”®å•†çš„é”€å”®æ•°æ®ï¼Œæ„å»ºä¸€ä¸ªé”€å”®é¢é¢„æµ‹æ¨¡å‹ï¼Œå¸®åŠ©ä¼ä¸šåšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ã€‚</p>
<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ
  </div>
  <div class="knowledge-card__content">
    <p>æ²ƒå°”ç›ç­‰å¤§å‹é›¶å”®å•†æ¯å¤©å¤„ç†æ•°ç™¾ä¸‡ç¬”äº¤æ˜“ï¼Œä»–ä»¬ä½¿ç”¨å…ˆè¿›çš„é¢„æµ‹æ¨¡å‹æ¥ä¼˜åŒ–åº“å­˜å’Œå®šä»·ã€‚æ®ä¼°è®¡ï¼Œå‡†ç¡®çš„é”€å”®é¢„æµ‹æ¯å¹´å¯ä»¥ä¸ºå¤§å‹é›¶å”®å•†èŠ‚çœæ•°ç™¾ä¸‡ç¾å…ƒçš„åº“å­˜æˆæœ¬ï¼Œå¹¶æ˜¾è‘—å‡å°‘äº§å“æµªè´¹ã€‚</p>
  </div>
</div>
<h2 id="æ•°æ®é›†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†ä»‹ç»"><span>æ•°æ®é›†ä»‹ç»</span></a></h2>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªé›¶å”®é”€å”®æ•°æ®é›†ï¼ŒåŒ…å«æŸè¿é”è¶…å¸‚ä¸¤å¹´å†…çš„æ¯æ—¥é”€å”®è®°å½•ã€‚æ•°æ®é›†åŒ…å«ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li>Dateï¼šé”€å”®æ—¥æœŸ</li>
<li>Storeï¼šå•†åº—ID</li>
<li>Itemï¼šå•†å“ID</li>
<li>Salesï¼šé”€å”®æ•°é‡</li>
<li>Priceï¼šå•†å“ä»·æ ¼</li>
<li>Promotionï¼šæ˜¯å¦æœ‰ä¿ƒé”€æ´»åŠ¨ï¼ˆ1è¡¨ç¤ºæœ‰ï¼Œ0è¡¨ç¤ºæ— ï¼‰</li>
<li>Holidayï¼šæ˜¯å¦æ˜¯å‡æ—¥ï¼ˆ1è¡¨ç¤ºæ˜¯ï¼Œ0è¡¨ç¤ºå¦ï¼‰</li>
<li>Temperatureï¼šå½“å¤©æ¸©åº¦</li>
<li>Fuel_Priceï¼šç‡ƒæ²¹ä»·æ ¼</li>
<li>CPIï¼šæ¶ˆè´¹è€…ä»·æ ¼æŒ‡æ•°</li>
<li>Unemploymentï¼šå¤±ä¸šç‡</li>
</ul>
<p>ç›®æ ‡å˜é‡æ˜¯Salesï¼ˆé”€å”®æ•°é‡ï¼‰ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯é¢„æµ‹æœªæ¥ä¸€æ®µæ—¶é—´å†…çš„é”€å”®é‡ã€‚</p>
<h2 id="é¡¹ç›®ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®æ ‡"><span>é¡¹ç›®ç›®æ ‡</span></a></h2>
<ol>
<li>æ„å»ºä¸€ä¸ªèƒ½å¤Ÿå‡†ç¡®é¢„æµ‹é”€å”®é¢çš„å›å½’æ¨¡å‹</li>
<li>è¯†åˆ«å½±å“é”€å”®çš„å…³é”®å› ç´ </li>
<li>åˆ†æå­£èŠ‚æ€§å’Œè¶‹åŠ¿å¯¹é”€å”®çš„å½±å“</li>
<li>è¯„ä¼°ä¸åŒé¢„æµ‹æ–¹æ³•çš„æ€§èƒ½</li>
<li>æä¾›é”€å”®é¢„æµ‹çš„å¯è§†åŒ–å’Œä¸šåŠ¡å»ºè®®</li>
</ol>
<h2 id="å®æ–½æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®æ–½æ­¥éª¤"><span>å®æ–½æ­¥éª¤</span></a></h2>
<h3 id="_1-æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#_1-æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–"><span>1. æ•°æ®æ¢ç´¢ä¸å¯è§†åŒ–</span></a></h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ•°æ®çš„åŸºæœ¬ç‰¹å¾å’Œåˆ†å¸ƒï¼š</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token punctuation">,</span> r2_score<span class="token punctuation">,</span> mean_absolute_error</span>
<span class="line"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> sm</span>
<span class="line"><span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>seasonal <span class="token keyword">import</span> seasonal_decompose</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'retail_sales.csv'</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†æ—¥æœŸåˆ—è½¬æ¢ä¸ºæ—¥æœŸç±»å‹</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥ç¼ºå¤±å€¼</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–é”€å”®è¶‹åŠ¿</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sales_by_date <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>sales_by_date<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sales_by_date<span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'æ¯æ—¥æ€»é”€å”®é‡è¶‹åŠ¿'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æ—¥æœŸ'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹é”€å”®çš„å­£èŠ‚æ€§æ¨¡å¼</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sales_by_month <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>sales_by_month<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sales_by_month<span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'æœˆåº¦å¹³å‡é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æœˆä»½'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'å¹³å‡é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹ä¿ƒé”€æ´»åŠ¨å¯¹é”€å”®çš„å½±å“</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'Promotion'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'Sales'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>df<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ä¿ƒé”€æ´»åŠ¨å¯¹é”€å”®çš„å½±å“'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æ˜¯å¦æœ‰ä¿ƒé”€'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ¸©åº¦å¯¹é”€å”®çš„å½±å“</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Temperature'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'æ¸©åº¦ä¸é”€å”®é‡çš„å…³ç³»'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æ¸©åº¦'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-ç‰¹å¾å·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-ç‰¹å¾å·¥ç¨‹"><span>2. ç‰¹å¾å·¥ç¨‹</span></a></h3>
<p>åˆ›å»ºæœ‰åŠ©äºé¢„æµ‹çš„æ–°ç‰¹å¾ï¼š</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># ä»æ—¥æœŸæå–æ—¶é—´ç‰¹å¾</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'Year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'Month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'Day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>day</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'DayOfWeek'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>dayofweek</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'WeekOfYear'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>isocalendar<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>week</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºå­£èŠ‚ç‰¹å¾</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'Season'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Month'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">else</span> </span>
<span class="line">                                          <span class="token number">2</span> <span class="token keyword">if</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token keyword">else</span> </span>
<span class="line">                                          <span class="token number">3</span> <span class="token keyword">if</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token number">4</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ˜¯å¦å‘¨æœ«ç‰¹å¾</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">'IsWeekend'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'DayOfWeek'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token keyword">if</span> x <span class="token operator">>=</span> <span class="token number">5</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ»åç‰¹å¾ï¼ˆå‰ä¸€å¤©ã€å‰ä¸€å‘¨çš„é”€å”®é‡ï¼‰</span></span>
<span class="line">df_lag <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">df_lag <span class="token operator">=</span> df_lag<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Store'</span><span class="token punctuation">,</span> <span class="token string">'Item'</span><span class="token punctuation">,</span> <span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">df_lag<span class="token punctuation">[</span><span class="token string">'Sales_Lag1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_lag<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Store'</span><span class="token punctuation">,</span> <span class="token string">'Item'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">df_lag<span class="token punctuation">[</span><span class="token string">'Sales_Lag7'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_lag<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Store'</span><span class="token punctuation">,</span> <span class="token string">'Item'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç§»é™¤åŒ…å«NaNçš„è¡Œï¼ˆç”±äºåˆ›å»ºæ»åç‰¹å¾ï¼‰</span></span>
<span class="line">df_lag <span class="token operator">=</span> df_lag<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ–°ç‰¹å¾</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df_lag<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ—¶é—´åºåˆ—åˆ†è§£" tabindex="-1"><a class="header-anchor" href="#_3-æ—¶é—´åºåˆ—åˆ†è§£"><span>3. æ—¶é—´åºåˆ—åˆ†è§£</span></a></h3>
<p>åˆ†æé”€å”®æ•°æ®çš„è¶‹åŠ¿ã€å­£èŠ‚æ€§å’Œæ®‹å·®æˆåˆ†ï¼š</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># é€‰æ‹©ä¸€ä¸ªç‰¹å®šå•†åº—å’Œå•†å“çš„é”€å”®æ•°æ®è¿›è¡Œæ—¶é—´åºåˆ—åˆ†è§£</span></span>
<span class="line">store_item_sales <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Store'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç¡®ä¿ç´¢å¼•æ˜¯ç­‰é—´éš”çš„</span></span>
<span class="line">store_item_sales <span class="token operator">=</span> store_item_sales<span class="token punctuation">.</span>asfreq<span class="token punctuation">(</span><span class="token string">'D'</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ—¶é—´åºåˆ—åˆ†è§£</span></span>
<span class="line">decomposition <span class="token operator">=</span> seasonal_decompose<span class="token punctuation">(</span>store_item_sales<span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">'multiplicative'</span><span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯è§†åŒ–åˆ†è§£ç»“æœ</span></span>
<span class="line">fig<span class="token punctuation">,</span> <span class="token punctuation">(</span>ax1<span class="token punctuation">,</span> ax2<span class="token punctuation">,</span> ax3<span class="token punctuation">,</span> ax4<span class="token punctuation">)</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>observed<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax1<span class="token punctuation">)</span></span>
<span class="line">ax1<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'è§‚æµ‹å€¼'</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>trend<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax2<span class="token punctuation">)</span></span>
<span class="line">ax2<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'è¶‹åŠ¿'</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>seasonal<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax3<span class="token punctuation">)</span></span>
<span class="line">ax3<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'å­£èŠ‚æ€§'</span><span class="token punctuation">)</span></span>
<span class="line">decomposition<span class="token punctuation">.</span>resid<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax4<span class="token punctuation">)</span></span>
<span class="line">ax4<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'æ®‹å·®'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°" tabindex="-1"><a class="header-anchor" href="#_4-æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°"><span>4. æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°</span></a></h3>
<p>æˆ‘ä»¬å°†å°è¯•å¤šç§å›å½’æ¨¡å‹ï¼Œå¹¶æ¯”è¾ƒå®ƒä»¬çš„æ€§èƒ½ï¼š</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># å‡†å¤‡ç‰¹å¾å’Œç›®æ ‡å˜é‡</span></span>
<span class="line">X <span class="token operator">=</span> df_lag<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">,</span> <span class="token string">'Sales'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">y <span class="token operator">=</span> df_lag<span class="token punctuation">[</span><span class="token string">'Sales'</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†åˆ†ç±»å˜é‡è½¬æ¢ä¸ºå“‘å˜é‡</span></span>
<span class="line">X <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>X<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Store'</span><span class="token punctuation">,</span> <span class="token string">'Item'</span><span class="token punctuation">,</span> <span class="token string">'Season'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> drop_first<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰</span></span>
<span class="line">train_size <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">)</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span>train_size<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>train_size<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ç‰¹å¾æ ‡å‡†åŒ–</span></span>
<span class="line">scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X_train_scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span></span>
<span class="line">X_test_scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰è¯„ä¼°å‡½æ•°</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">evaluate_model</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> model_name<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line">    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># é¢„æµ‹</span></span>
<span class="line">    y_train_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span></span>
<span class="line">    y_test_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è®¡ç®—è¯„ä¼°æŒ‡æ ‡</span></span>
<span class="line">    train_rmse <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_train_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    test_rmse <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    train_r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_train_pred<span class="token punctuation">)</span></span>
<span class="line">    test_r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span></span>
<span class="line">    test_mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>model_name<span class="token punctuation">}</span></span><span class="token string">:"</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è®­ç»ƒé›†RMSE: </span><span class="token interpolation"><span class="token punctuation">{</span>train_rmse<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æµ‹è¯•é›†RMSE: </span><span class="token interpolation"><span class="token punctuation">{</span>test_rmse<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è®­ç»ƒé›†RÂ²: </span><span class="token interpolation"><span class="token punctuation">{</span>train_r2<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æµ‹è¯•é›†RÂ²: </span><span class="token interpolation"><span class="token punctuation">{</span>test_r2<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æµ‹è¯•é›†MAE: </span><span class="token interpolation"><span class="token punctuation">{</span>test_mae<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> model<span class="token punctuation">,</span> y_test_pred</span>
<span class="line"></span>
<span class="line"><span class="token comment"># çº¿æ€§å›å½’</span></span>
<span class="line">lr_model<span class="token punctuation">,</span> lr_pred <span class="token operator">=</span> evaluate_model<span class="token punctuation">(</span>LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X_train_scaled<span class="token punctuation">,</span> X_test_scaled<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> <span class="token string">"çº¿æ€§å›å½’æ¨¡å‹"</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># éšæœºæ£®æ—å›å½’</span></span>
<span class="line">rf_model<span class="token punctuation">,</span> rf_pred <span class="token operator">=</span> evaluate_model<span class="token punctuation">(</span>RandomForestRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> max_depth<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">                                  X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> <span class="token string">"éšæœºæ£®æ—å›å½’æ¨¡å‹"</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-ç‰¹å¾é‡è¦æ€§åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_5-ç‰¹å¾é‡è¦æ€§åˆ†æ"><span>5. ç‰¹å¾é‡è¦æ€§åˆ†æ</span></a></h3>
<p>äº†è§£å“ªäº›å› ç´ å¯¹é”€å”®å½±å“æœ€å¤§ï¼š</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># ä½¿ç”¨éšæœºæ£®æ—æ¨¡å‹åˆ†æç‰¹å¾é‡è¦æ€§</span></span>
<span class="line">feature_importance <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">'Feature'</span><span class="token punctuation">:</span> X<span class="token punctuation">.</span>columns<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">'Importance'</span><span class="token punctuation">:</span> rf_model<span class="token punctuation">.</span>feature_importances_</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">feature_importance <span class="token operator">=</span> feature_importance<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'Importance'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºå‰15ä¸ªæœ€é‡è¦çš„ç‰¹å¾</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'Importance'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'Feature'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>feature_importance<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ç‰¹å¾é‡è¦æ€§ï¼ˆå‰15åï¼‰'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-é¢„æµ‹å¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#_6-é¢„æµ‹å¯è§†åŒ–"><span>6. é¢„æµ‹å¯è§†åŒ–</span></a></h3>
<p>å¯è§†åŒ–æ¨¡å‹é¢„æµ‹ç»“æœä¸å®é™…å€¼çš„å¯¹æ¯”ï¼š</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code><span class="line"><span class="token comment"># å¯è§†åŒ–é¢„æµ‹ç»“æœ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>y_test<span class="token punctuation">.</span>values<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'å®é™…é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>rf_pred<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'é¢„æµ‹é”€å”®é‡'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'éšæœºæ£®æ—æ¨¡å‹ï¼šå®é™…é”€å”®é‡ vs é¢„æµ‹é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æ ·æœ¬ç´¢å¼•'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'é”€å”®é‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># é¢„æµ‹è¯¯å·®åˆ†æ</span></span>
<span class="line">errors <span class="token operator">=</span> y_test <span class="token operator">-</span> rf_pred</span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>errors<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'é¢„æµ‹è¯¯å·®åˆ†å¸ƒ'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'é¢„æµ‹è¯¯å·®'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'é¢‘ç‡'</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è¿›é˜¶æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶æŒ‘æˆ˜"><span>è¿›é˜¶æŒ‘æˆ˜</span></a></h2>
<p>å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š</p>
<ol>
<li><strong>é«˜çº§æ—¶é—´åºåˆ—æ¨¡å‹</strong>ï¼šå°è¯•ä½¿ç”¨ARIMAã€SARIMAæˆ–Prophetç­‰ä¸“é—¨çš„æ—¶é—´åºåˆ—æ¨¡å‹</li>
<li><strong>å¤šæ­¥é¢„æµ‹</strong>ï¼šæ„å»ºèƒ½å¤Ÿé¢„æµ‹æœªæ¥å¤šä¸ªæ—¶é—´ç‚¹é”€å”®é‡çš„æ¨¡å‹</li>
<li><strong>é›†æˆé¢„æµ‹</strong>ï¼šç»“åˆå¤šä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœï¼Œæé«˜é¢„æµ‹å‡†ç¡®æ€§</li>
<li><strong>ç‰¹å¾é€‰æ‹©</strong>ï¼šä½¿ç”¨ç‰¹å¾é€‰æ‹©æŠ€æœ¯ï¼Œæ‰¾å‡ºæœ€æœ‰é¢„æµ‹åŠ›çš„ç‰¹å¾å­é›†</li>
<li><strong>äº¤å‰éªŒè¯</strong>ï¼šå®ç°æ—¶é—´åºåˆ—äº¤å‰éªŒè¯ï¼Œè·å¾—æ›´ç¨³å¥çš„æ¨¡å‹è¯„ä¼°</li>
</ol>
<h2 id="å°ç»“ä¸åæ€" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸åæ€"><span>å°ç»“ä¸åæ€</span></a></h2>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ„å»ºé”€å”®é¢é¢„æµ‹æ¨¡å‹ï¼Œä»æ•°æ®æ¢ç´¢åˆ°æ¨¡å‹è¯„ä¼°çš„å®Œæ•´æµç¨‹ã€‚æˆ‘ä»¬å‘ç°ä¿ƒé”€æ´»åŠ¨ã€å­£èŠ‚æ€§å’Œå†å²é”€å”®æ•°æ®å¯¹é¢„æµ‹æœªæ¥é”€å”®æœ‰æ˜¾è‘—å½±å“ã€‚</p>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé”€å”®é¢„æµ‹æ¨¡å‹å¯ä»¥å¸®åŠ©ä¼ä¸šä¼˜åŒ–åº“å­˜ç®¡ç†ï¼Œå‡å°‘åº“å­˜æˆæœ¬å’Œäº§å“æµªè´¹ï¼ŒåŒæ—¶ç¡®ä¿äº§å“ä¾›åº”å……è¶³ï¼Œæ»¡è¶³å®¢æˆ·éœ€æ±‚ã€‚æ­¤å¤–ï¼Œå‡†ç¡®çš„é”€å”®é¢„æµ‹è¿˜å¯ä»¥å¸®åŠ©ä¼ä¸šåˆ¶å®šæ›´æœ‰æ•ˆçš„è¥é”€ç­–ç•¥å’Œä¿ƒé”€è®¡åˆ’ã€‚</p>
<h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3>
<ol>
<li>é™¤äº†æˆ‘ä»¬ä½¿ç”¨çš„ç‰¹å¾å¤–ï¼Œè¿˜æœ‰å“ªäº›å› ç´ å¯èƒ½å½±å“é”€å”®ï¼Ÿå¦‚ä½•è·å–è¿™äº›æ•°æ®ï¼Ÿ</li>
<li>é”€å”®é¢„æµ‹æ¨¡å‹åœ¨å“ªäº›æƒ…å†µä¸‹å¯èƒ½å¤±æ•ˆï¼Ÿå¦‚ä½•åº”å¯¹è¿™äº›æŒ‘æˆ˜ï¼Ÿ</li>
<li>å¦‚ä½•å°†é”€å”®é¢„æµ‹ç»“æœè½¬åŒ–ä¸ºå…·ä½“çš„ä¸šåŠ¡å†³ç­–å’Œè¡ŒåŠ¨ï¼Ÿ</li>
</ol>
<div class="practice-link">
  <a href="/projects/regression/anomaly-detection.html" class="button">ä¸‹ä¸€ä¸ªé¡¹ç›®ï¼šå¼‚å¸¸æ£€æµ‹ä¸é¢„æµ‹</a>
</div> </div></template>


