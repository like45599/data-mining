import { ssrRenderAttrs, ssrRenderStyle } from "vue/server-renderer";
import { useSSRContext } from "vue";
import { _ as _export_sfc } from "../app.DfozzGWd.mjs";
import "@vuepress/shared";
import "vue-router";
import "@vueuse/core";
import "@vue/devtools-api";
const _sfc_main = {};
function _sfc_ssrRender(_ctx, _push, _parent, _attrs) {
  _push(`<div${ssrRenderAttrs(_attrs)}><h1 id="ç”µå•†ç”¨æˆ·æ•°æ®æ¸…æ´—ä¸åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ç”µå•†ç”¨æˆ·æ•°æ®æ¸…æ´—ä¸åˆ†æ"><span>ç”µå•†ç”¨æˆ·æ•°æ®æ¸…æ´—ä¸åˆ†æ</span></a></h1><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿° </div><div class="knowledge-card__content"><ul><li><strong>éš¾åº¦</strong>ï¼šå…¥é—¨çº§</li><li><strong>ç±»å‹</strong>ï¼šæ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†</li><li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šç¼ºå¤±å€¼å¤„ç†ã€å¼‚å¸¸æ£€æµ‹ã€æ•°æ®è½¬æ¢ã€ç‰¹å¾åˆ›å»º</li><li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/preprocessing/data-presentation.html">æ•°æ®é¢„å¤„ç†</a></li></ul></div></div><h2 id="é¡¹ç›®èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®èƒŒæ™¯"><span>é¡¹ç›®èƒŒæ™¯</span></a></h2><p>ç”µå­å•†åŠ¡å¹³å°æ¯å¤©äº§ç”Ÿå¤§é‡ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼ŒåŒ…æ‹¬æµè§ˆã€æœç´¢ã€åŠ å…¥è´­ç‰©è½¦å’Œè´­ä¹°ç­‰æ´»åŠ¨ã€‚è¿™äº›æ•°æ®å¯¹äºäº†è§£ç”¨æˆ·è¡Œä¸ºæ¨¡å¼ã€ä¼˜åŒ–äº§å“æ¨èå’Œæé«˜è½¬åŒ–ç‡è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼ŒåŸå§‹æ•°æ®é€šå¸¸åŒ…å«ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼å’Œä¸ä¸€è‡´çš„æ ¼å¼ï¼Œéœ€è¦è¿›è¡Œæ¸…æ´—å’Œé¢„å¤„ç†æ‰èƒ½ç”¨äºåç»­åˆ†æã€‚</p><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†å¤„ç†ä¸€ä¸ªç”µå•†å¹³å°çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®é›†ï¼Œé€šè¿‡æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ï¼Œä¸ºåç»­çš„ç”¨æˆ·è¡Œä¸ºåˆ†æåšå‡†å¤‡ã€‚</p><div class="knowledge-card"><div class="knowledge-card__title"><span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ </div><div class="knowledge-card__content"><p>æ•°æ®ç§‘å­¦å®¶é€šå¸¸èŠ±è´¹60-70%çš„æ—¶é—´åœ¨æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ä¸Šã€‚é«˜è´¨é‡çš„æ•°æ®é¢„å¤„ç†ä¸ä»…å¯ä»¥æé«˜æ¨¡å‹æ€§èƒ½ï¼Œè¿˜èƒ½å‡å°‘åç»­åˆ†æä¸­çš„é”™è¯¯å’Œåå·®ã€‚</p></div></div><h2 id="æ•°æ®é›†ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†ä»‹ç»"><span>æ•°æ®é›†ä»‹ç»</span></a></h2><p>æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«ä¸€ä¸ªç”µå•†å¹³å°ä¸€å‘¨å†…çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œå…±æœ‰10,000æ¡è®°å½•å’Œä»¥ä¸‹å­—æ®µï¼š</p><ul><li><strong>user_id</strong>ï¼šç”¨æˆ·ID</li><li><strong>session_id</strong>ï¼šä¼šè¯ID</li><li><strong>timestamp</strong>ï¼šæ´»åŠ¨æ—¶é—´æˆ³</li><li><strong>page_url</strong>ï¼šè®¿é—®çš„é¡µé¢URL</li><li><strong>event_type</strong>ï¼šäº‹ä»¶ç±»å‹ï¼ˆviewã€cartã€purchaseï¼‰</li><li><strong>product_id</strong>ï¼šäº§å“ID</li><li><strong>category</strong>ï¼šäº§å“ç±»åˆ«</li><li><strong>price</strong>ï¼šäº§å“ä»·æ ¼</li><li><strong>user_agent</strong>ï¼šç”¨æˆ·æµè§ˆå™¨ä¿¡æ¯</li><li><strong>user_region</strong>ï¼šç”¨æˆ·æ‰€åœ¨åœ°åŒº</li></ul><p>æ•°æ®é›†ä¸­å­˜åœ¨å¤šç§æ•°æ®è´¨é‡é—®é¢˜ï¼ŒåŒ…æ‹¬ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€æ ¼å¼ä¸ä¸€è‡´å’Œé‡å¤è®°å½•ç­‰ã€‚</p><h2 id="é¡¹ç›®ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®æ ‡"><span>é¡¹ç›®ç›®æ ‡</span></a></h2><ol><li>è¯†åˆ«å¹¶å¤„ç†æ•°æ®é›†ä¸­çš„ç¼ºå¤±å€¼</li><li>æ£€æµ‹å¹¶å¤„ç†å¼‚å¸¸å€¼å’Œç¦»ç¾¤ç‚¹</li><li>æ ‡å‡†åŒ–å’Œè½¬æ¢æ•°æ®æ ¼å¼</li><li>åˆ›å»ºæœ‰æ„ä¹‰çš„æ´¾ç”Ÿç‰¹å¾</li><li>å‡†å¤‡å¹²å‡€çš„æ•°æ®é›†ç”¨äºåç»­åˆ†æ</li></ol><h2 id="å®æ–½æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#å®æ–½æ­¥éª¤"><span>å®æ–½æ­¥éª¤</span></a></h2><h3 id="æ­¥éª¤1-æ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤1-æ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢"><span>æ­¥éª¤1ï¼šæ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢</span></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬åŠ è½½æ•°æ®å¹¶è¿›è¡Œåˆæ­¥æ¢ç´¢ï¼Œäº†è§£æ•°æ®çš„åŸºæœ¬æƒ…å†µã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ•°æ®</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;ecommerce_data.csv&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æŸ¥çœ‹å‰å‡ è¡Œæ•°æ®</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥ç¼ºå¤±å€¼</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥é‡å¤è®°å½•</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;é‡å¤è®°å½•æ•°: </span><span class="token interpolation"><span class="token punctuation">{</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="${ssrRenderStyle({ "counter-reset": "line-number 0" })}"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤2-å¤„ç†ç¼ºå¤±å€¼" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤2-å¤„ç†ç¼ºå¤±å€¼"><span>æ­¥éª¤2ï¼šå¤„ç†ç¼ºå¤±å€¼</span></a></h3><p>æ ¹æ®åˆæ­¥æ¢ç´¢ï¼Œæˆ‘ä»¬å‘ç°æ•°æ®é›†ä¸­å­˜åœ¨ç¼ºå¤±å€¼ï¼Œéœ€è¦é‡‡å–é€‚å½“çš„ç­–ç•¥å¤„ç†ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># æ£€æŸ¥æ¯åˆ—çš„ç¼ºå¤±æ¯”ä¾‹</span></span>
<span class="line">missing_percentage <span class="token operator">=</span> df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>missing_percentage<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤„ç†ç¼ºå¤±çš„äº§å“ä»·æ ¼ - ä½¿ç”¨åŒç±»åˆ«äº§å“çš„ä¸­ä½æ•°å¡«å……</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤„ç†ç¼ºå¤±çš„ç”¨æˆ·åœ°åŒº - ä½¿ç”¨ä¼—æ•°å¡«å……</span></span>
<span class="line">most_common_region <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;user_region&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;user_region&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;user_region&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>most_common_region<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤„ç†ç¼ºå¤±çš„äº§å“ç±»åˆ« - ä»product_idæ¨æ–­</span></span>
<span class="line"><span class="token comment"># å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªäº§å“æ˜ å°„å­—å…¸</span></span>
<span class="line">product_category_map <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>  <span class="token comment"># å®é™…é¡¹ç›®ä¸­éœ€è¦æ„å»ºè¿™ä¸ªæ˜ å°„</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> row<span class="token punctuation">:</span> product_category_map<span class="token punctuation">.</span>get<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&#39;product_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </span>
<span class="line">                         <span class="token keyword">if</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">else</span> row<span class="token punctuation">[</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ é™¤ç¼ºå¤±å…³é”®ä¿¡æ¯çš„è®°å½•</span></span>
<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;session_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥å¤„ç†åçš„ç¼ºå¤±å€¼æƒ…å†µ</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="${ssrRenderStyle({ "counter-reset": "line-number 0" })}"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤3-æ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤3-æ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼"><span>æ­¥éª¤3ï¼šæ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼</span></a></h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹å’Œå¤„ç†æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># æ£€æŸ¥ä»·æ ¼çš„åˆ†å¸ƒ</span></span>
<span class="line">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ä»·æ ¼åˆ†å¸ƒ&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä½¿ç”¨IQRæ–¹æ³•æ£€æµ‹ä»·æ ¼å¼‚å¸¸å€¼</span></span>
<span class="line">Q1 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span></span>
<span class="line">Q3 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">)</span></span>
<span class="line">IQR <span class="token operator">=</span> Q3 <span class="token operator">-</span> Q1</span>
<span class="line">lower_bound <span class="token operator">=</span> Q1 <span class="token operator">-</span> <span class="token number">1.5</span> <span class="token operator">*</span> IQR</span>
<span class="line">upper_bound <span class="token operator">=</span> Q3 <span class="token operator">+</span> <span class="token number">1.5</span> <span class="token operator">*</span> IQR</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ‡è®°å¼‚å¸¸å€¼</span></span>
<span class="line">price_outliers <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> lower_bound<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> upper_bound<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ä»·æ ¼å¼‚å¸¸å€¼æ•°é‡: </span><span class="token interpolation"><span class="token punctuation">{</span>price_outliers<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤„ç†ä»·æ ¼å¼‚å¸¸å€¼ - å°†æç«¯å€¼é™åˆ¶åœ¨åˆç†èŒƒå›´å†…</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;price_cleaned&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clip<span class="token punctuation">(</span>lower_bound<span class="token punctuation">,</span> upper_bound<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥æ—¶é—´æˆ³çš„æœ‰æ•ˆæ€§</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;coerce&#39;</span><span class="token punctuation">)</span></span>
<span class="line">invalid_timestamps <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ— æ•ˆæ—¶é—´æˆ³æ•°é‡: </span><span class="token interpolation"><span class="token punctuation">{</span>invalid_timestamps<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ é™¤æ— æ•ˆæ—¶é—´æˆ³çš„è®°å½•</span></span>
<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥äº‹ä»¶ç±»å‹çš„æœ‰æ•ˆæ€§</span></span>
<span class="line">valid_event_types <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;cart&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;purchase&#39;</span><span class="token punctuation">]</span></span>
<span class="line">invalid_events <span class="token operator">=</span> <span class="token operator">~</span>df<span class="token punctuation">[</span><span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>valid_event_types<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ— æ•ˆäº‹ä»¶ç±»å‹æ•°é‡: </span><span class="token interpolation"><span class="token punctuation">{</span>invalid_events<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¿®æ­£äº‹ä»¶ç±»å‹ - å‡è®¾æˆ‘ä»¬æœ‰ä¸€äº›è§„åˆ™æ¥ä¿®æ­£</span></span>
<span class="line">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;add_to_cart&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;cart&#39;</span></span>
<span class="line">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;buy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;purchase&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="${ssrRenderStyle({ "counter-reset": "line-number 0" })}"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤4-æ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤4-æ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢"><span>æ­¥éª¤4ï¼šæ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢</span></a></h3><p>ä¸ºäº†ä¾¿äºåç»­åˆ†æï¼Œæˆ‘ä»¬éœ€è¦æ ‡å‡†åŒ–æ•°æ®æ ¼å¼ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># æ ‡å‡†åŒ–æ—¶é—´æˆ³æ ¼å¼</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>date</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;hour&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>hour</span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;day_of_week&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>day_name<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä»URLä¸­æå–é¡µé¢ç±»å‹</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">extract_page_type</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token string">&#39;product&#39;</span> <span class="token keyword">in</span> url<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;product_page&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token string">&#39;category&#39;</span> <span class="token keyword">in</span> url<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;category_page&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token string">&#39;search&#39;</span> <span class="token keyword">in</span> url<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;search_page&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token string">&#39;cart&#39;</span> <span class="token keyword">in</span> url<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;cart_page&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token string">&#39;checkout&#39;</span> <span class="token keyword">in</span> url<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;checkout_page&#39;</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;other&#39;</span></span>
<span class="line"></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;page_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;page_url&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>extract_page_type<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ ‡å‡†åŒ–äº§å“ç±»åˆ«</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;category&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä»user_agentæå–è®¾å¤‡ç±»å‹</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">extract_device_type</span><span class="token punctuation">(</span>user_agent<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>user_agent<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;unknown&#39;</span></span>
<span class="line">    user_agent <span class="token operator">=</span> user_agent<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token string">&#39;mobile&#39;</span> <span class="token keyword">in</span> user_agent <span class="token keyword">or</span> <span class="token string">&#39;android&#39;</span> <span class="token keyword">in</span> user_agent <span class="token keyword">or</span> <span class="token string">&#39;iphone&#39;</span> <span class="token keyword">in</span> user_agent<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;mobile&#39;</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token string">&#39;tablet&#39;</span> <span class="token keyword">in</span> user_agent <span class="token keyword">or</span> <span class="token string">&#39;ipad&#39;</span> <span class="token keyword">in</span> user_agent<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;tablet&#39;</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;desktop&#39;</span></span>
<span class="line"></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;device_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;user_agent&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>extract_device_type<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="${ssrRenderStyle({ "counter-reset": "line-number 0" })}"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤5-åˆ›å»ºæ´¾ç”Ÿç‰¹å¾" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤5-åˆ›å»ºæ´¾ç”Ÿç‰¹å¾"><span>æ­¥éª¤5ï¼šåˆ›å»ºæ´¾ç”Ÿç‰¹å¾</span></a></h3><p>ä¸ºäº†å¢å¼ºæ•°æ®çš„åˆ†æä»·å€¼ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€äº›æ´¾ç”Ÿç‰¹å¾ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è®¡ç®—ä¼šè¯æŒç»­æ—¶é—´</span></span>
<span class="line">session_start <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">session_end <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">session_duration <span class="token operator">=</span> <span class="token punctuation">(</span>session_end <span class="token operator">-</span> session_start<span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span>  <span class="token comment"># è½¬æ¢ä¸ºåˆ†é’Ÿ</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å°†ä¼šè¯æŒç»­æ—¶é—´æ·»åŠ åˆ°åŸå§‹æ•°æ®æ¡†</span></span>
<span class="line">session_duration_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;session_duration&#39;</span><span class="token punctuation">:</span> session_duration<span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">session_duration_df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span> session_duration_df<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—ç”¨æˆ·åœ¨æ¯ä¸ªä¼šè¯ä¸­çš„æ´»åŠ¨æ•°é‡</span></span>
<span class="line">activity_count <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unstack<span class="token punctuation">(</span>fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">activity_count<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>col<span class="token punctuation">}</span></span><span class="token string">_count&#39;</span></span> <span class="token keyword">for</span> col <span class="token keyword">in</span> activity_count<span class="token punctuation">.</span>columns<span class="token punctuation">]</span></span>
<span class="line">activity_count<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span> activity_count<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºè´­ä¹°æ ‡å¿—</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;has_purchase&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;purchase&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡ç®—ä»·æ ¼åŒºé—´</span></span>
<span class="line">price_bins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">&#39;inf&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">price_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;very_low&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;low&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;medium&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;high&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;very_high&#39;</span><span class="token punctuation">]</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&#39;price_range&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;price_cleaned&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span>price_bins<span class="token punctuation">,</span> labels<span class="token operator">=</span>price_labels<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="${ssrRenderStyle({ "counter-reset": "line-number 0" })}"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤6-æ•°æ®éªŒè¯ä¸å¯¼å‡º" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤6-æ•°æ®éªŒè¯ä¸å¯¼å‡º"><span>æ­¥éª¤6ï¼šæ•°æ®éªŒè¯ä¸å¯¼å‡º</span></a></h3><p>æœ€åï¼Œæˆ‘ä»¬éªŒè¯æ¸…æ´—åçš„æ•°æ®å¹¶å¯¼å‡ºç”¨äºåç»­åˆ†æã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># æ£€æŸ¥æ•°æ®è´¨é‡</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æ¸…æ´—åçš„æ•°æ®å½¢çŠ¶:&quot;</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>shape<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ç¼ºå¤±å€¼æƒ…å†µ:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;äº‹ä»¶ç±»å‹åˆ†å¸ƒ:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;event_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è®¾å¤‡ç±»å‹åˆ†å¸ƒ:&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;device_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯¼å‡ºæ¸…æ´—åçš„æ•°æ®</span></span>
<span class="line">df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&#39;ecommerce_data_cleaned.csv&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºæ±‡æ€»æ•°æ®ç”¨äºåˆ†æ</span></span>
<span class="line">session_summary <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;session_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;user_id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;date&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;device_type&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;view_count&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;cart_count&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;purchase_count&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;session_duration&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;has_purchase&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;first&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">session_summary<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&#39;session_summary.csv&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="${ssrRenderStyle({ "counter-reset": "line-number 0" })}"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç»“æœåˆ†æ" tabindex="-1"><a class="header-anchor" href="#ç»“æœåˆ†æ"><span>ç»“æœåˆ†æ</span></a></h2><p>é€šè¿‡æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ï¼Œæˆ‘ä»¬è§£å†³äº†ä»¥ä¸‹æ•°æ®è´¨é‡é—®é¢˜ï¼š</p><ol><li><strong>ç¼ºå¤±å€¼å¤„ç†</strong>ï¼šå¡«å……äº†ç¼ºå¤±çš„ä»·æ ¼ã€ç”¨æˆ·åœ°åŒºå’Œäº§å“ç±»åˆ«ï¼Œåˆ é™¤äº†ç¼ºå¤±å…³é”®ä¿¡æ¯çš„è®°å½•</li><li><strong>å¼‚å¸¸å€¼å¤„ç†</strong>ï¼šè¯†åˆ«å¹¶å¤„ç†äº†ä»·æ ¼å¼‚å¸¸å€¼ï¼Œä¿®æ­£äº†æ— æ•ˆçš„æ—¶é—´æˆ³å’Œäº‹ä»¶ç±»å‹</li><li><strong>æ•°æ®æ ‡å‡†åŒ–</strong>ï¼šç»Ÿä¸€äº†æ—¶é—´æ ¼å¼ï¼Œæ ‡å‡†åŒ–äº†äº§å“ç±»åˆ«ï¼Œæå–äº†é¡µé¢ç±»å‹å’Œè®¾å¤‡ç±»å‹</li><li><strong>ç‰¹å¾åˆ›å»º</strong>ï¼šåˆ›å»ºäº†ä¼šè¯æŒç»­æ—¶é—´ã€æ´»åŠ¨è®¡æ•°ã€è´­ä¹°æ ‡å¿—å’Œä»·æ ¼åŒºé—´ç­‰æ´¾ç”Ÿç‰¹å¾</li></ol><p>æ¸…æ´—åçš„æ•°æ®é›†æ›´åŠ å®Œæ•´ã€ä¸€è‡´å’Œæœ‰ç»“æ„ï¼Œä¸ºåç»­çš„ç”¨æˆ·è¡Œä¸ºåˆ†ææä¾›äº†åšå®çš„åŸºç¡€ã€‚</p><h2 id="è¿›é˜¶æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶æŒ‘æˆ˜"><span>è¿›é˜¶æŒ‘æˆ˜</span></a></h2><p>å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š</p><ol><li><strong>é«˜çº§ç¼ºå¤±å€¼å¡«å……</strong>ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹é¢„æµ‹ç¼ºå¤±å€¼</li><li><strong>ç”¨æˆ·è¡Œä¸ºåºåˆ—åˆ†æ</strong>ï¼šåˆ†æç”¨æˆ·åœ¨ä¸€ä¸ªä¼šè¯ä¸­çš„è¡Œä¸ºåºåˆ—å’Œè½¬åŒ–è·¯å¾„</li><li><strong>å¼‚å¸¸æ£€æµ‹ç®—æ³•</strong>ï¼šåº”ç”¨éš”ç¦»æ£®æ—ç­‰ç®—æ³•è‡ªåŠ¨æ£€æµ‹å¤šç»´å¼‚å¸¸</li><li><strong>ç‰¹å¾é‡è¦æ€§åˆ†æ</strong>ï¼šè¯„ä¼°ä¸åŒç‰¹å¾å¯¹è´­ä¹°è¡Œä¸ºçš„é¢„æµ‹èƒ½åŠ›</li><li><strong>æ•°æ®å¯è§†åŒ–</strong>ï¼šåˆ›å»ºäº¤äº’å¼ä»ªè¡¨æ¿å±•ç¤ºæ¸…æ´—åçš„æ•°æ®æ´å¯Ÿ</li></ol><h2 id="å°ç»“ä¸åæ€" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸åæ€"><span>å°ç»“ä¸åæ€</span></a></h2><p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å¤„ç†ç”µå•†ç”¨æˆ·æ•°æ®ä¸­å¸¸è§çš„æ•°æ®è´¨é‡é—®é¢˜ï¼Œå¹¶ä¸ºåç»­åˆ†æåšå¥½å‡†å¤‡ã€‚æ•°æ®é¢„å¤„ç†æ˜¯æ•°æ®åˆ†æå’ŒæŒ–æ˜çš„åŸºç¡€ï¼Œè‰¯å¥½çš„æ•°æ®è´¨é‡å¯¹äºå¾—å‡ºå¯é çš„ç»“è®ºè‡³å…³é‡è¦ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç±»æ•°æ®æ¸…æ´—å·¥ä½œå¯ä»¥å¸®åŠ©ç”µå•†å¹³å°æ›´å¥½åœ°ç†è§£ç”¨æˆ·è¡Œä¸ºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œæé«˜è½¬åŒ–ç‡å’Œé”€å”®é¢ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åˆ†æä¸åŒè®¾å¤‡ç±»å‹çš„è½¬åŒ–ç‡å·®å¼‚ï¼Œå¯ä»¥é’ˆå¯¹æ€§åœ°ä¼˜åŒ–ç§»åŠ¨ç«¯æˆ–æ¡Œé¢ç«¯çš„ç”¨æˆ·ç•Œé¢ã€‚</p><h3 id="æ€è€ƒé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé—®é¢˜"><span>æ€è€ƒé—®é¢˜</span></a></h3><ol><li>åœ¨å¤„ç†ç¼ºå¤±å€¼æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘å“ªäº›å› ç´ æ¥é€‰æ‹©åˆé€‚çš„å¡«å……ç­–ç•¥ï¼Ÿ</li><li>å¼‚å¸¸å€¼æ˜¯å¦æ€»æ˜¯åº”è¯¥è¢«ç§»é™¤æˆ–ä¿®æ­£ï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¼‚å¸¸å€¼å¯èƒ½åŒ…å«æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Ÿ</li><li>å¦‚ä½•è¯„ä¼°æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†çš„æ•ˆæœï¼Ÿæœ‰å“ªäº›æŒ‡æ ‡å¯ä»¥è¡¡é‡æ•°æ®è´¨é‡çš„æå‡ï¼Ÿ</li></ol><div class="practice-link"><a href="/projects/preprocessing/medical-missing-values.html" class="button">ä¸‹ä¸€ä¸ªé¡¹ç›®ï¼šåŒ»ç–—æ•°æ®ç¼ºå¤±å€¼å¤„ç†</a></div></div>`);
}
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add(".vuepress/.temp/pages/projects/preprocessing/ecommerce-data.html.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};
const ecommerceData_html = /* @__PURE__ */ _export_sfc(_sfc_main, [["ssrRender", _sfc_ssrRender], ["__file", "ecommerce-data.html.vue"]]);
const data = JSON.parse('{"path":"/projects/preprocessing/ecommerce-data.html","title":"ç”µå•†ç”¨æˆ·æ•°æ®æ¸…æ´—ä¸åˆ†æ","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"é¡¹ç›®èƒŒæ™¯","slug":"é¡¹ç›®èƒŒæ™¯","link":"#é¡¹ç›®èƒŒæ™¯","children":[]},{"level":2,"title":"æ•°æ®é›†ä»‹ç»","slug":"æ•°æ®é›†ä»‹ç»","link":"#æ•°æ®é›†ä»‹ç»","children":[]},{"level":2,"title":"é¡¹ç›®ç›®æ ‡","slug":"é¡¹ç›®ç›®æ ‡","link":"#é¡¹ç›®ç›®æ ‡","children":[]},{"level":2,"title":"å®æ–½æ­¥éª¤","slug":"å®æ–½æ­¥éª¤","link":"#å®æ–½æ­¥éª¤","children":[{"level":3,"title":"æ­¥éª¤1ï¼šæ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢","slug":"æ­¥éª¤1-æ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢","link":"#æ­¥éª¤1-æ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢","children":[]},{"level":3,"title":"æ­¥éª¤2ï¼šå¤„ç†ç¼ºå¤±å€¼","slug":"æ­¥éª¤2-å¤„ç†ç¼ºå¤±å€¼","link":"#æ­¥éª¤2-å¤„ç†ç¼ºå¤±å€¼","children":[]},{"level":3,"title":"æ­¥éª¤3ï¼šæ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼","slug":"æ­¥éª¤3-æ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼","link":"#æ­¥éª¤3-æ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼","children":[]},{"level":3,"title":"æ­¥éª¤4ï¼šæ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢","slug":"æ­¥éª¤4-æ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢","link":"#æ­¥éª¤4-æ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢","children":[]},{"level":3,"title":"æ­¥éª¤5ï¼šåˆ›å»ºæ´¾ç”Ÿç‰¹å¾","slug":"æ­¥éª¤5-åˆ›å»ºæ´¾ç”Ÿç‰¹å¾","link":"#æ­¥éª¤5-åˆ›å»ºæ´¾ç”Ÿç‰¹å¾","children":[]},{"level":3,"title":"æ­¥éª¤6ï¼šæ•°æ®éªŒè¯ä¸å¯¼å‡º","slug":"æ­¥éª¤6-æ•°æ®éªŒè¯ä¸å¯¼å‡º","link":"#æ­¥éª¤6-æ•°æ®éªŒè¯ä¸å¯¼å‡º","children":[]}]},{"level":2,"title":"ç»“æœåˆ†æ","slug":"ç»“æœåˆ†æ","link":"#ç»“æœåˆ†æ","children":[]},{"level":2,"title":"è¿›é˜¶æŒ‘æˆ˜","slug":"è¿›é˜¶æŒ‘æˆ˜","link":"#è¿›é˜¶æŒ‘æˆ˜","children":[]},{"level":2,"title":"å°ç»“ä¸åæ€","slug":"å°ç»“ä¸åæ€","link":"#å°ç»“ä¸åæ€","children":[{"level":3,"title":"æ€è€ƒé—®é¢˜","slug":"æ€è€ƒé—®é¢˜","link":"#æ€è€ƒé—®é¢˜","children":[]}]}],"git":{"updatedTime":1742460681000,"contributors":[{"name":"like45599","username":"like45599","email":"131803211+like45599@users.noreply.github.com","commits":1,"url":"https://github.com/like45599"}],"changelog":[{"hash":"61a31e55d1325755fa12a32e909ee09c3ac0a20f","time":1742460681000,"email":"131803211+like45599@users.noreply.github.com","author":"Yun Feng","message":"æ•°æ®æŒ–æ˜æŒ‡å—v1.0"}]},"filePathRelative":"projects/preprocessing/ecommerce-data.md"}');
export {
  ecommerceData_html as comp,
  data
};
