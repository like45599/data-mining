# å›å½’æ¨¡å‹é€‰æ‹©

<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ“š</span>æœ¬èŠ‚è¦ç‚¹
  </div>
  <div class="knowledge-card__content">
    <ul>
      <li>ç†è§£ä¸åŒå›å½’æ¨¡å‹çš„é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§</li>
      <li>æŒæ¡æ¨¡å‹é€‰æ‹©çš„æ–¹æ³•å’Œç­–ç•¥</li>
      <li>å­¦ä¹ å¦‚ä½•ä½¿ç”¨äº¤å‰éªŒè¯å’Œç½‘æ ¼æœç´¢ä¼˜åŒ–æ¨¡å‹</li>
      <li>äº†è§£æ¨¡å‹é›†æˆå’Œå †å æŠ€æœ¯æé«˜é¢„æµ‹æ€§èƒ½</li>
    </ul>
  </div>
</div>

## å›å½’æ¨¡å‹æ¯”è¾ƒ

ä¸åŒçš„å›å½’æ¨¡å‹æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯å¸¸è§å›å½’æ¨¡å‹çš„æ¯”è¾ƒï¼š

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>æ¨¡å‹</th>
        <th>ä¼˜ç‚¹</th>
        <th>ç¼ºç‚¹</th>
        <th>é€‚ç”¨åœºæ™¯</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>çº¿æ€§å›å½’</td>
        <td>
          - ç®€å•æ˜“è§£é‡Š<br>
          - è®­ç»ƒé€Ÿåº¦å¿«<br>
          - ä½æ–¹å·®
        </td>
        <td>
          - å‡è®¾çº¿æ€§å…³ç³»<br>
          - å¯¹å¼‚å¸¸å€¼æ•æ„Ÿ<br>
          - æ— æ³•æ•æ‰éçº¿æ€§å…³ç³»
        </td>
        <td>
          - ç‰¹å¾ä¸ç›®æ ‡å˜é‡å‘ˆçº¿æ€§å…³ç³»<br>
          - éœ€è¦å¯è§£é‡Šæ€§<br>
          - æ•°æ®é‡è¾ƒå°
        </td>
      </tr>
      <tr>
        <td>å†³ç­–æ ‘å›å½’</td>
        <td>
          - å¯æ•æ‰éçº¿æ€§å…³ç³»<br>
          - æ— éœ€ç‰¹å¾ç¼©æ”¾<br>
          - å¯å¤„ç†åˆ†ç±»ç‰¹å¾
        </td>
        <td>
          - å®¹æ˜“è¿‡æ‹Ÿåˆ<br>
          - ä¸ç¨³å®š<br>
          - é¢„æµ‹ä¸è¿ç»­
        </td>
        <td>
          - ç‰¹å¾ä¸ç›®æ ‡å˜é‡å‘ˆéçº¿æ€§å…³ç³»<br>
          - å­˜åœ¨ç‰¹å¾äº¤äº’<br>
          - éœ€è¦å¯è§£é‡Šæ€§
        </td>
      </tr>
      <tr>
        <td>éšæœºæ£®æ—å›å½’</td>
        <td>
          - å‡å°‘è¿‡æ‹Ÿåˆ<br>
          - æä¾›ç‰¹å¾é‡è¦æ€§<br>
          - é²æ£’æ€§å¼º
        </td>
        <td>
          - è®¡ç®—å¤æ‚åº¦é«˜<br>
          - å¯è§£é‡Šæ€§é™ä½<br>
          - è¶…å‚æ•°å¤š
        </td>
        <td>
          - ç‰¹å¾ä¸ç›®æ ‡å˜é‡å…³ç³»å¤æ‚<br>
          - æ•°æ®å™ªå£°è¾ƒå¤§<br>
          - éœ€è¦ç¨³å®šæ€§
        </td>
      </tr>
      <tr>
        <td>æ¢¯åº¦æå‡å›å½’</td>
        <td>
          - é«˜é¢„æµ‹ç²¾åº¦<br>
          - å¯å¤„ç†ä¸åŒç±»å‹ç‰¹å¾<br>
          - æä¾›ç‰¹å¾é‡è¦æ€§
        </td>
        <td>
          - è®¡ç®—å¤æ‚åº¦é«˜<br>
          - å®¹æ˜“è¿‡æ‹Ÿåˆ<br>
          - å‚æ•°è°ƒä¼˜å¤æ‚
        </td>
        <td>
          - éœ€è¦é«˜é¢„æµ‹ç²¾åº¦<br>
          - æœ‰è¶³å¤Ÿè®¡ç®—èµ„æº<br>
          - æ•°æ®ç»“æ„å¤æ‚
        </td>
      </tr>
      <tr>
        <td>æ”¯æŒå‘é‡å›å½’</td>
        <td>
          - å¤„ç†éçº¿æ€§å…³ç³»<br>
          - å¯¹å¼‚å¸¸å€¼é²æ£’<br>
          - æ³›åŒ–èƒ½åŠ›å¼º
        </td>
        <td>
          - è®¡ç®—å¤æ‚åº¦é«˜<br>
          - å‚æ•°æ•æ„Ÿ<br>
          - ä¸é€‚åˆå¤§æ•°æ®é›†
        </td>
        <td>
          - ä¸­å°å‹æ•°æ®é›†<br>
          - å­˜åœ¨å¼‚å¸¸å€¼<br>
          - éœ€è¦é«˜æ³›åŒ–èƒ½åŠ›
        </td>
      </tr>
      <tr>
        <td>ç¥ç»ç½‘ç»œå›å½’</td>
        <td>
          - å¤„ç†å¤æ‚éçº¿æ€§å…³ç³»<br>
          - è‡ªåŠ¨ç‰¹å¾æå–<br>
          - é€‚åº”å¤§æ•°æ®é›†
        </td>
        <td>
          - è®¡ç®—èµ„æºéœ€æ±‚é«˜<br>
          - å¯è§£é‡Šæ€§å·®<br>
          - éœ€è¦å¤§é‡æ•°æ®
        </td>
        <td>
          - å¤æ‚éçº¿æ€§å…³ç³»<br>
          - å¤§å‹æ•°æ®é›†<br>
          - ä¸éœ€è¦é«˜å¯è§£é‡Šæ€§
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ
  </div>
  <div class="knowledge-card__content">
    <p>æ²¡æœ‰ä¸€ç§å›å½’æ¨¡å‹åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½è¡¨ç°æœ€ä½³ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„"æ²¡æœ‰å…è´¹çš„åˆé¤"å®šç†ã€‚æ¨¡å‹é€‰æ‹©åº”è¯¥åŸºäºæ•°æ®ç‰¹æ€§ã€é—®é¢˜éœ€æ±‚å’Œè®¡ç®—èµ„æºç­‰å› ç´ ç»¼åˆè€ƒè™‘ã€‚</p>
  </div>
</div>

## æ¨¡å‹é€‰æ‹©ç­–ç•¥

é€‰æ‹©åˆé€‚çš„å›å½’æ¨¡å‹é€šå¸¸éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. **ç†è§£é—®é¢˜**ï¼šæ˜ç¡®é¢„æµ‹ç›®æ ‡å’Œè¯„ä¼°æŒ‡æ ‡
2. **æ¢ç´¢æ•°æ®**ï¼šåˆ†æç‰¹å¾ä¸ç›®æ ‡å˜é‡çš„å…³ç³»
3. **ç‰¹å¾å·¥ç¨‹**ï¼šåˆ›å»ºã€è½¬æ¢å’Œé€‰æ‹©ç‰¹å¾
4. **åŸºå‡†æ¨¡å‹**ï¼šå»ºç«‹ç®€å•æ¨¡å‹ä½œä¸ºåŸºå‡†
5. **æ¨¡å‹æ¯”è¾ƒ**ï¼šå°è¯•ä¸åŒç±»å‹çš„æ¨¡å‹
6. **è¶…å‚æ•°è°ƒä¼˜**ï¼šä¼˜åŒ–é€‰å®šæ¨¡å‹çš„å‚æ•°
7. **æ¨¡å‹éªŒè¯**ï¼šä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°æ¨¡å‹æ€§èƒ½
8. **æ¨¡å‹é›†æˆ**ï¼šç»„åˆå¤šä¸ªæ¨¡å‹æé«˜æ€§èƒ½

<div class="visualization-container">
  <div class="visualization-title">å›å½’æ¨¡å‹é€‰æ‹©æµç¨‹</div>
  <div class="visualization-content">
    <img src="/images/regression_model_selection.png" alt="å›å½’æ¨¡å‹é€‰æ‹©æµç¨‹">
  </div>
  <div class="visualization-caption">
    å›¾1: å›å½’æ¨¡å‹é€‰æ‹©æµç¨‹ã€‚ä»æ•°æ®åˆ†æå¼€å§‹ï¼Œç»è¿‡æ¨¡å‹è¯„ä¼°å’Œä¼˜åŒ–ï¼Œæœ€ç»ˆé€‰æ‹©æœ€ä½³æ¨¡å‹ã€‚
  </div>
</div>

## ä½¿ç”¨äº¤å‰éªŒè¯é€‰æ‹©æ¨¡å‹

äº¤å‰éªŒè¯æ˜¯æ¯”è¾ƒä¸åŒæ¨¡å‹æ€§èƒ½çš„å¯é æ–¹æ³•ã€‚

<div class="code-example">
  <div class="code-example__title">ä»£ç ç¤ºä¾‹</div>
  <div class="code-example__content">

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import cross_val_score, KFold
from sklearn.linear_model import LinearRegression, Ridge, Lasso
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor
from sklearn.svm import SVR
from sklearn.neural_network import MLPRegressor
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline

# åŠ è½½æ•°æ®
# X, y = load_your_data()

# åˆ›å»ºæ¨¡å‹
models = {
    'Linear Regression': LinearRegression(),
    'Ridge': Ridge(),
    'Lasso': Lasso(),
    'Decision Tree': DecisionTreeRegressor(random_state=42),
    'Random Forest': RandomForestRegressor(random_state=42),
    'Gradient Boosting': GradientBoostingRegressor(random_state=42),
    'SVR': SVR(),
    'Neural Network': MLPRegressor(random_state=42)
}

# åˆ›å»ºç®¡é“
pipelines = {}
for name, model in models.items():
    if name in ['SVR', 'Ridge', 'Lasso', 'Neural Network']:
        pipelines[name] = Pipeline([
            ('scaler', StandardScaler()),
            ('model', model)
        ])
    else:
        pipelines[name] = Pipeline([
            ('model', model)
        ])

# è®¾ç½®äº¤å‰éªŒè¯
kf = KFold(n_splits=5, shuffle=True, random_state=42)

# è¯„ä¼°æ¨¡å‹
results = {}
for name, pipeline in pipelines.items():
    # è®¡ç®—è´ŸMSEï¼ˆsklearnä½¿ç”¨è´Ÿåˆ†æ•°è¡¨ç¤ºéœ€è¦æœ€å°åŒ–çš„æŒ‡æ ‡ï¼‰
    mse_scores = -cross_val_score(pipeline, X, y, cv=kf, scoring='neg_mean_squared_error')
    r2_scores = cross_val_score(pipeline, X, y, cv=kf, scoring='r2')
    
    results[name] = {
        'MSE': {
            'mean': mse_scores.mean(),
            'std': mse_scores.std()
        },
        'RÂ²': {
            'mean': r2_scores.mean(),
            'std': r2_scores.std()
        }
    }

# æ˜¾ç¤ºç»“æœ
for name, metrics in results.items():
    print(f"{name}:")
    print(f"  MSE: {metrics['MSE']['mean']:.4f} Â± {metrics['MSE']['std']:.4f}")
    print(f"  RÂ²: {metrics['RÂ²']['mean']:.4f} Â± {metrics['RÂ²']['std']:.4f}")

# å¯è§†åŒ–æ¯”è¾ƒ
plt.figure(figsize=(12, 6))
names = list(results.keys())
mse_means = [results[name]['MSE']['mean'] for name in names]
mse_stds = [results[name]['MSE']['std'] for name in names]

plt.barh(names, mse_means, xerr=mse_stds, alpha=0.7)
plt.xlabel('MSE')
plt.title('ä¸åŒå›å½’æ¨¡å‹çš„MSEæ¯”è¾ƒ')
plt.grid(axis='x')
plt.tight_layout()
plt.show()
```

  </div>
</div>

## è¶…å‚æ•°ä¼˜åŒ–

ä½¿ç”¨ç½‘æ ¼æœç´¢æˆ–éšæœºæœç´¢ä¼˜åŒ–æ¨¡å‹è¶…å‚æ•°ã€‚

<div class="code-example">
  <div class="code-example__title">ä»£ç ç¤ºä¾‹</div>
  <div class="code-example__content">

```python
from sklearn.model_selection import GridSearchCV

# å‡è®¾æˆ‘ä»¬é€‰æ‹©äº†éšæœºæ£®æ—ä½œä¸ºæœ€ä½³æ¨¡å‹
best_model = RandomForestRegressor(random_state=42)

# å®šä¹‰å‚æ•°ç½‘æ ¼
param_grid = {
    'n_estimators': [50, 100, 200],
    'max_depth': [None, 10, 20, 30],
    'min_samples_split': [2, 5, 10],
    'min_samples_leaf': [1, 2, 4]
}

# åˆ›å»ºç½‘æ ¼æœç´¢
grid_search = GridSearchCV(
    best_model,
    param_grid,
    cv=5,
    scoring='neg_mean_squared_error',
    n_jobs=-1
)

# è®­ç»ƒ
grid_search.fit(X, y)

# æœ€ä½³å‚æ•°
print("æœ€ä½³å‚æ•°:")
print(grid_search.best_params_)

# æœ€ä½³æ€§èƒ½
print(f"æœ€ä½³MSE: {-grid_search.best_score_:.4f}")

# ä½¿ç”¨æœ€ä½³å‚æ•°åˆ›å»ºæ¨¡å‹
best_rf = RandomForestRegressor(
    n_estimators=grid_search.best_params_['n_estimators'],
    max_depth=grid_search.best_params_['max_depth'],
    min_samples_split=grid_search.best_params_['min_samples_split'],
    min_samples_leaf=grid_search.best_params_['min_samples_leaf'],
    random_state=42
)
```

  </div>
</div>

## æ¨¡å‹é›†æˆ

ç»„åˆå¤šä¸ªæ¨¡å‹å¯ä»¥æé«˜é¢„æµ‹æ€§èƒ½ã€‚

### æŠ•ç¥¨å›å½’

<div class="code-example">
  <div class="code-example__title">ä»£ç ç¤ºä¾‹</div>
  <div class="code-example__content">

```python
from sklearn.ensemble import VotingRegressor

# é€‰æ‹©è¡¨ç°æœ€å¥½çš„å‡ ä¸ªæ¨¡å‹
estimators = [
    ('rf', RandomForestRegressor(n_estimators=100, random_state=42)),
    ('gbr', GradientBoostingRegressor(n_estimators=100, random_state=42)),
    ('svr', SVR(kernel='rbf', C=10))
]

# åˆ›å»ºæŠ•ç¥¨å›å½’å™¨
voting_reg = VotingRegressor(estimators=estimators)

# è¯„ä¼°
scores = cross_val_score(voting_reg, X, y, cv=5, scoring='neg_mean_squared_error')
print(f"æŠ•ç¥¨å›å½’MSE: {-scores.mean():.4f} Â± {scores.std():.4f}")
```

  </div>
</div>

### å †å å›å½’

<div class="code-example">
  <div class="code-example__title">ä»£ç ç¤ºä¾‹</div>
  <div class="code-example__content">

```python
from sklearn.ensemble import StackingRegressor

# å®šä¹‰åŸºç¡€æ¨¡å‹
base_models = [
    ('rf', RandomForestRegressor(n_estimators=100, random_state=42)),
    ('gbr', GradientBoostingRegressor(n_estimators=100, random_state=42)),
    ('svr', Pipeline([
        ('scaler', StandardScaler()),
        ('svr', SVR(kernel='rbf', C=10))
    ]))
]

# å®šä¹‰å…ƒæ¨¡å‹
meta_model = Ridge()

# åˆ›å»ºå †å å›å½’å™¨
stacking_reg = StackingRegressor(
    estimators=base_models,
    final_estimator=meta_model,
    cv=5
)

# è¯„ä¼°
scores = cross_val_score(stacking_reg, X, y, cv=5, scoring='neg_mean_squared_error')
print(f"å †å å›å½’MSE: {-scores.mean():.4f} Â± {scores.std():.4f}")
```

  </div>
</div>

## ç‰¹å¾é‡è¦æ€§åˆ†æ

äº†è§£ç‰¹å¾å¯¹æ¨¡å‹é¢„æµ‹çš„å½±å“å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€‰æ‹©æ›´åˆé€‚çš„æ¨¡å‹ã€‚

<div class="code-example">
  <div class="code-example__title">ä»£ç ç¤ºä¾‹</div>
  <div class="code-example__content">

```python
# è®­ç»ƒéšæœºæ£®æ—æ¨¡å‹
rf = RandomForestRegressor(n_estimators=100, random_state=42)
rf.fit(X, y)

# è·å–ç‰¹å¾é‡è¦æ€§
importances = rf.feature_importances_
indices = np.argsort(importances)[::-1]

# å¯è§†åŒ–ç‰¹å¾é‡è¦æ€§
plt.figure(figsize=(12, 6))
plt.title('ç‰¹å¾é‡è¦æ€§')
plt.bar(range(X.shape[1]), importances[indices], align='center')
plt.xticks(range(X.shape[1]), [f'ç‰¹å¾ {i}' for i in indices], rotation=90)
plt.tight_layout()
plt.show()
```

  </div>
</div>

## æ¨¡å‹è§£é‡Šæ€§

åœ¨æŸäº›åº”ç”¨ä¸­ï¼Œæ¨¡å‹çš„å¯è§£é‡Šæ€§ä¸é¢„æµ‹æ€§èƒ½åŒæ ·é‡è¦ã€‚

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>æ¨¡å‹</th>
        <th>è§£é‡Šæ€§</th>
        <th>è§£é‡Šæ–¹æ³•</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>çº¿æ€§å›å½’</td>
        <td>é«˜</td>
        <td>ç³»æ•°å¤§å°å’Œç¬¦å·</td>
      </tr>
      <tr>
        <td>å†³ç­–æ ‘</td>
        <td>ä¸­é«˜</td>
        <td>æ ‘ç»“æ„å’Œå†³ç­–è·¯å¾„</td>
      </tr>
      <tr>
        <td>éšæœºæ£®æ—</td>
        <td>ä¸­</td>
        <td>ç‰¹å¾é‡è¦æ€§</td>
      </tr>
      <tr>
        <td>æ¢¯åº¦æå‡æ ‘</td>
        <td>ä¸­</td>
        <td>ç‰¹å¾é‡è¦æ€§ã€éƒ¨åˆ†ä¾èµ–å›¾</td>
      </tr>
      <tr>
        <td>æ”¯æŒå‘é‡å›å½’</td>
        <td>ä½</td>
        <td>SHAPå€¼ã€æ’åˆ—é‡è¦æ€§</td>
      </tr>
      <tr>
        <td>ç¥ç»ç½‘ç»œ</td>
        <td>å¾ˆä½</td>
        <td>SHAPå€¼ã€æ’åˆ—é‡è¦æ€§</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">âš ï¸</span>å¸¸è§è¯¯åŒº
  </div>
  <div class="knowledge-card__content">
    <ul>
      <li><strong>è¿‡åº¦è¿½æ±‚å¤æ‚æ¨¡å‹</strong>ï¼šç®€å•æ¨¡å‹å¯èƒ½æ›´ç¨³å®šä¸”æ˜“äºç»´æŠ¤</li>
      <li><strong>å¿½ç•¥é¢†åŸŸçŸ¥è¯†</strong>ï¼šé¢†åŸŸçŸ¥è¯†å¯ä»¥æŒ‡å¯¼ç‰¹å¾å·¥ç¨‹å’Œæ¨¡å‹é€‰æ‹©</li>
      <li><strong>è¿‡åº¦ä¾èµ–å•ä¸€è¯„ä¼°æŒ‡æ ‡</strong>ï¼šåº”è€ƒè™‘å¤šç§æŒ‡æ ‡å’Œä¸šåŠ¡éœ€æ±‚</li>
      <li><strong>å¿½ç•¥è®¡ç®—æˆæœ¬</strong>ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹æ—¶é—´ä¹Ÿå¾ˆé‡è¦</li>
    </ul>
  </div>
</div>

## å°ç»“ä¸æ€è€ƒ

é€‰æ‹©åˆé€‚çš„å›å½’æ¨¡å‹æ˜¯æ•°æ®ç§‘å­¦å·¥ä½œæµç¨‹ä¸­çš„å…³é”®æ­¥éª¤ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘å¤šç§å› ç´ ã€‚

### å…³é”®è¦ç‚¹å›é¡¾

- ä¸åŒå›å½’æ¨¡å‹æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯
- äº¤å‰éªŒè¯æ˜¯æ¯”è¾ƒæ¨¡å‹æ€§èƒ½çš„å¯é æ–¹æ³•
- è¶…å‚æ•°è°ƒä¼˜å¯ä»¥æ˜¾è‘—æé«˜æ¨¡å‹æ€§èƒ½
- æ¨¡å‹é›†æˆé€šå¸¸æ¯”å•ä¸ªæ¨¡å‹è¡¨ç°æ›´å¥½
- æ¨¡å‹é€‰æ‹©åº”å¹³è¡¡é¢„æµ‹æ€§èƒ½ã€è§£é‡Šæ€§å’Œè®¡ç®—æˆæœ¬

### æ€è€ƒé—®é¢˜

1. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥é€‰æ‹©ç®€å•æ¨¡å‹è€Œéå¤æ‚æ¨¡å‹ï¼Ÿ
2. å¦‚ä½•å¹³è¡¡æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½å’Œè§£é‡Šæ€§ï¼Ÿ
3. æ¨¡å‹é›†æˆä¸ºä»€ä¹ˆé€šå¸¸èƒ½æé«˜é¢„æµ‹æ€§èƒ½ï¼Ÿ

<div class="practice-link">
  <a href="/projects/regression.html" class="button">å‰å¾€å®è·µé¡¹ç›®</a>
</div> 