# ç”µå•†ç”¨æˆ·æ•°æ®æ¸…æ´—ä¸åˆ†æ

<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ“š</span>é¡¹ç›®æ¦‚è¿°
  </div>
  <div class="knowledge-card__content">
    <ul>
      <li><strong>éš¾åº¦</strong>ï¼šå…¥é—¨çº§</li>
      <li><strong>ç±»å‹</strong>ï¼šæ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†</li>
      <!-- <li><strong>é¢„è®¡æ—¶é—´</strong>ï¼š3-5å°æ—¶</li> -->
      <li><strong>æŠ€èƒ½ç‚¹</strong>ï¼šç¼ºå¤±å€¼å¤„ç†ã€å¼‚å¸¸æ£€æµ‹ã€æ•°æ®è½¬æ¢ã€ç‰¹å¾åˆ›å»º</li>
      <li><strong>å¯¹åº”çŸ¥è¯†æ¨¡å—</strong>ï¼š<a href="/core/preprocessing/data-presentation.html">æ•°æ®é¢„å¤„ç†</a></li>
    </ul>
  </div>
</div>

## é¡¹ç›®èƒŒæ™¯

ç”µå­å•†åŠ¡å¹³å°æ¯å¤©äº§ç”Ÿå¤§é‡ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼ŒåŒ…æ‹¬æµè§ˆã€æœç´¢ã€åŠ å…¥è´­ç‰©è½¦å’Œè´­ä¹°ç­‰æ´»åŠ¨ã€‚è¿™äº›æ•°æ®å¯¹äºäº†è§£ç”¨æˆ·è¡Œä¸ºæ¨¡å¼ã€ä¼˜åŒ–äº§å“æ¨èå’Œæé«˜è½¬åŒ–ç‡è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼ŒåŸå§‹æ•°æ®é€šå¸¸åŒ…å«ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼å’Œä¸ä¸€è‡´çš„æ ¼å¼ï¼Œéœ€è¦è¿›è¡Œæ¸…æ´—å’Œé¢„å¤„ç†æ‰èƒ½ç”¨äºåç»­åˆ†æã€‚

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†å¤„ç†ä¸€ä¸ªç”µå•†å¹³å°çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®é›†ï¼Œé€šè¿‡æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ï¼Œä¸ºåç»­çš„ç”¨æˆ·è¡Œä¸ºåˆ†æåšå‡†å¤‡ã€‚

<div class="knowledge-card">
  <div class="knowledge-card__title">
    <span class="icon">ğŸ’¡</span>ä½ çŸ¥é“å—ï¼Ÿ
  </div>
  <div class="knowledge-card__content">
    <p>æ•°æ®ç§‘å­¦å®¶é€šå¸¸èŠ±è´¹60-70%çš„æ—¶é—´åœ¨æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ä¸Šã€‚é«˜è´¨é‡çš„æ•°æ®é¢„å¤„ç†ä¸ä»…å¯ä»¥æé«˜æ¨¡å‹æ€§èƒ½ï¼Œè¿˜èƒ½å‡å°‘åç»­åˆ†æä¸­çš„é”™è¯¯å’Œåå·®ã€‚</p>
  </div>
</div>

## æ•°æ®é›†ä»‹ç»

æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«ä¸€ä¸ªç”µå•†å¹³å°ä¸€å‘¨å†…çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œå…±æœ‰10,000æ¡è®°å½•å’Œä»¥ä¸‹å­—æ®µï¼š

- **user_id**ï¼šç”¨æˆ·ID
- **session_id**ï¼šä¼šè¯ID
- **timestamp**ï¼šæ´»åŠ¨æ—¶é—´æˆ³
- **page_url**ï¼šè®¿é—®çš„é¡µé¢URL
- **event_type**ï¼šäº‹ä»¶ç±»å‹ï¼ˆviewã€cartã€purchaseï¼‰
- **product_id**ï¼šäº§å“ID
- **category**ï¼šäº§å“ç±»åˆ«
- **price**ï¼šäº§å“ä»·æ ¼
- **user_agent**ï¼šç”¨æˆ·æµè§ˆå™¨ä¿¡æ¯
- **user_region**ï¼šç”¨æˆ·æ‰€åœ¨åœ°åŒº

æ•°æ®é›†ä¸­å­˜åœ¨å¤šç§æ•°æ®è´¨é‡é—®é¢˜ï¼ŒåŒ…æ‹¬ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€æ ¼å¼ä¸ä¸€è‡´å’Œé‡å¤è®°å½•ç­‰ã€‚

## é¡¹ç›®ç›®æ ‡

1. è¯†åˆ«å¹¶å¤„ç†æ•°æ®é›†ä¸­çš„ç¼ºå¤±å€¼
2. æ£€æµ‹å¹¶å¤„ç†å¼‚å¸¸å€¼å’Œç¦»ç¾¤ç‚¹
3. æ ‡å‡†åŒ–å’Œè½¬æ¢æ•°æ®æ ¼å¼
4. åˆ›å»ºæœ‰æ„ä¹‰çš„æ´¾ç”Ÿç‰¹å¾
5. å‡†å¤‡å¹²å‡€çš„æ•°æ®é›†ç”¨äºåç»­åˆ†æ

## å®æ–½æ­¥éª¤

### æ­¥éª¤1ï¼šæ•°æ®åŠ è½½ä¸åˆæ­¥æ¢ç´¢

é¦–å…ˆï¼Œæˆ‘ä»¬åŠ è½½æ•°æ®å¹¶è¿›è¡Œåˆæ­¥æ¢ç´¢ï¼Œäº†è§£æ•°æ®çš„åŸºæœ¬æƒ…å†µã€‚

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# åŠ è½½æ•°æ®
df = pd.read_csv('ecommerce_data.csv')

# æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯
print(df.info())
print(df.describe())

# æŸ¥çœ‹å‰å‡ è¡Œæ•°æ®
print(df.head())

# æ£€æŸ¥ç¼ºå¤±å€¼
print(df.isnull().sum())

# æ£€æŸ¥é‡å¤è®°å½•
print(f"é‡å¤è®°å½•æ•°: {df.duplicated().sum()}")
```

### æ­¥éª¤2ï¼šå¤„ç†ç¼ºå¤±å€¼

æ ¹æ®åˆæ­¥æ¢ç´¢ï¼Œæˆ‘ä»¬å‘ç°æ•°æ®é›†ä¸­å­˜åœ¨ç¼ºå¤±å€¼ï¼Œéœ€è¦é‡‡å–é€‚å½“çš„ç­–ç•¥å¤„ç†ã€‚

```python
# æ£€æŸ¥æ¯åˆ—çš„ç¼ºå¤±æ¯”ä¾‹
missing_percentage = df.isnull().mean() * 100
print(missing_percentage)

# å¤„ç†ç¼ºå¤±çš„äº§å“ä»·æ ¼ - ä½¿ç”¨åŒç±»åˆ«äº§å“çš„ä¸­ä½æ•°å¡«å……
df['price'] = df.groupby('category')['price'].transform(lambda x: x.fillna(x.median()))

# å¤„ç†ç¼ºå¤±çš„ç”¨æˆ·åœ°åŒº - ä½¿ç”¨ä¼—æ•°å¡«å……
most_common_region = df['user_region'].mode()[0]
df['user_region'] = df['user_region'].fillna(most_common_region)

# å¤„ç†ç¼ºå¤±çš„äº§å“ç±»åˆ« - ä»product_idæ¨æ–­
# å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªäº§å“æ˜ å°„å­—å…¸
product_category_map = {...}  # å®é™…é¡¹ç›®ä¸­éœ€è¦æ„å»ºè¿™ä¸ªæ˜ å°„
df['category'] = df.apply(lambda row: product_category_map.get(row['product_id'], row['category']) 
                         if pd.isnull(row['category']) else row['category'], axis=1)

# åˆ é™¤ç¼ºå¤±å…³é”®ä¿¡æ¯çš„è®°å½•
df = df.dropna(subset=['user_id', 'session_id', 'timestamp', 'event_type'])

# æ£€æŸ¥å¤„ç†åçš„ç¼ºå¤±å€¼æƒ…å†µ
print(df.isnull().sum())
```

### æ­¥éª¤3ï¼šæ£€æµ‹å’Œå¤„ç†å¼‚å¸¸å€¼

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹å’Œå¤„ç†æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼ã€‚

```python
# æ£€æŸ¥ä»·æ ¼çš„åˆ†å¸ƒ
plt.figure(figsize=(10, 6))
sns.boxplot(x=df['price'])
plt.title('ä»·æ ¼åˆ†å¸ƒ')
plt.show()

# ä½¿ç”¨IQRæ–¹æ³•æ£€æµ‹ä»·æ ¼å¼‚å¸¸å€¼
Q1 = df['price'].quantile(0.25)
Q3 = df['price'].quantile(0.75)
IQR = Q3 - Q1
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# æ ‡è®°å¼‚å¸¸å€¼
price_outliers = ((df['price'] < lower_bound) | (df['price'] > upper_bound))
print(f"ä»·æ ¼å¼‚å¸¸å€¼æ•°é‡: {price_outliers.sum()}")

# å¤„ç†ä»·æ ¼å¼‚å¸¸å€¼ - å°†æç«¯å€¼é™åˆ¶åœ¨åˆç†èŒƒå›´å†…
df['price_cleaned'] = df['price'].clip(lower_bound, upper_bound)

# æ£€æŸ¥æ—¶é—´æˆ³çš„æœ‰æ•ˆæ€§
df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
invalid_timestamps = df['timestamp'].isnull()
print(f"æ— æ•ˆæ—¶é—´æˆ³æ•°é‡: {invalid_timestamps.sum()}")

# åˆ é™¤æ— æ•ˆæ—¶é—´æˆ³çš„è®°å½•
df = df.dropna(subset=['timestamp'])

# æ£€æŸ¥äº‹ä»¶ç±»å‹çš„æœ‰æ•ˆæ€§
valid_event_types = ['view', 'cart', 'purchase']
invalid_events = ~df['event_type'].isin(valid_event_types)
print(f"æ— æ•ˆäº‹ä»¶ç±»å‹æ•°é‡: {invalid_events.sum()}")

# ä¿®æ­£äº‹ä»¶ç±»å‹ - å‡è®¾æˆ‘ä»¬æœ‰ä¸€äº›è§„åˆ™æ¥ä¿®æ­£
df.loc[df['event_type'] == 'add_to_cart', 'event_type'] = 'cart'
df.loc[df['event_type'] == 'buy', 'event_type'] = 'purchase'
```

### æ­¥éª¤4ï¼šæ•°æ®æ ‡å‡†åŒ–å’Œæ ¼å¼è½¬æ¢

ä¸ºäº†ä¾¿äºåç»­åˆ†æï¼Œæˆ‘ä»¬éœ€è¦æ ‡å‡†åŒ–æ•°æ®æ ¼å¼ã€‚

```python
# æ ‡å‡†åŒ–æ—¶é—´æˆ³æ ¼å¼
df['date'] = df['timestamp'].dt.date
df['hour'] = df['timestamp'].dt.hour
df['day_of_week'] = df['timestamp'].dt.day_name()

# ä»URLä¸­æå–é¡µé¢ç±»å‹
def extract_page_type(url):
    if 'product' in url:
        return 'product_page'
    elif 'category' in url:
        return 'category_page'
    elif 'search' in url:
        return 'search_page'
    elif 'cart' in url:
        return 'cart_page'
    elif 'checkout' in url:
        return 'checkout_page'
    else:
        return 'other'

df['page_type'] = df['page_url'].apply(extract_page_type)

# æ ‡å‡†åŒ–äº§å“ç±»åˆ«
df['category'] = df['category'].str.lower().str.strip()

# ä»user_agentæå–è®¾å¤‡ç±»å‹
def extract_device_type(user_agent):
    if pd.isnull(user_agent):
        return 'unknown'
    user_agent = user_agent.lower()
    if 'mobile' in user_agent or 'android' in user_agent or 'iphone' in user_agent:
        return 'mobile'
    elif 'tablet' in user_agent or 'ipad' in user_agent:
        return 'tablet'
    else:
        return 'desktop'

df['device_type'] = df['user_agent'].apply(extract_device_type)
```

### æ­¥éª¤5ï¼šåˆ›å»ºæ´¾ç”Ÿç‰¹å¾

ä¸ºäº†å¢å¼ºæ•°æ®çš„åˆ†æä»·å€¼ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€äº›æ´¾ç”Ÿç‰¹å¾ã€‚

```python
# è®¡ç®—ä¼šè¯æŒç»­æ—¶é—´
session_start = df.groupby('session_id')['timestamp'].min()
session_end = df.groupby('session_id')['timestamp'].max()
session_duration = (session_end - session_start).dt.total_seconds() / 60  # è½¬æ¢ä¸ºåˆ†é’Ÿ

# å°†ä¼šè¯æŒç»­æ—¶é—´æ·»åŠ åˆ°åŸå§‹æ•°æ®æ¡†
session_duration_df = pd.DataFrame({'session_duration': session_duration})
session_duration_df.reset_index(inplace=True)
df = pd.merge(df, session_duration_df, on='session_id', how='left')

# è®¡ç®—ç”¨æˆ·åœ¨æ¯ä¸ªä¼šè¯ä¸­çš„æ´»åŠ¨æ•°é‡
activity_count = df.groupby(['session_id', 'event_type']).size().unstack(fill_value=0)
activity_count.columns = [f'{col}_count' for col in activity_count.columns]
activity_count.reset_index(inplace=True)
df = pd.merge(df, activity_count, on='session_id', how='left')

# åˆ›å»ºè´­ä¹°æ ‡å¿—
df['has_purchase'] = df['session_id'].isin(df[df['event_type'] == 'purchase']['session_id'])

# è®¡ç®—ä»·æ ¼åŒºé—´
price_bins = [0, 10, 50, 100, 500, float('inf')]
price_labels = ['very_low', 'low', 'medium', 'high', 'very_high']
df['price_range'] = pd.cut(df['price_cleaned'], bins=price_bins, labels=price_labels)
```

### æ­¥éª¤6ï¼šæ•°æ®éªŒè¯ä¸å¯¼å‡º

æœ€åï¼Œæˆ‘ä»¬éªŒè¯æ¸…æ´—åçš„æ•°æ®å¹¶å¯¼å‡ºç”¨äºåç»­åˆ†æã€‚

```python
# æ£€æŸ¥æ•°æ®è´¨é‡
print("æ¸…æ´—åçš„æ•°æ®å½¢çŠ¶:", df.shape)
print("ç¼ºå¤±å€¼æƒ…å†µ:")
print(df.isnull().sum())

# æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§
print("äº‹ä»¶ç±»å‹åˆ†å¸ƒ:")
print(df['event_type'].value_counts())
print("è®¾å¤‡ç±»å‹åˆ†å¸ƒ:")
print(df['device_type'].value_counts())

# å¯¼å‡ºæ¸…æ´—åçš„æ•°æ®
df.to_csv('ecommerce_data_cleaned.csv', index=False)

# åˆ›å»ºæ±‡æ€»æ•°æ®ç”¨äºåˆ†æ
session_summary = df.groupby('session_id').agg({
    'user_id': 'first',
    'date': 'first',
    'device_type': 'first',
    'view_count': 'first',
    'cart_count': 'first',
    'purchase_count': 'first',
    'session_duration': 'first',
    'has_purchase': 'first'
})

session_summary.to_csv('session_summary.csv', index=True)
```

## ç»“æœåˆ†æ

é€šè¿‡æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ï¼Œæˆ‘ä»¬è§£å†³äº†ä»¥ä¸‹æ•°æ®è´¨é‡é—®é¢˜ï¼š

1. **ç¼ºå¤±å€¼å¤„ç†**ï¼šå¡«å……äº†ç¼ºå¤±çš„ä»·æ ¼ã€ç”¨æˆ·åœ°åŒºå’Œäº§å“ç±»åˆ«ï¼Œåˆ é™¤äº†ç¼ºå¤±å…³é”®ä¿¡æ¯çš„è®°å½•
2. **å¼‚å¸¸å€¼å¤„ç†**ï¼šè¯†åˆ«å¹¶å¤„ç†äº†ä»·æ ¼å¼‚å¸¸å€¼ï¼Œä¿®æ­£äº†æ— æ•ˆçš„æ—¶é—´æˆ³å’Œäº‹ä»¶ç±»å‹
3. **æ•°æ®æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€äº†æ—¶é—´æ ¼å¼ï¼Œæ ‡å‡†åŒ–äº†äº§å“ç±»åˆ«ï¼Œæå–äº†é¡µé¢ç±»å‹å’Œè®¾å¤‡ç±»å‹
4. **ç‰¹å¾åˆ›å»º**ï¼šåˆ›å»ºäº†ä¼šè¯æŒç»­æ—¶é—´ã€æ´»åŠ¨è®¡æ•°ã€è´­ä¹°æ ‡å¿—å’Œä»·æ ¼åŒºé—´ç­‰æ´¾ç”Ÿç‰¹å¾

æ¸…æ´—åçš„æ•°æ®é›†æ›´åŠ å®Œæ•´ã€ä¸€è‡´å’Œæœ‰ç»“æ„ï¼Œä¸ºåç»­çš„ç”¨æˆ·è¡Œä¸ºåˆ†ææä¾›äº†åšå®çš„åŸºç¡€ã€‚

## è¿›é˜¶æŒ‘æˆ˜

å¦‚æœä½ å·²ç»å®Œæˆäº†åŸºæœ¬ä»»åŠ¡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹è¿›é˜¶æŒ‘æˆ˜ï¼š

1. **é«˜çº§ç¼ºå¤±å€¼å¡«å……**ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹é¢„æµ‹ç¼ºå¤±å€¼
2. **ç”¨æˆ·è¡Œä¸ºåºåˆ—åˆ†æ**ï¼šåˆ†æç”¨æˆ·åœ¨ä¸€ä¸ªä¼šè¯ä¸­çš„è¡Œä¸ºåºåˆ—å’Œè½¬åŒ–è·¯å¾„
3. **å¼‚å¸¸æ£€æµ‹ç®—æ³•**ï¼šåº”ç”¨éš”ç¦»æ£®æ—ç­‰ç®—æ³•è‡ªåŠ¨æ£€æµ‹å¤šç»´å¼‚å¸¸
4. **ç‰¹å¾é‡è¦æ€§åˆ†æ**ï¼šè¯„ä¼°ä¸åŒç‰¹å¾å¯¹è´­ä¹°è¡Œä¸ºçš„é¢„æµ‹èƒ½åŠ›
5. **æ•°æ®å¯è§†åŒ–**ï¼šåˆ›å»ºäº¤äº’å¼ä»ªè¡¨æ¿å±•ç¤ºæ¸…æ´—åçš„æ•°æ®æ´å¯Ÿ

## å°ç»“ä¸åæ€

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å¤„ç†ç”µå•†ç”¨æˆ·æ•°æ®ä¸­å¸¸è§çš„æ•°æ®è´¨é‡é—®é¢˜ï¼Œå¹¶ä¸ºåç»­åˆ†æåšå¥½å‡†å¤‡ã€‚æ•°æ®é¢„å¤„ç†æ˜¯æ•°æ®åˆ†æå’ŒæŒ–æ˜çš„åŸºç¡€ï¼Œè‰¯å¥½çš„æ•°æ®è´¨é‡å¯¹äºå¾—å‡ºå¯é çš„ç»“è®ºè‡³å…³é‡è¦ã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç±»æ•°æ®æ¸…æ´—å·¥ä½œå¯ä»¥å¸®åŠ©ç”µå•†å¹³å°æ›´å¥½åœ°ç†è§£ç”¨æˆ·è¡Œä¸ºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œæé«˜è½¬åŒ–ç‡å’Œé”€å”®é¢ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åˆ†æä¸åŒè®¾å¤‡ç±»å‹çš„è½¬åŒ–ç‡å·®å¼‚ï¼Œå¯ä»¥é’ˆå¯¹æ€§åœ°ä¼˜åŒ–ç§»åŠ¨ç«¯æˆ–æ¡Œé¢ç«¯çš„ç”¨æˆ·ç•Œé¢ã€‚

### æ€è€ƒé—®é¢˜

1. åœ¨å¤„ç†ç¼ºå¤±å€¼æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘å“ªäº›å› ç´ æ¥é€‰æ‹©åˆé€‚çš„å¡«å……ç­–ç•¥ï¼Ÿ
2. å¼‚å¸¸å€¼æ˜¯å¦æ€»æ˜¯åº”è¯¥è¢«ç§»é™¤æˆ–ä¿®æ­£ï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¼‚å¸¸å€¼å¯èƒ½åŒ…å«æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Ÿ
3. å¦‚ä½•è¯„ä¼°æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†çš„æ•ˆæœï¼Ÿæœ‰å“ªäº›æŒ‡æ ‡å¯ä»¥è¡¡é‡æ•°æ®è´¨é‡çš„æå‡ï¼Ÿ

<div class="practice-link">
  <a href="/projects/preprocessing/medical-missing-values.html" class="button">ä¸‹ä¸€ä¸ªé¡¹ç›®ï¼šåŒ»ç–—æ•°æ®ç¼ºå¤±å€¼å¤„ç†</a>
</div> 